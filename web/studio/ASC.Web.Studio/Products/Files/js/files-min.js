var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"ZeroClipboard.swf",nextId:1,$:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}if(!a.addClass){a.hide=function(){this.style.display="none"};a.show=function(){this.style.display=""};a.addClass=function(b){this.removeClass(b);this.className+=" "+b};a.removeClass=function(e){var b=this.className.split(/\s+/);var c=-1;for(var d=0;d<b.length;d++){if(b[d]==e){c=d;d=b.length}}if(c>-1){b.splice(c,1);this.className=b.join(" ")}return this};a.hasClass=function(b){return !!this.className.match(new RegExp("\\s*"+b+"\\s*"))}}return a},setMoviePath:function(a){this.moviePath=a},dispatch:function(d,c,a){var b=this.clients[d];if(b){b.receiveEvent(c,a)}},register:function(b,a){this.clients[b]=a},getDOMObjectPosition:function(b,c){var a={left:0,top:0,width:b.width?b.width:b.offsetWidth,height:b.height?b.height:b.offsetHeight};while(b&&(b!=c)){a.left+=b.offsetLeft;a.top+=b.offsetTop;b=b.offsetParent}return a},Client:function(a){this.handlers={};this.id=ZeroClipboard.nextId++;this.movieId="ZeroClipboardMovie_"+this.id;ZeroClipboard.register(this.id,this);if(a){this.glue(a)}}};ZeroClipboard.Client.prototype={id:0,ready:false,movie:null,clipText:"",handCursorEnabled:true,cssEffects:true,handlers:null,glue:function(c,a,e){this.domElement=ZeroClipboard.$(c);var f=99;if(this.domElement.style.zIndex){f=parseInt(this.domElement.style.zIndex,10)+1}if(typeof(a)=="string"){a=ZeroClipboard.$(a)}else{if(typeof(a)=="undefined"){a=document.getElementsByTagName("body")[0]}}var b=ZeroClipboard.getDOMObjectPosition(this.domElement,a);this.div=document.createElement("div");var d=this.div.style;d.position="absolute";d.left=""+b.left+"px";d.top=""+b.top+"px";d.width=""+b.width+"px";d.height=""+b.height+"px";d.zIndex=f;if(typeof(e)=="object"){for(addedStyle in e){d[addedStyle]=e[addedStyle]}}a.appendChild(this.div);this.div.innerHTML=this.getHTML(b.width,b.height)},getHTML:function(e,b){var c="";var a="id="+this.id+"&width="+e+"&height="+b;if(navigator.userAgent.match(/MSIE/)){var d=location.href.match(/^https/i)?"https://":"http://";c+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+d+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+e+'" height="'+b+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+a+'"/><param name="wmode" value="transparent"/></object>'}else{c+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+e+'" height="'+b+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+a+'" wmode="transparent" />'}return c},hide:function(){if(this.div){this.div.style.left="-2000px"}},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML="";var a=document.getElementsByTagName("body")[0];try{a.removeChild(this.div)}catch(b){}this.domElement=null;this.div=null}},reposition:function(b){if(b){this.domElement=ZeroClipboard.$(b);if(!this.domElement){this.hide()}}if(this.domElement&&this.div){var a=ZeroClipboard.getDOMObjectPosition(this.domElement);var c=this.div.style;c.left=""+a.left+"px";c.top=""+a.top+"px"}},setText:function(a){this.clipText=a;if(this.ready){this.movie.setText(a)}},addEventListener:function(a,b){a=a.toString().toLowerCase().replace(/^on/,"");if(!this.handlers[a]){this.handlers[a]=[]}this.handlers[a].push(b)},setHandCursor:function(a){this.handCursorEnabled=a;if(this.ready){this.movie.setHandCursor(a)}},setCSSEffects:function(a){this.cssEffects=!!a},receiveEvent:function(b,a){b=b.toString().toLowerCase().replace(/^on/,"");switch(b){case"load":this.movie=document.getElementById(this.movieId);if(!this.movie){var f=this;setTimeout(function(){f.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var f=this;setTimeout(function(){f.receiveEvent("load",null)},100);this.ready=true;return}this.ready=true;this.movie.setText(this.clipText);this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":if(this.domElement&&this.cssEffects){this.domElement.addClass("hover");if(this.recoverActive){this.domElement.addClass("active")}}break;case"mouseout":if(this.domElement&&this.cssEffects){this.recoverActive=false;if(this.domElement.hasClass("active")){this.domElement.removeClass("active");this.recoverActive=true}this.domElement.removeClass("hover")}break;case"mousedown":if(this.domElement&&this.cssEffects){this.domElement.addClass("active")}break;case"mouseup":if(this.domElement&&this.cssEffects){this.domElement.removeClass("active");this.recoverActive=false}break}if(this.handlers[b]){for(var d=0,e=this.handlers[b].length;d<e;d++){var c=this.handlers[b][d];if(typeof(c)=="function"){c(this,a)}else{if((typeof(c)=="object")&&(c.length==2)){c[0][c[1]](this,a)}else{if(typeof(c)=="string"){window[c](this,a)}}}}}}};jq.browser.safari=(jq.browser.safari&&!/chrome/.test(navigator.userAgent.toLowerCase()))==!0;jQuery.extend({parseJSON:function(a){if(typeof a!=="string"||!a){return null}a=jQuery.trim(a);if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return window.JSON&&window.JSON.parse?window.JSON.parse(a):(new Function("return "+a))()}else{jQuery.error("Invalid JSON: "+a)}},format:function jQuery_dotnet_string_format(a){if(arguments.length<=1){return a}var c=arguments.length-2;for(var b=0;b<=c;++b){a=a.replace(new RegExp("\\{"+b+"\\}","gi"),arguments[b+1])}return a}});(function(a){a.fn.yellowFade=function(){return(this.css({backgroundColor:"#ffffcc"}).animate({backgroundColor:"#ffffff"},1500,function(){jq(this).css({backgroundColor:""})}))}})(jQuery);if(typeof ASC==="undefined"){ASC={}}if(typeof ASC.Files==="undefined"){ASC.Files=(function(){return{}})()}if(typeof ASC.Files.Constants==="undefined"){ASC.Files.Constants={MAX_NAME_LENGTH:170,COUNT_ON_PAGE:12,MAX_UPLOAD_KB:0,anchorRegExp:{error:/^error\/(\S+)?/,preview:/^preview\/(\d+)?/,folder:/^(\d+)(\/(\d+))?/,anyanchor:/^(\S+)?/}}}if(typeof ASC.Files.Common==="undefined"){ASC.Files.Common=(function(){var f=function(){var g=jq.url.attr("protocol");g+="://";g+=jq.url.attr("host");if(jQuery.url.attr("port")!=null){g+=":";g+=jq.url.attr("port")}return g};var b=function(g){if(!g){var g=window.event}g.cancelBubble=true;if(g.stopPropagation){g.stopPropagation()}};var e=function(h){h=h||window.event;if(h.pageX==null&&h.clientX!=null){var i=document.documentElement;var g=document.body;h.pageX=h.clientX+(i&&i.scrollLeft||g&&g.scrollLeft||0)-(i.clientLeft||0);h.pageY=h.clientY+(i&&i.scrollTop||g&&g.scrollTop||0)-(i.clientTop||0)}if(!h.which&&h.button){h.which=h.button&1?1:(h.button&2?3:(h.button&4?2:0))}return h};var d=function(n,g){var o=jq(n).offset();var h=jq("#"+g);var j=o.top+jq(n).outerHeight();var i=o.left;var q=jq(window);var p=q.scrollTop();var k=q.scrollLeft();var m=q.width();var l=q.height();if((o.left+h.width())>(k+m)){i-=o.left+h.width()-(k+m)}if((o.top+h.height())>(p+l)){j-=jq(n).outerHeight()+h.height()}h.css({position:"absolute",top:j,left:i});h.toggle()};var c=function(h,i,g){if(!jq((h.target)?h.target:h.srcElement).parents().andSelf().is(i+", "+g)){jq(g).hide()}};var a=function(i,k,h,j){try{k=parseInt(k||0);h=parseInt(h||0);left=k>0?parseInt(-k/2):-200;j=parseInt(j||-h/2)+jq(window).scrollTop();if(ASC.Controls.Constants.isMobileAgent){j+=jq(window).scrollTop()}jq.blockUI({message:jq(i),css:{left:"50%",top:"50%",opacity:"1",border:"none",padding:"0px",width:k>0?k+"px":"auto",height:h>0?h+"px":"auto",cursor:"default",textAlign:"left",position:"absolute","margin-left":left+"px","margin-top":j+"px","background-color":"Transparent"},overlayCSS:{backgroundColor:"#aaaaaa",cursor:"default",opacity:"0.3"},focusInput:false,baseZ:666,fadeIn:0,fadeOut:0,onBlock:function(){var l=jq(i).parents("div.blockUI:first"),m=l.removeClass("blockMsg").addClass("blockDialog").get(0),n="";if(jq.browser.msie&&jq.browser.version<9&&l.length!==0){var p=" ",n=p+m.style.cssText,q=n.toLowerCase().indexOf(p+"filter:"),o=n.indexOf(";",q);if(q!==-1){if(o!==-1){m.style.cssText=[n.substring(p.length,q),n.substring(o+1)].join("")}else{m.style.cssText=n.substring(p.length,q)}}}}})}catch(g){}};return{getSitePath:f,cancelBubble:b,fixEvent:e,dropdownToggle:d,dropdownRegisterAutoHide:c,blockUI:a}})()}ASC.Files.Utils=(function(){var U={text:".doc",spreadsheet:".xls",presentation:".pptx"};var i=new Array();var j=new Array();var M=new Array();var N=new Array();var V=new Array();var S="";var r="";var a=[".zip",".rar",".ace",".arc",".arj",".bh",".cab",".enc",".gz",".ha",".jar",".lha",".lzh",".pak",".pk3",".tar",".tgz",".uu",".uue",".xxe",".z",".zoo"];var b=[".avi"];var e=[".csv"];var f=[".djvu"];var g=[".doc",".docx"];var h=[".epub",".fb2"];var q=[".flv",".fla"];var x=[".html",".htm",".mht"];var y=[".iaf"];var z=[".bmp",".cod",".gif",".ief",".jpe",".jpeg",".jpg",".jfif",".tiff",".tif",".cmx",".ico",".pnm",".pbm",".ppm",".rgb",".xbm",".xpm",".xwd",".png"];var B=[".m2ts"];var C=[".mkv"];var D=[".mov"];var E=[".mp4"];var F=[".mpg"];var G=[".odp"];var H=[".ods"];var I=[".odt"];var J=[".pdf"];var K=[".pps",".ppsx"];var L=[".ppt",".pptx"];var P=[".rtf"];var R=[".mp3",".wav",".pcm",".aiff",".3gp",".flac",".fla",".cda"];var T=[".txt"];var W=[".vob"];var X=[".xls",".xlsx"];var Y=[".xml"];var Z=[".xps"];var s=function(aa){var ab=aa.lastIndexOf(".");return 0<=ab?aa.substring(ab).toLowerCase():""};var t=function(ab){var aa=ASC.Files.Utils.getFileExts(ab);var ac="na";if(jq.inArray(aa,a)!=-1){ac="zip"}else{if(jq.inArray(aa,b)!=-1){ac="avi"}else{if(jq.inArray(aa,e)!=-1){ac="xls"}else{if(jq.inArray(aa,f)!=-1){ac="djvu"}else{if(jq.inArray(aa,g)!=-1){ac="doc"}else{if(jq.inArray(aa,h)!=-1){ac="ebook"}else{if(jq.inArray(aa,q)!=-1){ac="flv"}else{if(jq.inArray(aa,x)!=-1){ac="html"}else{if(jq.inArray(aa,y)!=-1){ac="iaf"}else{if(jq.inArray(aa,z)!=-1){ac="image"}else{if(jq.inArray(aa,B)!=-1){ac="m2ts"}else{if(jq.inArray(aa,C)!=-1){ac="mkv"}else{if(jq.inArray(aa,D)!=-1){ac="mov"}else{if(jq.inArray(aa,E)!=-1){ac="mp4"}else{if(jq.inArray(aa,F)!=-1){ac="mpg"}else{if(jq.inArray(aa,G)!=-1){ac="odp"}else{if(jq.inArray(aa,I)!=-1){ac="odt"}else{if(jq.inArray(aa,H)!=-1){ac="ods"}else{if(jq.inArray(aa,J)!=-1){ac="pdf"}else{if(jq.inArray(aa,K)!=-1){ac="pps"}else{if(jq.inArray(aa,L)!=-1){ac="ppt"}else{if(jq.inArray(aa,P)!=-1){ac="rtf"}else{if(jq.inArray(aa,R)!=-1){ac="sound"}else{if(jq.inArray(aa,T)!=-1){ac="txt"}else{if(jq.inArray(aa,W)!=-1){ac="vob"}else{if(jq.inArray(aa,X)!=-1){ac="xls"}else{if(jq.inArray(aa,Y)!=-1){ac="xml"}else{if(jq.inArray(aa,Z)!=-1){ac="xps"}}}}}}}}}}}}}}}}}}}}}}}}}}}}return ac};var c=function(aa){return ASC.Files.Utils.FolderImagesFiles+aa};var u=function(aa){var ab=t(aa);return c("file_"+ab+".png")};var Q=function(aa,ab){var ac=Encoder.htmlDecode(ab);if(ac==""){ac=t(aa);ac=c("thumb_file_"+ac+".png")}return ac};var l=function(ab){var aa=ASC.Files.Utils.getFileExts(ab);return ASC.Files.Constants.PLUGIN_ENABLE&&!jq.browser.opera&&!jq.browser.safari&&navigator.appVersion.indexOf("Win")!=-1&&jq.inArray(aa,ASC.Files.Utils.EditableExtensions)!=-1};var k=function(ab){var aa=ASC.Files.Utils.getFileExts(ab);return jq.inArray(aa,ASC.Files.Utils.EditedDocExtensions)!=-1};var n=function(ab){var aa=ASC.Files.Utils.getFileExts(ab);return ASC.Files.Utils.SupportFileTypes===""||jq.inArray(aa,ASC.Files.Utils.UploadableExtensions)!=-1};var m=function(ab){var aa=ASC.Files.Utils.getFileExts(ab);return ASC.Files.ImageViewer!=undefined&&jq.inArray(aa,ASC.Files.Utils.PreviewedImageExtensions)!=-1||jq.inArray(aa,ASC.Files.Utils.PreviewedDocExtensions)!=-1};var A=function(ab){var aa=ASC.Files.Utils.getFileExts(ab);return jq.inArray(aa,ASC.Files.Utils.PreviewedDocExtensions)!=-1};var v=function(ac,ab,ad){var aa=ASC.Files.Utils.getFileExts(ac);if(ASC.Files.ImageViewer!=undefined&&jq.inArray(aa,ASC.Files.Utils.PreviewedImageExtensions)!=-1){return ASC.Files.ImageViewer.getPreviewUrl(ab)}if(jq.inArray(aa,ASC.Files.Utils.PreviewedDocExtensions)!=-1){return jq.format(ASC.Files.Constants.URL_DOCUMENT_PREVIEW,ab,ad||"")}};var w=function(ac,ab,ad){var aa=ASC.Files.Utils.getFileExts(ac);if(jq.inArray(aa,ASC.Files.Utils.EditedDocExtensions)!=-1){return jq.format(ASC.Files.Constants.URL_DOCUMENT_EDIT,ab)}};var d=function(ah,ab,ac,aa){ab=(ab===true);ac=(ac===true);aa=(aa===true);var ae=(ac?17:32);var ad=(ac?17:(aa?23:30));var af=ab?ae:ad;var ag=ah;if(ah.length>af){ag=ah.substring(0,af-1)+"..."}else{ag=ah.substring(0,af)}return ag};var O=function(aa){return aa.replace(new RegExp("[\\\\/:*?\"<>|';+]","gim"),"_")};var o=function(aa,ab){return jq.format(ASC.Files.Constants.URL_HANDLER_DOWNLOAD,aa,ab||"")};var p=function(aa,ab){return jq.format(ASC.Files.Constants.URL_HANDLER_VIEW,aa,ab||"")};return{getFileExts:s,SupportFileTypes:S,typeNewDoc:U,getFileTypeIcon:u,setThumbnailTypeIcon:Q,FileCanBeEditOO:l,FileCanBeEdit:k,FileCanBeUpload:n,FileCanBePreview:m,itIsDocument:A,getPreviewUrl:v,FolderImagesFiles:r,clippingTitle:d,replaceSpecCharacter:O,fileDownloadUrl:o,fileViewUrl:p,getWebEditUrl:w}})();jQuery.url=function(){var g={};var e={};var c={url:window.location,strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var f=function(){str=decodeURI(c.url);var k=c.parser[c.strictMode?"strict":"loose"].exec(str);var l={};var j=14;while(j--){l[c.key[j]]=k[j]||""}l[c.q.name]={};l[c.key[12]].replace(c.q.parser,function(i,m,n){if(m){l[c.q.name][m]=n}});return l};var b=function(i){if(!e.length){h()}if(i=="base"){if(e.port!==null&&e.port!==""){return e.protocol+"://"+e.host+":"+e.port+"/"}else{return e.protocol+"://"+e.host+"/"}}return(e[i]==="")?null:e[i]};var d=function(i){if(!e.length){h()}return(e.queryKey[i]===null)?null:e.queryKey[i]};var h=function(){e=f();a()};var a=function(){var i=e.path;g=[];g=e.path.length==1?{}:(i.charAt(i.length-1)=="/"?i.substring(1,i.length-1):path=i.substring(1)).split("/")};return{setMode:function(i){strictMode=i=="strict"?true:false;return this},setUrl:function(i){c.url=i===undefined?window.location:i;h();return this},segment:function(i){if(!e.length){h()}if(i===undefined){return g.length}return(g[i]===""||g[i]===undefined)?null:g[i]},attr:b,param:d}}();(function(e,d,f){e.fn.jScrollPane=function(b){function a(bh,bC){var be,bG=this,bV,a0,bO,a2,bL,bX,bU,bF,aa,aS,ba,bp,bq,bn,br,s,bN,a6,bT,bK,c,a7,aR,a3,bm,bv,a9,bd,bS,bb,aY,bj,bw,aZ=true,bE=true,aW=false,bt=false,a5=bh.clone(false,false).empty(),aL=e.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";aY=bh.css("paddingTop")+" "+bh.css("paddingRight")+" "+bh.css("paddingBottom")+" "+bh.css("paddingLeft");bj=(parseInt(bh.css("paddingLeft"),10)||0)+(parseInt(bh.css("paddingRight"),10)||0);function a8(o){var j,l,k,h,g,n,m=false,i=false;be=o;if(bV===f){g=bh.scrollTop();n=bh.scrollLeft();bh.css({overflow:"hidden",padding:0});a0=bh.innerWidth()+bj;bO=bh.innerHeight();bh.width(a0);bV=e('<div class="jspPane" />').css("padding",aY).append(bh.children());a2=e('<div class="jspContainer" />').css({width:a0+"px",height:bO+"px"}).append(bV).appendTo(bh)}else{bh.css("width","");m=be.stickToBottom&&bu();i=be.stickToRight&&bf();h=bh.innerWidth()+bj!=a0||bh.outerHeight()!=bO;if(h){a0=bh.innerWidth()+bj;bO=bh.innerHeight();a2.css({width:a0+"px",height:bO+"px"})}if(!h&&bw==bL&&bV.outerHeight()==bX){bh.width(a0);return}bw=bL;bV.css("width","");bh.width(a0);a2.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}bV.css("overflow","auto");if(o.contentWidth){bL=o.contentWidth}else{bL=bV[0].scrollWidth}bX=bV[0].scrollHeight;bV.css("overflow","");bU=bL/a0;bF=bX/bO;aa=bF>1;aS=bU>1;if(!(aS||aa)){bh.removeClass("jspScrollable");bV.css({top:0,width:a2.width()-bj});bz();bi();bI();bQ();aX()}else{bh.addClass("jspScrollable");j=be.maintainPosition&&(bq||s);if(j){l=aO();k=aK()}aU();bW();bk();if(j){bA(i?(bL-a0):l,false);by(m?(bX-bO):k,false)}bs();aT();a4();if(be.enableKeyboardNavigation){bJ()}if(be.clickOnTrack){bD()}bg();if(be.hijackInternalLinks){bx()}}if(be.autoReinitialise&&!bb){bb=setInterval(function(){a8(be)},be.autoReinitialiseDelay)}else{if(!be.autoReinitialise&&bb){clearInterval(bb)}}g&&bh.scrollTop(0)&&by(g,false);n&&bh.scrollLeft(0)&&bA(n,false);bh.trigger("jsp-initialised",[aS||aa])}function aU(){if(aa){a2.append(e('<div class="jspVerticalBar" />').append(e('<div class="jspCap jspCapTop" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragTop" />'),e('<div class="jspDragBottom" />'))),e('<div class="jspCap jspCapBottom" />')));bN=a2.find(">.jspVerticalBar");a6=bN.find(">.jspTrack");ba=a6.find(">.jspDrag");if(be.showArrows){a7=e('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",aQ(0,-1)).bind("click.jsp",aM);aR=e('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",aQ(0,1)).bind("click.jsp",aM);if(be.arrowScrollOnHover){a7.bind("mouseover.jsp",aQ(0,-1,a7));aR.bind("mouseover.jsp",aQ(0,1,aR))}a1(a6,be.verticalArrowPositions,a7,aR)}bK=bO;a2.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){bK-=e(this).outerHeight()});ba.hover(function(){ba.addClass("jspHover")},function(){ba.removeClass("jspHover")}).bind("mousedown.jsp",function(g){e("html").bind("dragstart.jsp selectstart.jsp",aM);ba.addClass("jspActive");var h=g.pageY-ba.position().top;e("html").bind("mousemove.jsp",function(i){bP(i.pageY-h,false)}).bind("mouseup.jsp mouseleave.jsp",bc);return false});bB()}}function bB(){a6.height(bK+"px");bq=0;bT=be.verticalGutter+a6.outerWidth();bV.width(a0-bT-bj);try{if(bN.position().left===0){bV.css("margin-left",bT+"px")}}catch(g){}}function bW(){if(aS){a2.append(e('<div class="jspHorizontalBar" />').append(e('<div class="jspCap jspCapLeft" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragLeft" />'),e('<div class="jspDragRight" />'))),e('<div class="jspCap jspCapRight" />')));a3=a2.find(">.jspHorizontalBar");bm=a3.find(">.jspTrack");bn=bm.find(">.jspDrag");if(be.showArrows){bd=e('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",aQ(-1,0)).bind("click.jsp",aM);bS=e('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",aQ(1,0)).bind("click.jsp",aM);if(be.arrowScrollOnHover){bd.bind("mouseover.jsp",aQ(-1,0,bd));bS.bind("mouseover.jsp",aQ(1,0,bS))}a1(bm,be.horizontalArrowPositions,bd,bS)}bn.hover(function(){bn.addClass("jspHover")},function(){bn.removeClass("jspHover")}).bind("mousedown.jsp",function(g){e("html").bind("dragstart.jsp selectstart.jsp",aM);bn.addClass("jspActive");var h=g.pageX-bn.position().left;e("html").bind("mousemove.jsp",function(i){bR(i.pageX-h,false)}).bind("mouseup.jsp mouseleave.jsp",bc);return false});bv=a2.innerWidth();aV()}}function aV(){a2.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){bv-=e(this).outerWidth()});bm.width(bv+"px");s=0}function bk(){if(aS&&aa){var g=bm.outerHeight(),h=a6.outerWidth();bK-=g;e(a3).find(">.jspCap:visible,>.jspArrow").each(function(){bv+=e(this).outerWidth()});bv-=h;bO-=h;a0-=g;bm.parent().append(e('<div class="jspCorner" />').css("width",g+"px"));bB();aV()}if(aS){bV.width((a2.outerWidth()-bj)+"px")}bX=bV.outerHeight();bF=bX/bO;if(aS){a9=Math.ceil(1/bU*bv);if(a9>be.horizontalDragMaxWidth){a9=be.horizontalDragMaxWidth}else{if(a9<be.horizontalDragMinWidth){a9=be.horizontalDragMinWidth}}bn.width(a9+"px");br=bv-a9;aP(s)}if(aa){c=Math.ceil(1/bF*bK);if(c>be.verticalDragMaxHeight){c=be.verticalDragMaxHeight}else{if(c<be.verticalDragMinHeight){c=be.verticalDragMinHeight}}ba.height(c+"px");bp=bK-c;aN(bq)}}function a1(h,j,g,m){var l="before",i="after",k;if(j=="os"){j=/Mac/.test(navigator.platform)?"after":"split"}if(j==l){i=j}else{if(j==i){l=j;k=g;g=m;m=k}}h[l](g)[i](m)}function aQ(g,i,h){return function(){bo(g,i,this,h);this.blur();return false}}function bo(j,i,m,l){m=e(m).addClass("jspActive");var k,h,g=true,n=function(){if(j!==0){bG.scrollByX(j*be.arrowButtonSpeed)}if(i!==0){bG.scrollByY(i*be.arrowButtonSpeed)}h=setTimeout(n,g?be.initialDelay:be.arrowRepeatFreq);g=false};n();k=l?"mouseout.jsp":"mouseup.jsp";l=l||e("html");l.bind(k,function(){m.removeClass("jspActive");h&&clearTimeout(h);h=null;l.unbind(k)})}function bD(){bQ();if(aa){a6.bind("mousedown.jsp",function(l){if(l.originalTarget===f||l.originalTarget==l.currentTarget){var j=e(this),m=j.offset(),k=l.pageY-m.top-bq,h,g=true,n=function(){var q=j.offset(),r=l.pageY-q.top-c/2,o=bO*be.scrollPagePercent,p=bp*o/(bX-bO);if(k<0){if(bq-p>r){bG.scrollByY(-o)}else{bP(r)}}else{if(k>0){if(bq+p<r){bG.scrollByY(o)}else{bP(r)}}else{i();return}}h=setTimeout(n,g?be.initialDelay:be.trackClickRepeatFreq);g=false},i=function(){h&&clearTimeout(h);h=null;e(document).unbind("mouseup.jsp",i)};n();e(document).bind("mouseup.jsp",i);return false}})}if(aS){bm.bind("mousedown.jsp",function(l){if(l.originalTarget===f||l.originalTarget==l.currentTarget){var j=e(this),m=j.offset(),k=l.pageX-m.left-s,h,g=true,n=function(){var q=j.offset(),r=l.pageX-q.left-a9/2,o=a0*be.scrollPagePercent,p=br*o/(bL-a0);if(k<0){if(s-p>r){bG.scrollByX(-o)}else{bR(r)}}else{if(k>0){if(s+p<r){bG.scrollByX(o)}else{bR(r)}}else{i();return}}h=setTimeout(n,g?be.initialDelay:be.trackClickRepeatFreq);g=false},i=function(){h&&clearTimeout(h);h=null;e(document).unbind("mouseup.jsp",i)};n();e(document).bind("mouseup.jsp",i);return false}})}}function bQ(){if(bm){bm.unbind("mousedown.jsp")}if(a6){a6.unbind("mousedown.jsp")}}function bc(){e("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(ba){ba.removeClass("jspActive")}if(bn){bn.removeClass("jspActive")}}function bP(h,g){if(!aa){return}if(h<0){h=0}else{if(h>bp){h=bp}}if(g===f){g=be.animateScroll}if(g){bG.animate(ba,"top",h,aN)}else{ba.css("top",h);aN(h)}}function aN(g){if(g===f){g=ba.position().top}a2.scrollTop(0);bq=g;var j=bq===0,h=bq==bp,i=g/bp,k=-i*(bX-bO);if(aZ!=j||aW!=h){aZ=j;aW=h;bh.trigger("jsp-arrow-change",[aZ,aW,bE,bt])}bM(j,h);bV.css("top",k);bh.trigger("jsp-scroll-y",[-k,j,h]).trigger("scroll")}function bR(g,h){if(!aS){return}if(g<0){g=0}else{if(g>br){g=br}}if(h===f){h=be.animateScroll}if(h){bG.animate(bn,"left",g,aP)}else{bn.css("left",g);aP(g)}}function aP(g){if(g===f){g=bn.position().left}a2.scrollTop(0);s=g;var j=s===0,i=s==br,h=g/br,k=-h*(bL-a0);if(bE!=j||bt!=i){bE=j;bt=i;bh.trigger("jsp-arrow-change",[aZ,aW,bE,bt])}bH(j,i);bV.css("left",k);bh.trigger("jsp-scroll-x",[-k,j,i]).trigger("scroll")}function bM(g,h){if(be.showArrows){a7[g?"addClass":"removeClass"]("jspDisabled");aR[h?"addClass":"removeClass"]("jspDisabled")}}function bH(g,h){if(be.showArrows){bd[g?"addClass":"removeClass"]("jspDisabled");bS[h?"addClass":"removeClass"]("jspDisabled")}}function by(i,g){var h=i/(bX-bO);bP(h*bp,g)}function bA(g,i){var h=g/(bL-a0);bR(h*br,i)}function aJ(u,o,h){var l,i,j,v=0,t=0,g,n,m,q,p,r;try{l=e(u)}catch(k){return}i=l.outerHeight();j=l.outerWidth();a2.scrollTop(0);a2.scrollLeft(0);while(!l.is(".jspPane")){v+=l.position().top;t+=l.position().left;l=l.offsetParent();if(/^body|html$/i.test(l[0].nodeName)){return}}g=aK();m=g+bO;if(v<g||o){p=v-be.verticalGutter}else{if(v+i>m){p=v-bO+i+be.verticalGutter}}if(p){by(p,h)}n=aO();q=n+a0;if(t<n||o){r=t-be.horizontalGutter}else{if(t+j>q){r=t-a0+j+be.horizontalGutter}}if(r){bA(r,h)}}function aO(){return -bV.position().left}function aK(){return -bV.position().top}function bu(){var g=bX-bO;return(g>20)&&(g-aK()<10)}function bf(){var g=bL-a0;return(g>20)&&(g-aO()<10)}function aT(){a2.unbind(aL).bind(aL,function(j,k,i,g){var h=s,l=bq;bG.scrollBy(i*be.mouseWheelSpeed,-g*be.mouseWheelSpeed,false);return h==s&&l==bq})}function bz(){a2.unbind(aL)}function aM(){return false}function bs(){bV.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(g){aJ(g.target,false)})}function bi(){bV.find(":input,a").unbind("focus.jsp")}function bJ(){var j,g,i=[];aS&&i.push(a3[0]);aa&&i.push(bN[0]);bV.focus(function(){bh.focus()});bh.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(m){if(m.target!==this&&!(i.length&&e(m.target).closest(i).length)){return}var l=s,k=bq;switch(m.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:j=m.keyCode;h();break;case 35:by(bX-bO);j=null;break;case 36:by(0);j=null;break}g=m.keyCode==j&&l!=s||k!=bq;return !g}).bind("keypress.jsp",function(k){if(k.keyCode==j){h()}return !g});if(be.hideFocus){bh.css("outline","none");if("hideFocus" in a2[0]){bh.attr("hideFocus",true)}}else{bh.css("outline","");if("hideFocus" in a2[0]){bh.attr("hideFocus",false)}}function h(){var l=s,k=bq;switch(j){case 40:bG.scrollByY(be.keyboardSpeed,false);break;case 38:bG.scrollByY(-be.keyboardSpeed,false);break;case 34:case 32:bG.scrollByY(bO*be.scrollPagePercent,false);break;case 33:bG.scrollByY(-bO*be.scrollPagePercent,false);break;case 39:bG.scrollByX(be.keyboardSpeed,false);break;case 37:bG.scrollByX(-be.keyboardSpeed,false);break}g=l!=s||k!=bq;return g}}function bI(){bh.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function bg(){if(location.hash&&location.hash.length>1){var i,g,h=escape(location.hash);try{i=e(h)}catch(j){return}if(i.length&&bV.find(h)){if(a2.scrollTop()===0){g=setInterval(function(){if(a2.scrollTop()>0){aJ(h,true);e(document).scrollTop(a2.position().top);clearInterval(g)}},50)}else{aJ(h,true);e(document).scrollTop(a2.position().top)}}}}function aX(){e("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function bx(){aX();e("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var h=this.href.split("#"),g;if(h.length>1){g=h[1];if(g.length>0&&bV.find("#"+g).length>0){aJ("#"+g,true);return false}}})}function a4(){var h,g,j,i,k,l=false;a2.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(m){var n=m.originalEvent.touches[0];h=aO();g=aK();j=n.pageX;i=n.pageY;k=false;l=true}).bind("touchmove.jsp",function(p){if(!l){return}var o=p.originalEvent.touches[0],n=s,m=bq;bG.scrollTo(h+j-o.pageX,g+i-o.pageY);k=k||Math.abs(j-o.pageX)>5||Math.abs(i-o.pageY)>5;return n==s&&m==bq}).bind("touchend.jsp",function(m){l=false}).bind("click.jsp-touchclick",function(m){if(k){k=false;return false}})}function bl(){var h=aK(),g=aO();bh.removeClass("jspScrollable").unbind(".jsp");bh.replaceWith(a5.append(bV.children()));a5.scrollTop(h);a5.scrollLeft(g)}e.extend(bG,{reinitialise:function(g){g=e.extend({},be,g);a8(g)},scrollToElement:function(h,g,i){aJ(h,g,i)},scrollTo:function(h,i,g){bA(h,g);by(i,g)},scrollToX:function(g,h){bA(g,h)},scrollToY:function(h,g){by(h,g)},scrollToPercentX:function(g,h){bA(g*(bL-a0),h)},scrollToPercentY:function(g,h){by(g*(bX-bO),h)},scrollBy:function(g,i,h){bG.scrollByX(g,h);bG.scrollByY(i,h)},scrollByX:function(j,h){var g=aO()+Math[j<0?"floor":"ceil"](j),i=g/(bL-a0);bR(i*br,h)},scrollByY:function(j,h){var g=aK()+Math[j<0?"floor":"ceil"](j),i=g/(bX-bO);bP(i*bp,h)},positionDragX:function(h,g){bR(h,g)},positionDragY:function(g,h){bP(g,h)},animate:function(g,j,k,i){var h={};h[j]=k;g.animate(h,{duration:be.animateDuration,ease:be.animateEase,queue:false,step:i})},getContentPositionX:function(){return aO()},getContentPositionY:function(){return aK()},getContentWidth:function(){return bL},getContentHeight:function(){return bX},getPercentScrolledX:function(){return aO()/(bL-a0)},getPercentScrolledY:function(){return aK()/(bX-bO)},getIsScrollableH:function(){return aS},getIsScrollableV:function(){return aa},getContentPane:function(){return bV},scrollToBottom:function(g){bP(bp,g)},hijackInternalLinks:function(){bx()},destroy:function(){bl()}});a8(bC)}b=e.extend({},e.fn.jScrollPane.defaults,b);e.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){b[this]=b[this]||b.speed});return this.each(function(){var c=e(this),h=c.data("jsp");if(h){h.reinitialise(b)}else{h=new a(c,b);c.data("jsp",h)}})};e.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,stickToBottom:false,stickToRight:false,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:f,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8}})(jQuery,this);
/* Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
* Licensed under the MIT License (LICENSE.txt).
* Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
* Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
* Thanks to: Seamus Leahy for adding deltaX and deltaY
* Version: 3.0.4
* Requires: 1.2.2+
*/
(function(a){var c=["DOMMouseScroll","mousewheel"];a.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var d=c.length;d;){this.addEventListener(c[--d],b,false)}}else{this.onmousewheel=b}},teardown:function(){if(this.removeEventListener){for(var d=c.length;d;){this.removeEventListener(c[--d],b,false)}}else{this.onmousewheel=null}}};a.fn.extend({mousewheel:function(d){return d?this.bind("mousewheel",d):this.trigger("mousewheel")},unmousewheel:function(d){return this.unbind("mousewheel",d)}});function b(h){var i=h||window.event,d=[].slice.call(arguments,1),e=0,j=true,f=0,g=0;h=a.event.fix(i);h.type="mousewheel";if(h.wheelDelta){e=h.wheelDelta/120}if(h.detail){e=-h.detail/3}g=e;if(i.axis!==undefined&&i.axis===i.HORIZONTAL_AXIS){g=0;f=-1*e}if(i.wheelDeltaY!==undefined){g=i.wheelDeltaY/120}if(i.wheelDeltaX!==undefined){f=-1*i.wheelDeltaX/120}d.unshift(h,e,f,g);return a.event.handle.apply(this,d)}})(jQuery);Encoder={EncodeType:"entity",isEmpty:function(a){if(a){return((a===null)||a.length==0||/^\s+$/.test(a))}else{return true}},HTML2Numerical:function(c){var a=new Array("&nbsp;","&iexcl;","&cent;","&pound;","&curren;","&yen;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&not;","&shy;","&reg;","&macr;","&deg;","&plusmn;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&sup1;","&ordm;","&raquo;","&frac14;","&frac12;","&frac34;","&iquest;","&agrave;","&aacute;","&acirc;","&atilde;","&Auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&Ouml;","&times;","&oslash;","&ugrave;","&uacute;","&ucirc;","&Uuml;","&yacute;","&thorn;","&szlig;","&agrave;","&aacute;","&acirc;","&atilde;","&auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&ouml;","&divide;","&Oslash;","&ugrave;","&uacute;","&ucirc;","&uuml;","&yacute;","&thorn;","&yuml;","&quot;","&amp;","&lt;","&gt;","&oelig;","&oelig;","&scaron;","&scaron;","&yuml;","&circ;","&tilde;","&ensp;","&emsp;","&thinsp;","&zwnj;","&zwj;","&lrm;","&rlm;","&ndash;","&mdash;","&lsquo;","&rsquo;","&sbquo;","&ldquo;","&rdquo;","&bdquo;","&dagger;","&dagger;","&permil;","&lsaquo;","&rsaquo;","&euro;","&fnof;","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigmaf;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;","&thetasym;","&upsih;","&piv;","&bull;","&hellip;","&prime;","&prime;","&oline;","&frasl;","&weierp;","&image;","&real;","&trade;","&alefsym;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&crarr;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&forall;","&part;","&exist;","&empty;","&nabla;","&isin;","&notin;","&ni;","&prod;","&sum;","&minus;","&lowast;","&radic;","&prop;","&infin;","&ang;","&and;","&or;","&cap;","&cup;","&int;","&there4;","&sim;","&cong;","&asymp;","&ne;","&equiv;","&le;","&ge;","&sub;","&sup;","&nsub;","&sube;","&supe;","&oplus;","&otimes;","&perp;","&sdot;","&lceil;","&rceil;","&lfloor;","&rfloor;","&lang;","&rang;","&loz;","&spades;","&clubs;","&hearts;","&diams;");var b=new Array("&#160;","&#161;","&#162;","&#163;","&#164;","&#165;","&#166;","&#167;","&#168;","&#169;","&#170;","&#171;","&#172;","&#173;","&#174;","&#175;","&#176;","&#177;","&#178;","&#179;","&#180;","&#181;","&#182;","&#183;","&#184;","&#185;","&#186;","&#187;","&#188;","&#189;","&#190;","&#191;","&#192;","&#193;","&#194;","&#195;","&#196;","&#197;","&#198;","&#199;","&#200;","&#201;","&#202;","&#203;","&#204;","&#205;","&#206;","&#207;","&#208;","&#209;","&#210;","&#211;","&#212;","&#213;","&#214;","&#215;","&#216;","&#217;","&#218;","&#219;","&#220;","&#221;","&#222;","&#223;","&#224;","&#225;","&#226;","&#227;","&#228;","&#229;","&#230;","&#231;","&#232;","&#233;","&#234;","&#235;","&#236;","&#237;","&#238;","&#239;","&#240;","&#241;","&#242;","&#243;","&#244;","&#245;","&#246;","&#247;","&#248;","&#249;","&#250;","&#251;","&#252;","&#253;","&#254;","&#255;","&#34;","&#38;","&#60;","&#62;","&#338;","&#339;","&#352;","&#353;","&#376;","&#710;","&#732;","&#8194;","&#8195;","&#8201;","&#8204;","&#8205;","&#8206;","&#8207;","&#8211;","&#8212;","&#8216;","&#8217;","&#8218;","&#8220;","&#8221;","&#8222;","&#8224;","&#8225;","&#8240;","&#8249;","&#8250;","&#8364;","&#402;","&#913;","&#914;","&#915;","&#916;","&#917;","&#918;","&#919;","&#920;","&#921;","&#922;","&#923;","&#924;","&#925;","&#926;","&#927;","&#928;","&#929;","&#931;","&#932;","&#933;","&#934;","&#935;","&#936;","&#937;","&#945;","&#946;","&#947;","&#948;","&#949;","&#950;","&#951;","&#952;","&#953;","&#954;","&#955;","&#956;","&#957;","&#958;","&#959;","&#960;","&#961;","&#962;","&#963;","&#964;","&#965;","&#966;","&#967;","&#968;","&#969;","&#977;","&#978;","&#982;","&#8226;","&#8230;","&#8242;","&#8243;","&#8254;","&#8260;","&#8472;","&#8465;","&#8476;","&#8482;","&#8501;","&#8592;","&#8593;","&#8594;","&#8595;","&#8596;","&#8629;","&#8656;","&#8657;","&#8658;","&#8659;","&#8660;","&#8704;","&#8706;","&#8707;","&#8709;","&#8711;","&#8712;","&#8713;","&#8715;","&#8719;","&#8721;","&#8722;","&#8727;","&#8730;","&#8733;","&#8734;","&#8736;","&#8743;","&#8744;","&#8745;","&#8746;","&#8747;","&#8756;","&#8764;","&#8773;","&#8776;","&#8800;","&#8801;","&#8804;","&#8805;","&#8834;","&#8835;","&#8836;","&#8838;","&#8839;","&#8853;","&#8855;","&#8869;","&#8901;","&#8968;","&#8969;","&#8970;","&#8971;","&#9001;","&#9002;","&#9674;","&#9824;","&#9827;","&#9829;","&#9830;");return this.swapArrayVals(c,a,b)},NumericalToHTML:function(c){var a=new Array("&#160;","&#161;","&#162;","&#163;","&#164;","&#165;","&#166;","&#167;","&#168;","&#169;","&#170;","&#171;","&#172;","&#173;","&#174;","&#175;","&#176;","&#177;","&#178;","&#179;","&#180;","&#181;","&#182;","&#183;","&#184;","&#185;","&#186;","&#187;","&#188;","&#189;","&#190;","&#191;","&#192;","&#193;","&#194;","&#195;","&#196;","&#197;","&#198;","&#199;","&#200;","&#201;","&#202;","&#203;","&#204;","&#205;","&#206;","&#207;","&#208;","&#209;","&#210;","&#211;","&#212;","&#213;","&#214;","&#215;","&#216;","&#217;","&#218;","&#219;","&#220;","&#221;","&#222;","&#223;","&#224;","&#225;","&#226;","&#227;","&#228;","&#229;","&#230;","&#231;","&#232;","&#233;","&#234;","&#235;","&#236;","&#237;","&#238;","&#239;","&#240;","&#241;","&#242;","&#243;","&#244;","&#245;","&#246;","&#247;","&#248;","&#249;","&#250;","&#251;","&#252;","&#253;","&#254;","&#255;","&#34;","&#38;","&#60;","&#62;","&#338;","&#339;","&#352;","&#353;","&#376;","&#710;","&#732;","&#8194;","&#8195;","&#8201;","&#8204;","&#8205;","&#8206;","&#8207;","&#8211;","&#8212;","&#8216;","&#8217;","&#8218;","&#8220;","&#8221;","&#8222;","&#8224;","&#8225;","&#8240;","&#8249;","&#8250;","&#8364;","&#402;","&#913;","&#914;","&#915;","&#916;","&#917;","&#918;","&#919;","&#920;","&#921;","&#922;","&#923;","&#924;","&#925;","&#926;","&#927;","&#928;","&#929;","&#931;","&#932;","&#933;","&#934;","&#935;","&#936;","&#937;","&#945;","&#946;","&#947;","&#948;","&#949;","&#950;","&#951;","&#952;","&#953;","&#954;","&#955;","&#956;","&#957;","&#958;","&#959;","&#960;","&#961;","&#962;","&#963;","&#964;","&#965;","&#966;","&#967;","&#968;","&#969;","&#977;","&#978;","&#982;","&#8226;","&#8230;","&#8242;","&#8243;","&#8254;","&#8260;","&#8472;","&#8465;","&#8476;","&#8482;","&#8501;","&#8592;","&#8593;","&#8594;","&#8595;","&#8596;","&#8629;","&#8656;","&#8657;","&#8658;","&#8659;","&#8660;","&#8704;","&#8706;","&#8707;","&#8709;","&#8711;","&#8712;","&#8713;","&#8715;","&#8719;","&#8721;","&#8722;","&#8727;","&#8730;","&#8733;","&#8734;","&#8736;","&#8743;","&#8744;","&#8745;","&#8746;","&#8747;","&#8756;","&#8764;","&#8773;","&#8776;","&#8800;","&#8801;","&#8804;","&#8805;","&#8834;","&#8835;","&#8836;","&#8838;","&#8839;","&#8853;","&#8855;","&#8869;","&#8901;","&#8968;","&#8969;","&#8970;","&#8971;","&#9001;","&#9002;","&#9674;","&#9824;","&#9827;","&#9829;","&#9830;");var b=new Array("&nbsp;","&iexcl;","&cent;","&pound;","&curren;","&yen;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&not;","&shy;","&reg;","&macr;","&deg;","&plusmn;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&sup1;","&ordm;","&raquo;","&frac14;","&frac12;","&frac34;","&iquest;","&agrave;","&aacute;","&acirc;","&atilde;","&Auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&Ouml;","&times;","&oslash;","&ugrave;","&uacute;","&ucirc;","&Uuml;","&yacute;","&thorn;","&szlig;","&agrave;","&aacute;","&acirc;","&atilde;","&auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&ouml;","&divide;","&Oslash;","&ugrave;","&uacute;","&ucirc;","&uuml;","&yacute;","&thorn;","&yuml;","&quot;","&amp;","&lt;","&gt;","&oelig;","&oelig;","&scaron;","&scaron;","&yuml;","&circ;","&tilde;","&ensp;","&emsp;","&thinsp;","&zwnj;","&zwj;","&lrm;","&rlm;","&ndash;","&mdash;","&lsquo;","&rsquo;","&sbquo;","&ldquo;","&rdquo;","&bdquo;","&dagger;","&dagger;","&permil;","&lsaquo;","&rsaquo;","&euro;","&fnof;","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigmaf;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;","&thetasym;","&upsih;","&piv;","&bull;","&hellip;","&prime;","&prime;","&oline;","&frasl;","&weierp;","&image;","&real;","&trade;","&alefsym;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&crarr;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&forall;","&part;","&exist;","&empty;","&nabla;","&isin;","&notin;","&ni;","&prod;","&sum;","&minus;","&lowast;","&radic;","&prop;","&infin;","&ang;","&and;","&or;","&cap;","&cup;","&int;","&there4;","&sim;","&cong;","&asymp;","&ne;","&equiv;","&le;","&ge;","&sub;","&sup;","&nsub;","&sube;","&supe;","&oplus;","&otimes;","&perp;","&sdot;","&lceil;","&rceil;","&lfloor;","&rfloor;","&lang;","&rang;","&loz;","&spades;","&clubs;","&hearts;","&diams;");return this.swapArrayVals(c,a,b)},numEncode:function(f){if(this.isEmpty(f)){return""}var b="";for(var d=0;d<f.length;d++){var a=f.charAt(d);if(a<" "||a>"~"){a="&#"+a.charCodeAt()+";"}b+=a}return b},htmlDecode:function(f){var a,e,b=f;if(this.isEmpty(b)){return""}b=this.HTML2Numerical(b);arr=b.match(/&#[0-9]{1,5};/g);if(arr!=null){for(var g=0;g<arr.length;g++){e=arr[g];a=e.substring(2,e.length-1);if(a>=-32768&&a<=65535){b=b.replace(e,String.fromCharCode(a))}else{b=b.replace(e,"")}}}return b},htmlEncode:function(b,a){if(this.isEmpty(b)){return""}a=a|false;if(a){if(this.EncodeType=="numerical"){b=b.replace(/&/g,"&#38;")}else{b=b.replace(/&/g,"&amp;")}}b=this.XSSEncode(b,false);if(this.EncodeType=="numerical"||!a){b=this.HTML2Numerical(b)}b=this.numEncode(b);if(!a){b=b.replace(/&#/g,"##AMPHASH##");if(this.EncodeType=="numerical"){b=b.replace(/&/g,"&#38;")}else{b=b.replace(/&/g,"&amp;")}b=b.replace(/##AMPHASH##/g,"&#")}b=b.replace(/&#\d*([^\d;]|$)/g,"$1");if(!a){b=this.correctEncoding(b)}if(this.EncodeType=="entity"){b=this.NumericalToHTML(b)}return b},XSSEncode:function(b,a){if(!this.isEmpty(b)){a=a||true;if(a){b=b.replace(/\'/g,"&#39;");b=b.replace(/\"/g,"&quot;");b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;")}else{b=b.replace(/\'/g,"&#39;");b=b.replace(/\"/g,"&#34;");b=b.replace(/</g,"&#60;");b=b.replace(/>/g,"&#62;")}return b}else{return""}},hasEncoded:function(a){if(/&#[0-9]{1,5};/g.test(a)){return true}else{if(/&[A-Z]{2,6};/gi.test(a)){return true}else{return false}}},stripUnicode:function(a){return a.replace(/[^\x20-\x7E]/g,"")},correctEncoding:function(a){return a.replace(/(&amp;)(amp;)+/,"$1")},swapArrayVals:function(e,a,b){if(this.isEmpty(e)){return""}var d;if(a&&b){if(a.length==b.length){for(var f=0,c=a.length;f<c;f++){d=new RegExp(a[f],"g");e=e.replace(d,b[f])}}}return e},inArray:function(c,a){for(var b=0,d=a.length;b<d;b++){if(a[b]===c){return b}}return -1}};window.ASC.Files.TemplateManager=(function(a){var d=false,g="",f="",h={},e={CreateNewFile:"createnewfile",CreateNewFilePlugin:"createnewfileplugin",CreateFolder:"createfolder",CheckEditFile:"checkeditfile",GetTreeSubFolders:"gettreesubfolders",GetFolderInfo:"getfolderinfo",GetFolderItems:"getfolderitems",GetSharedInfo:"getsharedinfo",SetAceObject:"setaceobject",UnSubscribeMe:"unsubscribeme",GetNewItems:"getnewitems",FolderRename:"folderrename",FileRename:"filerename",DeleteItem:"deleteitem",EmptyTrash:"emptytrash",GetFileHistory:"getfilehistory",GetFile:"getFile",ReplaceVersion:"replaceversion",SetCurrentVersion:"setcurrentversion",GetFavorites:"getfavorites",SaveFavorite:"savefavorite",RemoveFavorite:"removefavorite",IsZohoAuthentificated:"iszohoauthentificated",GetImportData:"getImportData",ExecImportData:"execImportData",GetImportStatus:"getimportstatus",Download:"download",GetTasksStatuses:"getTasksStatuses",TerminateTasks:"terminatetasks",MoveFilesCheck:"movefilescheck",MoveItems:"moveitems",GetSiblingsFile:"getsiblingsfile"},i={getNewInShare:"getchangedfile",getSharedInfo:"getsharedinfo",getGroups:"getgroups",addGroup:"addgroup",getFavorite:"getfavorite",getFileHistory:"getfilehistory",getFoldersTree:"getfolderstree",getFolderInfo:"getfolderinfo",getFolderItems:"getfolderitems",getFolderItems_thumb:"getfolderitems_thumb",getFolderItem:"getfolderitem",getFolderItem_thumb:"getfolderitem_thumb",getImportData:"getimportdata"};var c=function(k,j){if(d===false){d=true;g=j;f=k}};var b=function(j){if(typeof j!=="string"||j.length===0){return undefined}if(h.hasOwnProperty(j)){return h[j]}var k=ASC.Controls.XSLTManager.loadXML(f+"?id="+g+"&name="+j);if(k&&typeof k==="object"){h[j]=k;return h[j]}return undefined};return{events:e,templates:i,getTemplate:b,init:c}})(jQuery);if(typeof window.serviceManager==="undefined"){window.serviceManager=(function($){var isInit=false,servicePath="",docServicePath="",cmdSeparator="/",requestTimeout=60*1000,customEvents={};var check_ready=true;var queue=0;var ajax_stek=new Array();var init=function(path,path2){if(typeof path!=="string"||path.length===0){throw"incorrect service path"}if(isInit===false){isInit=true;servicePath=path[path.length-1]==="/"?path:path+"/";docServicePath=path2}};var getRandomId=function(prefix){return(typeof prefix!=="undefined"?prefix+"-":"")+Math.floor(Math.random()*1000000)};var getUniqueId=function(o,prefix){var iterCount=0,maxIterations=1000,uniqueId=getRandomId();while(o.hasOwnProperty(uniqueId)&&iterCount++<maxIterations){uniqueId=getRandomId(prefix)}return uniqueId};var jsonToXml=function(o,parent){var attr="",xml="";if(typeof o==="object"){if(o.constructor.toString().indexOf("Array")!==-1){for(i=0,n=o.length;i<n;i++){xml+="<"+parent+">"+o[i]+"</"+parent+">"}}else{for(var i in o){if(i.charAt(0)==="_"){attr+=" "+i.substring(1)+'="'+o[i]+'"'}else{xml+=arguments.callee(o[i],i)}}if(typeof parent!=="undefined"){xml="<"+parent+attr+">"+xml+"</"+parent+">"}}}else{if(typeof o==="string"){xml=o;if(typeof parent!=="undefined"){xml="<"+parent+attr+">"+xml+"</"+parent+">"}}else{if(typeof o!=="undefined"&&typeof o.toString!=="undefined"){xml=o.toString();if(typeof parent!=="undefined"){xml="<"+parent+attr+">"+xml+"</"+parent+">"}}}}return xml};var execCustomEvent=function(eventType,thisArg,argsArray){eventType=eventType.toLowerCase();thisArg=thisArg||window;argsArray=argsArray||[];if(!customEvents.hasOwnProperty(eventType)){return undefined}var customEvent=customEvents[eventType];for(var eventId in customEvent){if(customEvent.hasOwnProperty(eventId)){customEvent[eventId].handler.apply(thisArg,argsArray);if(customEvent[eventId].type&1){delete customEvent[eventId]}}}};var addCustomEvent=function(eventType,handler,params){if(typeof eventType!=="string"||typeof handler!=="function"){return undefined}eventType=eventType.toLowerCase();if(typeof params!=="object"){params={}}var isOnceExec=params.hasOwnProperty("once")?params.once:false;var handlerType=0;handlerType|=+isOnceExec*1;if(!customEvents.hasOwnProperty(eventType)){customEvents[eventType]={}}var eventId=getUniqueId(customEvents[eventType]);customEvents[eventType][eventId]={handler:handler,type:handlerType};return eventId};var removeCustomEvent=function(eventType,eventId){if(typeof eventType!=="string"||typeof eventId==="undefined"){return false}if(customEvents(eventType)&&customEvents[eventType].hasOwnProperty(eventId)){delete userEventHandlers[eventType][eventId]}return true};var getUrl=function(){var i=0,n=0,url=servicePath;if(arguments.length===0){return url}for(i=0,n=arguments.length-1;i<n;i++){url+=arguments[i]+cmdSeparator}var res=url+arguments[i];var now=new Date();if(res.search(/\?/)>0){res+="&_="+now.getTime()}else{res+="?_="+now.getTime()}return res};var getNodeContent=function(o){if(!o||typeof o!=="object"){return""}return o.text||o.textContent||(function(o){var result="",childrens=o.childNodes;if(!childrens){return result}for(var i=0,n=childrens.length;i<n;i++){var child=childrens.item(i);switch(child.nodeType){case 1:case 5:result+=arguments.callee(child);break;case 3:case 2:case 4:result+=child.nodeValue;break;default:break}}return result})(o)};var completeRequest=function(eventType,params,dataType,xmlHttpRequest,textStatus){check_ready=true;if(ASC.Files.UI&&ASC.Files.UI.hideLoading){ASC.Files.UI.hideLoading()}if(textStatus==="error"){var errorMessage="",commentMessage="",messageNode=null,innerNode=null;innerMessageNode=null;if(xmlHttpRequest.responseXML){messageNode=xmlHttpRequest.responseXML.getElementsByTagName("message")[0];innerNode=xmlHttpRequest.responseXML.getElementsByTagName("inner")[0];if(innerNode){innerMessageNode=innerNode.getElementsByTagName("message")[0]}if(errorMessage===""){try{errorMessage=eval("["+xmlHttpRequest.responseText+"]")[0].Detail}catch(e){var div=document.createElement("div");errorMessage=jq("#content",jq(div).html(xmlHttpRequest.responseText)).text()}}}else{if(xmlHttpRequest.responseText){var div=document.createElement("div");errorMessage=jq("#content",jq(div).html(xmlHttpRequest.responseText)).text();if(errorMessage===""){try{errorMessage=eval("["+xmlHttpRequest.responseText+"]")[0].Detail}catch(e){}}}}if(messageNode&&typeof messageNode==="object"){errorMessage=getNodeContent(messageNode)}if(innerMessageNode&&typeof innerMessageNode==="object"){commentMessage=getNodeContent(innerMessageNode)}execCustomEvent(eventType,window,[undefined,params,errorMessage,commentMessage]);return undefined}var data=null;try{switch(dataType){case"xml":data=ASC.Controls.XSLTManager.createXML(xmlHttpRequest.responseText);break;case"json":data=jq.parseJSON(xmlHttpRequest.responseText);break;default:data=ASC.Controls.XSLTManager.createXML(xmlHttpRequest.responseXML.xml)||jq.parseJSON(xmlHttpRequest.responseText)}}catch(e){data=xmlHttpRequest.responseText}execCustomEvent(eventType,window,[data,params]);if(ajax_stek.length!=0&&check_ready==true){var req=ajax_stek.shift();check_ready=false;execAjax(req)}return};var getCompleteCallbackMethod=function(eventType,params,dataType){return function(){var argsArray=[eventType,params,dataType];for(var i=0,n=arguments.length;i<n;i++){argsArray.push(arguments[i])}completeRequest.apply(this,argsArray)}};var request=function(type,dataType,eventType,params){if(typeof type==="undefined"||typeof dataType==="undefined"||typeof eventType!=="string"){return undefined}if(ASC.Files.UI==undefined||ASC.Files.UI.displayLoading==undefined){params.showLoading=false}var data={},argsArray=[];var contentType=(params.ajaxcontentType||"text/xml");if(typeof params!=="object"){params={}}switch(type.toLowerCase()){case"delete":case"get":for(var i=4,n=arguments.length;i<n;i++){argsArray.push(arguments[i])}break;case"post":data=(contentType=="text/xml"?jsonToXml(arguments[4]):arguments[4]);for(var i=5,n=arguments.length;i<n;i++){argsArray.push(arguments[i])}break;default:return undefined}var req={async:(params.ajaxsync!=true),data:data,type:type,dataType:dataType,contentType:contentType,mimeType:"text/xml",cache:true,url:getUrl.apply(this,argsArray),timeout:requestTimeout,beforeSend:params.showLoading?ASC.Files.UI.displayLoading():null,complete:getCompleteCallbackMethod(eventType,params,dataType)};if(ajax_stek.length==0&&check_ready==true){check_ready=false;execAjax(req)}else{ajax_stek.push(req)}};var execAjax=function(req){$.ajax({async:req.async,data:req.data,type:req.type,dataType:req.dataType,contentType:req.contentType,cache:req.cache,url:req.url,timeout:req.timeout,beforeSend:req.beforeSend,complete:req.complete})};var createFolder=function(eventType,params){params.ajaxsync=true;request("get","xml",eventType,params,"folders",params.parentFolderID,"create?title="+encodeURIComponent(params.title))};var getFolderInfo=function(eventType,params){params.ajaxsync=true;request("get","xml",eventType,params,"folders",params.id)};var getFile=function(eventType,params){params.ajaxsync=true;request("get","xml",eventType,params,"folders","files",params.id,"lastversion?setThumbnailURLBool="+(params.setThumbnailURLBool==true))};var getFolderItems=function(eventType,params,data){params.ajaxsync=params.append!=true;params.showLoading=true;request("post","xml",eventType,params,data,"folders",params.id+"?from="+params.from+"&count="+params.count+"&filter="+params.filter+"&subjectID="+params.subject+"&setThumbnailURLBool="+params.setThumbnailURLBool)};var renameFolder=function(eventType,params){request("get","xml",eventType,params,"folders",params.id,"rename?title="+encodeURIComponent(params.newname))};var renameFile=function(eventType,params){request("get","xml",eventType,params,"folders","files",params.id,"rename?title="+encodeURIComponent(params.newname))};var deleteItem=function(eventType,params,data){request("post","json",eventType,params,data,"folders","files?action=delete")};var emptyTrash=function(eventType,params){request("get","json",eventType,params,"emptytrash")};var getFileHistory=function(eventType,params,data){request("post","xml",eventType,params,data,"folders","files",params.id,"history")};var moveItems=function(eventType,params,data){request("post","json",eventType,params,data,"moveorcopy?dfID="+params.destID+"&ow="+(params.overwrite==true)+"&ic="+(params.isCopyOperation==true))};var moveFilesCheck=function(eventType,params,data){request("post","json",eventType,params,data,"folders","files",params.destID,"moveOrCopyFilesCheck")};var download=function(eventType,params,data){params.showLoading=true;request("post","json",eventType,params,data,"bulkdownload")};var terminateTasks=function(eventType,params){request("get","json",eventType,params,"tasks?terminate")};var getTasksStatuses=function(eventType,params){request("get","json",eventType,params,"tasks","statuses")};var setCurrentVersion=function(eventType,params){request("get","xml",eventType,params,"folders","files",params.id,"updateToVersion?version="+params.version)};var createNewFile=function(eventType,params){params.ajaxsync=true;request("get","xml",eventType,params,"folders",params.folderID,"files","createfile?title="+encodeURIComponent(params.fileTitle))};var checkEditFile=function(eventType,params){request("get","json",eventType,params,"makeeditfile?fileID="+params.fileID)};var trackEditFile=function(eventType,params){request("get","json",eventType,params,"trackeditfile?fileID="+params.fileID+"&docKey="+params.docKey+"&isFinish="+(params.finish==true))};var openFile=function(id,title,ticket){if(ASC.Files.Plugin==undefined){return}var sitePath=ASC.Files.Common.getSitePath();var url=jq.format(servicePath+"folders/files?id={0}&ticket={1}&title={2}",id,ticket,encodeURIComponent(ASC.Files.Utils.clippingTitle(title,false,false,true)));ASC.Files.Plugin.RunOpenOfficeApp(sitePath+url,id)};var getDocPath=function(){return docServicePath};var getServicePath=function(){return servicePath};return{init:init,bind:addCustomEvent,unbind:removeCustomEvent,jsonToXml:jsonToXml,request:request,createFolder:createFolder,createNewFile:createNewFile,getFile:getFile,getFolderInfo:getFolderInfo,getFolderItems:getFolderItems,renameFolder:renameFolder,renameFile:renameFile,deleteItem:deleteItem,emptyTrash:emptyTrash,download:download,terminateTasks:terminateTasks,getFileHistory:getFileHistory,setCurrentVersion:setCurrentVersion,moveFilesCheck:moveFilesCheck,moveItems:moveItems,getTasksStatuses:getTasksStatuses,checkEditFile:checkEditFile,trackEditFile:trackEditFile,openFile:openFile,getDocPath:getDocPath,getServicePath:getServicePath}})(jQuery)};window.ASC.Files.UI=(function(a){var D=false;var Z="";var E=false,aa=null;var ac="0";var af="";var ae="00";var ad="l";var o=0;var e=0;var m=0;var n="";var p=null;var W=0;var X=0;var L=0;var M=0;var H=false;var C=function(){if(D===false){D=true}ASC.Files.UI.mouseBtn=false};var F=function(ag,ah){jq(".mainContentHeader_item_actions").removeClass("display");ASC.Files.UI.resetSelectAll(false);var ai;if(ag==undefined||ag==null||ag===""||ag==0){ag=ASC.Files.Folders.currentFolderId}ai=ag;if(ASC.Files.UI.viewOrder==undefined||ASC.Files.UI.viewOrder==""){ASC.Files.UI.viewOrder="00"}if(ASC.Files.UI.viewOrder!="00"||ASC.Files.UI.viewFolder=="g"){ai+="/"+ASC.Files.UI.viewOrder}if(ah===true){ASC.Controls.AnchorController.safemove(ai)}else{ASC.Controls.AnchorController.move(ai)}};var R=function(ah){var ag=jq(ah).attr("id").replace("files_sort_","");ASC.Files.UI.viewOrder=(ASC.Files.UI.viewOrder.charAt(0)==0?"1":"0");switch(ag){case"AZ":ASC.Files.UI.viewOrder+="1";ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoOrderByTitle);break;case"Size":ASC.Files.UI.viewOrder+="2";ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoOrderBySize);break;case"DateAndTime":ASC.Files.UI.viewOrder+="3";ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoOrderByModified);break;case"Author":ASC.Files.UI.viewOrder+="4";ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoOrderByAuthor);break;default:ASC.Files.UI.viewOrder="00"}F()};var P=function(ag){jq("[id^='files_filter_value_'] a.select").removeClass("select");jq(ag).addClass("select");jq("#files_filter_value span").html(jq(ag).html());var ah=jq(ag).parent().attr("id").replace("files_filter_value_","").split("_");Q(ah[0],ah[1])};var Q=function(ag,ah){ASC.Files.UI.viewFilter=parseInt(ag);ASC.Files.UI.viewSubject=ah;F()};var q=function(){if(ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT==0){if(ASC.Files.Constants.FOLDER_ID_MY_FILES==0){ASC.Files.UI.navigationSet(ASC.Files.Constants.FOLDER_ID_COMMON_FILES)}else{if(ASC.Files.Folders.currentFolderId!=ASC.Files.Constants.FOLDER_ID_MY_FILES){ASC.Files.UI.navigationSet(ASC.Files.Constants.FOLDER_ID_MY_FILES)}}}else{if(ASC.Files.Folders.currentFolderId!=ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT){ASC.Files.UI.navigationSet(ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT)}}};var I=function(ag){ASC.Files.UI.viewFilter=0;ASC.Files.UI.amountPage=0;ASC.Files.UI.viewSubject="";jq("#mainContentHeader_panel a").removeClass("select");jq(".mainContentHeader_item_actions").removeClass("display");jq("#files_filter_category span").html(jq("#files_filter_show_0 a").html());jq("#files_filter_value").hide();ASC.Files.UI.viewFolder="l";ASC.Files.UI.viewOrder="00";if(ag==parseInt(ag)){ASC.Files.Folders.currentFolderId=parseInt(ag);ASC.Files.Folders.folderContainer="";F()}else{ASC.Files.Folders.currentFolderId=-1;ASC.Files.Folders.folderContainer=ag;F(ag)}};var S=function(ag){if(ag==undefined||ag!="g"){ASC.Files.UI.viewFolder="l";jq("#files_gallery_btn").css("display","");jq("#files_list_btn").hide()}else{ASC.Files.UI.viewFolder="g";jq("#files_list_btn").css("display","");jq("#files_gallery_btn").hide()}};var Y=function(){if(ASC.Files.UI.viewFolder=="l"){ASC.Files.UI.viewFolder="g";ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoViewFolderGallery)}else{ASC.Files.UI.viewFolder="l";ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoViewFolderList)}F()};var ab=function(){if(ASC.Files.Folders.currentFolderId==0){ASC.Controls.AnchorController.move("");return}ASC.Files.Folders.getFolderItems(false);if(ASC.Files.Folders.eventAfter!=null){ASC.Files.Folders.eventAfter();ASC.Files.Folders.eventAfter=null}};var U=function(an,ak,ah,am,ag){var aj=jq("#content_folder_"+ak+" div.fileName a").attr("title")||jq("#stree_selector_"+ak).text();var ao;if(ag.length>1){var ai="";for(var al=0;al<ag.length;al++){ai+=jq.format("<li title='{0}'>{0}</li>",ag[al].Value)}ao="<b>"+jq.format(ASC.Files.Resources.FilesAlreadyExist,ag.length,aj)+"</b>";jq("#files_overwrite_list").html(ai).show()}else{jq("#files_overwrite_list").hide();ao=jq.format(ASC.Files.Resources.FileAlreadyExist,"<span title='"+ag[0].Value+"'>"+ag[0].Value+"</span>","<b>"+aj+"</b>")}jq("#files_overwrite_msg").html(ao);jq("#files_overwrite_overwrite").unbind("click").click(function(){PopupKeyUpActionProvider.CloseDialogAction="";PopupKeyUpActionProvider.CloseDialog();serviceManager.moveItems(ASC.Files.TemplateManager.events.MoveItems,{destID:ak,overwrite:true,isCopyOperation:(am==true)},{stringList:an})});jq("#files_overwrite_skip").unbind("click").click(function(){for(var ap=0;ap<ag.length;ap++){ASC.Files.UI.blockItem("content_file_"+ag[ap].Key);var aq=jq.inArray("file_"+ag[ap].Key,an.entry);if(aq!=-1){an.entry.splice(aq,1)}}PopupKeyUpActionProvider.CloseDialogAction="";PopupKeyUpActionProvider.CloseDialog();serviceManager.moveItems(ASC.Files.TemplateManager.events.MoveItems,{destID:ak,overwrite:false,isCopyOperation:(am==true)},{stringList:an})});jq("#files_overwrite_cancel").unbind("click").click(function(){for(var ap=0;ap<an.entry.length;ap++){ASC.Files.UI.blockItem("content_"+an.entry[ap])}PopupKeyUpActionProvider.CloseDialogAction="";PopupKeyUpActionProvider.CloseDialog()});ASC.Files.Common.blockUI(jq("#files_overwriteFiles"),400,300);PopupKeyUpActionProvider.EnterAction='jq("#files_overwrite_overwrite").click();';PopupKeyUpActionProvider.CloseDialogAction='jq("#files_overwrite_cancel").click();'};var h=function(ah,aj,ag){var ai=jq("#"+ah);if(ai.hasClass("checkloading")&&aj){return}ASC.Files.UI.selectRow(ai,false);ASC.Files.UI.currentCombo="";ASC.Files.UI.hideLinks(ai);if(aj===true){if(typeof ag!="undefined"){if(ag!=""){jq("div.name a",ai).hide();jq("div.name",ai).append("<a class='name descr_block_name'>"+ag+"</a>")}}ai.addClass("loading checkloading");ai.block({message:"",baseZ:99})}else{jq("div.name a.descr_block_name",ai).remove();jq("div.name a",ai).css("display","");ai.removeClass("loading checkloading");ai.unblock();ai.css("position","static")}};var A=function(ag){jq(ag).removeClass("row-over");jq("div.combobox",ag).addClass("no_combobox").removeClass("combobox");if(ASC.Files.UI.currentCombo!=""){jq("#"+ASC.Files.UI.currentCombo).parent().removeClass("no_combobox").addClass("combobox")}jq("div.fileFavorites a.file_fav_notyet",jq(ag)).removeClass("file_fav_action")};var T=function(ag){if(jq("#files_selector").css("display")=="block"||jq("#"+ag.id+".loading").length!=0){return}jq(ag).addClass("row-over");jq("div.no_combobox",ag).addClass("combobox").removeClass("no_combobox");jq("div.fileFavorites a.file_fav_notyet",jq(ag)).addClass("file_fav_action")};var v=function(ag){return jq("div.editing_file_icn:visible",jq("#"+ag)).length!=0};var u=function(ag,ai){var ah=jq("div.name a",jq("#"+ag)).attr("title");ai=(ai==true);return ASC.Files.Folders.folderContainer!="trash"&&jq("#"+ag).is("div:not(.folderRow)")&&jq("#"+ag).is("div:not(.rowRename)")&&ASC.Files.UI.accessibleItem(ag.replace("content_",""))&&(!ai&&ASC.Files.Utils.FileCanBeEditOO(ah)||ai&&ASC.Files.Utils.FileCanBeEdit(ah))};var J=function(){if(ASC.Files.UI.viewFolder!="g"){jq("div.fileRow:odd").removeClass("even");jq("div.fileRow:even").addClass("even")}};var d=function(ag){ASC.Files.UI.paintRows();if(ASC.Files.Folders.folderContainer=="trash"||ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT!=0||jq("#favorites_addcurrent").length==0){jq("div.fileFavorites").remove()}jq("div.fileRow#"+(ag||"")).each(function(){var am=jq(this);var ai=this.id.replace("content_","");var ah=ai.replace("file_","");am.unbind("mousedown").mousedown(function(aq){ASC.Files.UI.preparingMoveTo(this,aq)});am.find("div[id*='combo_file_']").unbind("click").click(function(aq){ASC.Files.Actions.showFileActions(this,aq)});am.find("div[id*='combo_folder_']").unbind("click").click(function(aq){ASC.Files.Actions.showFolderActions(this,aq)});if(ASC.Files.Folders.folderContainer=="trash"){am.find("div.fileInfo span.titleCreated").remove();am.find("div.fileInfo span.titleRemoved").css("display","");if(am.is(".folderRow")){am.find("span.create_date").remove();am.find("span.modified_date").css("display","")}else{am.find("div.fileInfo:not(.folderRow) span.create_by").remove();am.find("div.fileInfo:not(.folderRow) span.fortrash_create_by").show().removeClass("fortrash_create_by").addClass("create_by")}}else{am.find("a.file_fav_notyet").attr("alt",ASC.Files.Resources.AddToFavorites).attr("title",ASC.Files.Resources.AddToFavorites);if(ASC.Files.Favorites){ASC.Files.Favorites.setIfFavorites(am)}am.find("div.fileInfo span.titleRemoved").remove();am.find("div.fileInfo span.fortrash_create_by").remove()}if(!am.hasClass("checkloading")){var al=am.find(".fileName a.name");var an=al.attr("title");var ak=am.hasClass("folderRow");var aj=ASC.Files.UI.editableFile(jq(this).attr("id"),true);al.html(ASC.Files.Utils.clippingTitle(an,ak,(ASC.Files.UI.viewFolder=="g"),aj));if(ASC.Files.Folders.folderContainer=="trash"){al.attr("href","#"+ASC.Files.Constants.FOLDER_ID_TRASH)}if(!ak){if(ASC.Files.Folders.folderContainer!="trash"){var ap=jq("#file_version_"+ah).val()||"";if(ASC.Files.Utils.FileCanBePreview(an)){var ao=ASC.Files.Utils.getPreviewUrl(an,ah,ap);if(ASC.Files.Utils.itIsDocument(an)){al.attr("href",ao).attr("target","_blank")}else{al.attr("href",ao)}}else{al.attr("href",ASC.Files.Utils.fileDownloadUrl(ah,ap))}}if(aj){am.find("div.fileEdit").show();if(ASC.Files.UI.editingFile(jq(this).attr("id"))){am.find("div.fileEdit").hide();am.find("div.fileEditing").show()}else{am.find("div.fileEdit").show();am.find("div.fileEditing").hide()}}else{jq("#content_file_"+ah).addClass("cannotEdit");jq("#content_file_"+ah+" div.fileEdit").remove();jq("#content_file_"+ah+" div.fileEditing").remove()}}ASC.Files.UI.markForMe(ai)}})};var r=function(){var ag=ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem();jq("#files_mainContent").hide();jq("#files_pageNavigatorHolder").hide();jq("#files_clearFilter_btn, #files_clearFilterCont_btn").parent().show();if(ag===true){jq("#emptyContainer").show();if(ASC.Files.UI.viewFilter==0&&ASC.Files.UI.viewSubject==""){jq("#mainContentHeader, #mainContentHeader_panel").hide();jq("#files_clearFilterCont_btn").parent().hide()}}else{jq("#emptyScreen").show();if(ASC.Files.UI.viewFilter==0&&ASC.Files.UI.viewSubject==""){jq("#mainContentHeader, #mainContentHeader_panel").hide();jq("#files_clearFilter_btn").parent().hide()}}};var y=function(){jq("#emptyScreen").hide();jq("#emptyContainer").hide();jq("#files_mainContent").css("display","");jq("#mainContentHeader").css("display","")};var j=function(ag){if(ag.nodeName=="HTML"){return true}if(jq("div.popupModal:visible").length!=0){return true}if(jq.inArray(jq("div.mainContainerClass")[0],jq(ag).parents())==-1){return true}if(jq("#imageViewerToolbox:visible, #imageViewerContainer:visible").length!=0){return true}if(jq(ag).is("div.fileRow")||jq(ag).is("div.fileRow div")||jq(ag).is("div.fileRow input")||jq(ag).is("div.fileRow span")||jq(ag).is("div.fileRow a")||jq(ag).is("div.files_action_panel")||jq(ag).is("div.files_action_panel a")||jq(ag).is("div.files_action_panel div")||jq(ag).is("div.files_treeViewPanel")||jq(ag).is("div.files_treeViewPanel a")||jq(ag).is("div.files_treeViewPanel div")||jq(ag).is("div.files_treeViewPanel div")||jq(ag).is("div.files_treeViewPanel ul")||jq(ag).is("div.files_treeViewPanel ins")||jq(ag).is("div.files_treeViewPanel a")||jq(ag).is("div.files_treeViewPanel li")||jq(ag).is("ul#mainMenuHolder")||jq(ag).is("ul#mainMenuHolder img")||jq(ag).is("ul#mainMenuHolder a")||jq(ag).is("#files_actions_open")||jq(ag).is("#files_pageNavigatorHolder a")||jq(ag).is(".files_progress_box")){return true}return false};var g=function(ag){ag=ASC.Files.Common.fixEvent(ag);if(!(ag.button==0||(jq.browser.msie&&ag.button==1))){return true}if(jq("div.fileRow:not(.checkloading):not(.newFolder):not(.newFile)").length==0){return true}var aj=ag.target||ag.srcElement;try{if(j(aj)){return true}}catch(ag){return true}var ah=ag.pageX;var ai=ag.pageY;ASC.Files.UI.startX=ah;ASC.Files.UI.startY=ai;jq("#studioPageContent").append("<div id='files_selector'></div>");jq("#files_selector").css({left:ah+"px",top:ai+"px",width:"0px",height:"0px","z-index":"300","background-color":"#6CA3BF",position:"absolute"});jq("#files_selector").fadeTo(0,0.3);jq("body").addClass("select_action");var ak=(jq.browser.msie&&jq.browser.version<9?jq("body"):jq(window));ak.unbind("mouseout").unbind("mousemove").unbind("mouseup").mousemove(function(al){al=ASC.Files.Common.fixEvent(al);var aq=al.target||al.srcElement;if(aq==undefined){return}var ao=al.pageX;var ap=al.pageY;var at,am,ar,an;at=Math.abs(ao-ASC.Files.UI.startX);am=Math.abs(ap-ASC.Files.UI.startY);if(at<5&&am<5){return}an=Math.min(ASC.Files.UI.startX,ao);ar=Math.min(ASC.Files.UI.startY,ap);jq("#files_selector").css({width:at+"px",height:am+"px",left:an+"px",top:ar+"px",display:"block",border:"1px solid #034",cursor:"default"});ASC.Files.Actions.hideAllActionPanels();jq("div.fileRow:not(.checkloading):not(.newFolder):not(.newFile)").each(function(){var az=Math.min(ASC.Files.UI.startX,ao);var aA=Math.min(ASC.Files.UI.startY,ap);var aw=Math.max(ASC.Files.UI.startX,ao);var ax=Math.max(ASC.Files.UI.startY,ap);var ay=jq(this).offset();var au=this.offsetWidth;var av=this.offsetHeight;if((ay.top>aA&&ay.top<ax&&ay.left>az&&ay.left<aw)||(ay.top+av>aA&&ay.top+av<ax&&ay.left>az&&ay.left<aw)||(ay.top+av>aA&&ay.top+av<ax&&ay.left+au>az&&ay.left+au<aw)||(ay.top>aA&&ay.top<ax&&ay.left+au>az&&ay.left+au<aw)||(ay.top>aA&&ay.top<ax&&ay.left<az&&ay.left+au>aw)||(ay.top+av>aA&&ay.top+av<ax&&ay.left<az&&ay.left+au>aw)||(ay.top<aA&&ay.top+av>ax&&ay.left>az&&ay.left<aw)||(ay.top<aA&&ay.top+av>ax&&ay.left+au>az&&ay.left+au<aw)){ASC.Files.UI.selectRow(this,true)}else{if(!al.ctrlKey){ASC.Files.UI.selectRow(this,false)}}});N(jq("#files_mainContent input[type='checkbox']").length==jq("#files_mainContent input:checked").length);return false});ak.bind("mouseup",function(al){jq("#files_selector").remove();ASC.Files.UI.startX=0;ASC.Files.UI.startY=0;ASC.Files.UI.mouseBtn=false;ak.unbind("mousemove").unbind("mouseup");jq("body").removeClass("select_action")});return false};var x=function(ag){if(jq("div.files_popup_win:visible,                div.blockDialog:visible,                #imageViewerToolbox:visible").length!=0){return}ag=ASC.Files.Common.fixEvent(ag);var aj=ag.pageX;var ak=ag.pageY;var al=ag.target||ag.srcElement;var ai=true;var ah=jq("#files_mainContent div.fileRow").each(function(){var ao=jq(this).offset();var am=this.offsetWidth;var an=this.offsetHeight;if((ao.top<ak&&ao.top+an>ak&&ao.left<aj&&ao.left+am>aj)){if(ASC.Files.UI.currentRowOver==this){ai=false;return undefined}var ap=ASC.Files.UI.currentRowOver;ASC.Files.UI.currentRowOver=this;ASC.Files.UI.showLinks(this);ai=false;if(ap!=null){ASC.Files.UI.hideLinks(ap)}}});if(ai){if(ASC.Files.UI.currentRowOver!=null){ASC.Files.UI.hideLinks(ASC.Files.UI.currentRowOver)}ASC.Files.UI.currentRowOver=null}};var K=function(ai,ag){if(!(ag.button==0||(jq.browser.msie&&ag.button==1))){return undefined}if(ASC.Files.Folders.folderContainer=="trash"){return false}if(jq("#files_treeViewPanelSelector").length==0){return false}if(jq("#files_prompt_rename").length!=0){return true}var ah=jq("#files_mainContent div.fileRow:not(.checkloading):not(.newFolder):not(.newFile) input:checked").parent().parent();if(ah.length===0){return undefined}var aj=false;ah.each(function(){if(jq(this).parent().attr("id")==jq(ai).attr("id")){aj=true}});if(aj==false){return undefined}ag=ASC.Files.Common.fixEvent(ag);ASC.Files.UI.prevX=ag.pageX;ASC.Files.UI.prevY=ag.pageY;jq("body").unbind("mouseout").mouseout(function(ak){ASC.Files.UI.beginMoveTo(ai,ak);return true}).unbind("mousemove").mousemove(function(ak){ASC.Files.UI.beginMoveTo(ai,ak);return true})};var f=function(aj,ag){ag=ASC.Files.Common.fixEvent(ag);if(!(ag.button==0||(jq.browser.msie&&ag.button==1))||ASC.Files.UI.mouseBtn==false){jq("body").unbind("mouseout").unbind("mousemove");return undefined}if(Math.abs(ag.pageX-ASC.Files.UI.prevX)<5&&Math.abs(ag.pageY-ASC.Files.UI.prevY)<5){return false}ASC.Files.Actions.hideAllActionPanels();var ak=jq("#files_mainContent").offset().left;var al=jq("#files_mainContent").offset().top;var ah=jq("#files_mainContent input[type='checkbox']").parent().parent();var ai;jq("#files_moving").remove();jq("#files_mainContent").parent().append("<div id='files_moving'></div>");if(ASC.Files.UI.viewFolder=="g"){jq("#files_moving").addClass("thumbnails")}ai=jq("#files_moving").css({display:"none",left:ak+"px",top:al+"px","z-index":"300",width:(ASC.Files.UI.viewFolder=="g"?726:722)+"px",height:"auto",position:"absolute",cursor:(jq.browser.msie?"move":"alias")});ah.each(function(){if(jq("input:checked",jq(this)).html()!=null){jq(this).parent().clone(false).fadeTo(0,0.4).appendTo(ai).css({display:"block","background-color":"#DAE8F3"})}else{jq(this).parent().clone(false).fadeTo(0,0.4).appendTo(ai).css({display:"block",visibility:"hidden"})}});jq("*",ai).css("cursor",(jq.browser.msie?"move":"alias"));jq("* [title!='']",ai).attr("title","");jq("div.checkbox",ai).css("visibility","hidden");jq("body").addClass("moveRow");jq("div.folderRow:not(.checkloading):not(.newFolder):not(.row-selected),            ul.files_navigation li a,            ul.favoritesBody li.favoritesRow,            div.levelUp        ").each(function(){var am=this.id.replace("content_folder_","").replace("files_navigation_","").replace("levelUp_","");if(am.search("favoritesRow_")==0){am=jq(this).children(".fav_list").val();if(am.search("file_")==0){am=""}else{am=am.replace("folder_","")}}if(am!=""&&am!=ASC.Files.Folders.currentFolderId&&ASC.Files.UI.accessibleItem("folder_"+am)&&(am!=ASC.Files.Constants.FOLDER_ID_TRASH||ASC.Files.UI.accessibleItem())){jq(this).addClass("may-row-to")}});jq("body").unbind("mouseout").mouseout(function(am){ASC.Files.UI.continueMoveTo(ai,am);return true}).unbind("mousemove").mousemove(function(am){ASC.Files.UI.continueMoveTo(ai,am);return true}).unbind("mouseup").mouseup(function(am){ASC.Files.UI.finishMoveTo(ai,am)})};var l=function(ak,ag){ag=ASC.Files.Common.fixEvent(ag);ASC.Files.Folders.moveToFolder="";if(ASC.Files.UI.mouseBtn==false||ak==undefined){ASC.Files.UI.finishMoveTo(ak,ag);return}if(Math.abs(ag.pageX-ASC.Files.UI.prevX)<5&&Math.abs(ag.pageY-ASC.Files.UI.prevY)<5){return false}var al=ag.pageX+jq("#files_mainContent").offset().left-ASC.Files.UI.prevX;var am=ag.pageY+jq("#files_mainContent").offset().top-ASC.Files.UI.prevY;jq(ak).css({left:al+"px",display:"block",top:am+"px"});if(jq("#files_moving_tooltip").length==0){var ai=jq("#files_mainContent input:checked").parent().parent();var ao="";if(ai.length==1){ao=jq("#"+jq(ai[0]).parent().attr("id")+" div.fileName a.name").attr("title")}else{ao=jq.format(ASC.Files.Resources.InfoSelectCount,ai.length)}ao=jq.format(ASC.Files.Resources.InfoSelectingDescribe,"<b>"+ao+"</b><br/>");jq("#files_mainContent").parent().append("<div id='files_moving_tooltip'></div>");jq("#files_moving_tooltip").html(ao)}jq("#files_moving_tooltip").css({left:ag.pageX+"px",top:ag.pageY+"px"});if(!ASC.Files.UI.accessibleItem()||ag.ctrlKey){if(!jq(ak).hasClass("copy")){jq(ak).css("cursor",(jq.browser.msie?"crosshair":"copy")).addClass("copy");jq("*",ak).css("cursor",(jq.browser.msie?"crosshair":"copy"))}jq("#files_navigation_"+ASC.Files.Constants.FOLDER_ID_TRASH).removeClass("may-row-to")}else{if(jq(ak).hasClass("copy")){jq(ak).css("cursor",(jq.browser.msie?"move":"alias")).removeClass("copy");jq("*",ak).css("cursor",(jq.browser.msie?"move":"alias"))}jq("#files_navigation_"+ASC.Files.Constants.FOLDER_ID_TRASH).addClass("may-row-to")}jq(".row-to").removeClass("row-to");jq(".may-row-to").each(function(){var ar=this.id.replace("content_folder_","").replace("files_navigation_","").replace("levelUp_","");if(ar.search("favoritesRow_")==0){ar=jq(this).children(".fav_list").val();if(ar.search("file_")==0){ar=""}else{ar=ar.replace("folder_","")}}if(ar!=""){var ap=this.offsetWidth;var aq=this.offsetHeight;var at=jq(this).offset();if(at.top<ag.pageY&&at.top+aq>ag.pageY&&at.left<ag.pageX&&at.left+ap>ag.pageX){ASC.Files.Folders.moveToFolder=ar;jq(this).addClass("row-to");return true}}});if(jq.browser.opera){var an=ag.target||ag.srcElement;an=jq(an);if(!an.is("div.fileRow")){an=jq(an).parents(".fileRow")}var aj="fix_select_text";var ah=an.children("#"+aj);if(ah.length==0){jq("#"+aj).remove();var ah=document.createElement("INPUT");ah.style.width=0;ah.style.height=0;ah.style.border=0;ah.style.margin=0;ah.style.padding=0;ah.id=aj;ah.disabled=true;an.prepend(ah);ah=jq("#"+aj)}try{ah.focus()}catch(ag){ah.disabled=false;ah.focus();ah.disabled=true}}};var w=function(ak,ai){var ag={};ag.entry=new Array();var aj=ASC.Files.Folders.moveToFolder;ASC.Files.Folders.moveToFolder="";jq(".row-to").removeClass("row-to");jq(".may-row-to").removeClass("may-row-to");jq("body").removeClass("moveRow");if(aj==ASC.Files.Constants.FOLDER_ID_TRASH){ASC.Files.Folders.deleteItem()}else{if(aj!=""){ASC.Files.Folders.isCopyTo=(!ASC.Files.UI.accessibleItem()||ai.ctrlKey===true);jq("div.fileRow",ak).each(function(){if((this.id.search("content_file_")==0||this.id.search("content_folder_")==0)){if(jq(this).css("visibility")!="hidden"){var al=this.id.replace("content_","");if(ASC.Files.Folders.isCopyTo==true||ASC.Files.UI.accessAdmin(al)){if(ASC.Files.Folders.isCopyTo==true||jq("#file_editing_icn_"+this.id.replace("content_file_","")+":visible").length==0){ASC.Files.UI.blockItem(this.id,true,(ASC.Files.Folders.isCopyTo==true)?ASC.Files.Resources.DescriptCopy:ASC.Files.Resources.DescriptMove);ag.entry.push(al)}}}}});var ah=jq("#content_folder_"+aj+" div.name a").attr("title")||jq("#files_navigation_"+aj+" a").html()||jq("input.fav_list[value='folder_"+aj+"']").parent().children(".fav_folder").html();if(ag.entry&&ag.entry.length!=0){serviceManager.moveFilesCheck(ASC.Files.TemplateManager.events.MoveFilesCheck,{destTitle:ah,destID:aj,list:ag,isCopyOperation:(ASC.Files.Folders.isCopyTo==true)},{stringList:ag})}}}ASC.Files.Folders.isCopyTo=false;jq("body").unbind("mouseout").unbind("mousemove").unbind("mouseup");jq(ak).remove();jq("#files_moving").remove();jq("#files_moving_tooltip").remove()};var k=function(ah,ag){ag=ASC.Files.Common.fixEvent(ag);if(!(ag.button==0||(jq.browser.msie&&ag.button==1))){return true}var ai=ag.target||ag.srcElement;try{if(jq(ai).is("a")||jq(ai).is("div.combobtn")||jq(ai).is("div.fav")||jq(ai).is("a.file_fav_action")||jq(ai).is("a.file_fav_already")){return true}}catch(ag){return true}ASC.Files.UI.selectRow(ah,!jq(ah).hasClass("row-selected"))};var O=function(ah,ai){if(jq(ah).hasClass("row-selected")==ai){return}if(jq(ah).hasClass("checkloading")&&ai){return}if(jq(ah).hasClass("newFolder")||jq(ah).hasClass("rowRename")){ai=false}var ag=jq("input[type='checkbox']",jq(ah));ag.attr("checked",ai===true);if(ai){jq(ah).addClass("row-selected");if(jq.browser.msie){jq(ah).find("*").attr("unselectable","on")}}else{jq(ah).removeClass("row-selected");if(jq.browser.msie){jq(ah).find("*").attr("unselectable","")}}N(jq("#files_mainContent input[type='checkbox']").length==jq("#files_mainContent input:checked").length);if(jq("#files_mainContent input:checked").length==0&&ASC.Files.Folders.folderContainer!="trash"){jq(".mainContentHeader_item_actions").removeClass("display")}else{jq(".mainContentHeader_item_actions").addClass("display")}};var N=function(ag){jq("#files_selectAll_check").attr("checked",ag===true)};var i=function(ag){jq("div.fileRow:not(.checkloading)").each(function(){ASC.Files.UI.selectRow(this,ag)})};var V=function(ag){ag=parseFloat(ag);if(ag>0){jq("#studio_sidePanel div.quotaValue").text(ag+"%").parents("div.studioSideBox").show();jq("#studio_sidePanel div.quotaProgressBar").animate({width:ag+"%"},1000)}else{jq("#studio_sidePanel div.quotaValue").parents("div.studioSideBox").hide()}};var t=function(ai,ah){clearTimeout(aa);if(ah==true){ASC.Files.UI.keepLoading=true}if(jq("#loading_container").length!=0){return}var ag=document.createElement("div");ag.innerHTML=jq.format("{0}<div class='wait_container'>{1}</div>",ASC.Files.Resources.LoadingProcessing,(ai||ASC.Files.Resources.LoadingWait));ag.className="loading_container";ag.setAttribute("id","loading_container");document.body.appendChild(ag);if(ASC.Controls.Constants.isMobileAgent){jq("#loading_container").css("top",jq(window).scrollTop()+150+"px")}jq("body").addClass("loading")};var B=function(ag){if(ASC.Files.UI.keepLoading&&!ag){return}ASC.Files.UI.keepLoading=false;aa=setTimeout(function(){jq("#loading_container").remove();jq("body").removeClass("loading")},10)};var s=function(ag,ah){if(ag===""||typeof ag==="undefined"){return}clearTimeout(Z);jq("#infoPanelContainer").removeClass("warn").children("div").html(ag);jq("#infoPanelContainer").css("margin-left",-jq("#infoPanelContainer").width()/2);if(ASC.Controls.Constants.isMobileAgent){jq("#infoPanelContainer").css("top",jq(window).scrollTop()+"px")}if(ah===true){jq("#infoPanelContainer").addClass("warn")}jq("#infoPanelContainer").show();Z=setTimeout("ASC.Files.UI.hideInfoPanel();",3000)};var z=function(){clearTimeout(Z);jq("#infoPanelContainer").hide().children("div").html("&nbsp;")};var c=function(ai){ai=ai||("folder_"+ASC.Files.Folders.currentFolderId);var ag=ASC.Files.Constants.USER_ADMIN||jq("#by_"+ai).length==0||jq("#by_"+ai).val()==ASC.Files.Constants.USER_ID;if(ASC.Files.Share!=undefined){if(ai=="folder_"+ASC.Files.Constants.FOLDER_ID_COMMON_FILES&&!ASC.Files.Constants.USER_ADMIN){return false}if(ai=="folder_"+ASC.Files.Constants.FOLDER_ID_SHARE){return false}var ah=jq("input[type='hidden']#access_"+ai).val();switch(ah){case ASC.Files.Constants.AceStatusEnum.ReadWrite:return true;break;case ASC.Files.Constants.AceStatusEnum.Read:case ASC.Files.Constants.AceStatusEnum.Restrict:return false;break}ag=true}return ag};var b=function(aj){aj=aj||("folder_"+ASC.Files.Folders.currentFolderId);var ag=(ASC.Files.Constants.USER_ADMIN||jq("#by_"+aj).length==0||jq("#by_"+aj).val()==ASC.Files.Constants.USER_ID);if(ASC.Files.Share!=undefined){var ai=jq("input[type='hidden']#access_"+aj);var ah=(ai.length==0?ASC.Files.Constants.AceStatusEnum.None:ai.val());if(ah==ASC.Files.Constants.AceStatusEnum.Restrict){jq("#content_"+aj).remove();ASC.Files.UI.displayInfoPanel(ASC.Files.Resource.AceStatusEnum_Restrict,true);return false}ag=(ah==ASC.Files.Constants.AceStatusEnum.None||ASC.Files.Folders.folderContainer=="corporate"&&ASC.Files.Constants.USER_ADMIN)}return ag};var G=function(ai){if(ASC.Files.Folders.folderContainer=="forme"&&ASC.Files.Share!=undefined){var ah=jq("input[type='hidden']#access_"+ai);var ag=(ah.length==0?ASC.Files.Constants.AceStatusEnum.None:ah.val());if(ag==ASC.Files.Constants.AceStatusEnum.ReadWrite||ag==ASC.Files.Constants.AceStatusEnum.Read){jq("#share_icn_"+ai).css("display","block");jq("#content_"+ai+" div.fileInfo").addClass("markForMe");return true}}return false};return{init:C,viewFilter:ac,viewSubject:af,viewOrder:ae,viewFolder:ad,currentPage:o,amountPage:e,countEntityInFolder:m,currentRowOver:p,currentCombo:n,showOverwriteMessage:U,switchViewFolder:Y,updateFolderView:ab,setOrderValue:R,setFilterType:P,setFilterValue:Q,setViewFolder:S,defaultFolderSet:q,navigationSet:I,madeAnchor:F,blockItem:h,hideLinks:A,showLinks:T,preparingMoveTo:K,beginMoveTo:f,finishMoveTo:w,continueMoveTo:l,checkSelectAll:i,selectRow:O,clickRow:k,hideEmpty:y,displayEmptyScreen:r,paintRows:J,addRowHandlers:d,resetSelectAll:N,beginSelecting:g,handleMove:x,mouseBtn:H,startX:W,startY:X,prevX:L,prevY:M,keepLoading:E,displayLoading:t,hideLoading:B,displayInfoPanel:s,hideInfoPanel:z,editingFile:v,editableFile:u,showQuota:V,accessibleItem:c,accessAdmin:b,markForMe:G}})(jQuery);(function(a){ASC.Files.UI.init();a(function(){jq("#infoPanelContainer").click(function(){ASC.Files.UI.hideInfoPanel()});jq(document).keydown(function(d){if(jq("div.blockDialog:visible").length!=0||jq("div.files_popup_win:visible").length!=0||jq("#files_prompt_rename").length!=0||jq("#files_prompt_create_folder").length!=0||jq("#files_prompt_create_file").length!=0){return}var b;if(!c){var c=d}c=ASC.Files.Common.fixEvent(c);var f=c.target||c.srcElement;try{if(jq(f).is("input")){return true}}catch(c){return true}if(c.keyCode){b=c.keyCode}else{if(c.which){b=c.which}}if(b==65&&c.ctrlKey){if(jq.browser.opera){setTimeout('jq("#files_selectAll_check").focus()',1)}ASC.Files.UI.checkSelectAll(true);return false}});jq(document).keyup(function(d){if(jq("div.blockDialog:visible").length!=0||jq("div.files_popup_win:visible").length!=0||jq("#files_prompt_rename").length!=0||jq("#files_prompt_create_folder").length!=0||jq("#files_prompt_create_file").length!=0){return}var b;if(!c){var c=d}c=ASC.Files.Common.fixEvent(c);var f=c.target||c.srcElement;try{if(jq(f).is("input")){return true}}catch(c){return true}if(c.keyCode){b=c.keyCode}else{if(c.which){b=c.which}}if(b==46){ASC.Files.Folders.deleteItem();return false}if(b==70&&c.shiftKey){ASC.Files.Folders.createFolder();return false}if(b==78&&c.shiftKey){ASC.Files.Folders.typeNewDoc="text";ASC.Files.Folders.createNewDoc();return false}})})})(jQuery);window.ASC.Files.EventHandler=(function($){var isInit=false;var timoutTasksStatuses=null;var init=function(){if(isInit===false){isInit=true;ASC.Controls.AnchorController.bind(ASC.Files.Constants.anchorRegExp.anyanchor,ASC.Files.EventHandler.onValidationAnchor);ASC.Controls.AnchorController.bind(ASC.Files.Constants.anchorRegExp.error,ASC.Files.EventHandler.onError);ASC.Controls.AnchorController.bind(ASC.Files.Constants.anchorRegExp.folder,ASC.Files.EventHandler.onSelectAnchor);ASC.Controls.AnchorController.bind(ASC.Files.Constants.anchorRegExp.preview,ASC.Files.EventHandler.onPreviewAnchor);serviceManager.bind(ASC.Files.TemplateManager.events.GetFolderItems,ASC.Files.EventHandler.onGetFolderItems);serviceManager.bind(ASC.Files.TemplateManager.events.CheckEditFile,ASC.Files.EventHandler.onCheckEditFile);serviceManager.bind(ASC.Files.TemplateManager.events.GetFolderInfo,ASC.Files.EventHandler.onGetFolderInfo);serviceManager.bind(ASC.Files.TemplateManager.events.CreateFolder,ASC.Files.EventHandler.onCreateFolder);serviceManager.bind(ASC.Files.TemplateManager.events.CreateNewFile,ASC.Files.EventHandler.onCreateNewFile);serviceManager.bind(ASC.Files.TemplateManager.events.GetFile,ASC.Files.EventHandler.onGetFile);serviceManager.bind(ASC.Files.TemplateManager.events.FolderRename,ASC.Files.EventHandler.onRenameFolder);serviceManager.bind(ASC.Files.TemplateManager.events.FileRename,ASC.Files.EventHandler.onRenameFile);serviceManager.bind(ASC.Files.TemplateManager.events.GetFileHistory,ASC.Files.EventHandler.onGetFileHistory);serviceManager.bind(ASC.Files.TemplateManager.events.SetCurrentVersion,ASC.Files.EventHandler.onSetCurrentVersion);serviceManager.bind(ASC.Files.TemplateManager.events.ReplaceVersion,ASC.Files.EventHandler.onReplaceVersion);serviceManager.bind(ASC.Files.TemplateManager.events.MoveFilesCheck,ASC.Files.EventHandler.onMoveFilesCheck);serviceManager.bind(ASC.Files.TemplateManager.events.MoveItems,ASC.Files.EventHandler.onGetTasksStatuses);serviceManager.bind(ASC.Files.TemplateManager.events.DeleteItem,ASC.Files.EventHandler.onGetTasksStatuses);serviceManager.bind(ASC.Files.TemplateManager.events.EmptyTrash,ASC.Files.EventHandler.onGetTasksStatuses);serviceManager.bind(ASC.Files.TemplateManager.events.Download,ASC.Files.EventHandler.onGetTasksStatuses);serviceManager.bind(ASC.Files.TemplateManager.events.TerminateTasks,ASC.Files.EventHandler.onGetTasksStatuses);serviceManager.bind(ASC.Files.TemplateManager.events.GetTasksStatuses,ASC.Files.EventHandler.onGetTasksStatuses)}};var onValidationAnchor=function(anchor){if(ASC.Files.Constants.anchorRegExp.error.test(anchor)||ASC.Files.Constants.anchorRegExp.folder.test(anchor)||ASC.Files.Constants.anchorRegExp.preview.test(anchor)){return}ASC.Files.UI.defaultFolderSet()};var onError=function(errorString){ASC.Files.UI.displayInfoPanel(decodeURIComponent(errorString).replace(/\+/g," "),true);ASC.Files.UI.defaultFolderSet()};var onSelectAnchor=function(itemid,param1,order,galery){jq("#files_trewViewContainer li.jstree-open, #files_trewViewSelector li.jstree-open").addClass("jstree-closed").removeClass("jstree-open");if(order!=undefined&&order!=""){ASC.Files.UI.viewOrder=order}else{ASC.Files.UI.viewOrder="00"}ASC.Files.UI.setViewFolder(galery);if(itemid==parseInt(itemid)){ASC.Files.Folders.currentFolderId=itemid}else{ASC.Files.Folders.currentFolderId=0}ASC.Files.Actions.hideAllActionPanels();ASC.Files.UI.updateFolderView()};var onPreviewAnchor=function(fileId){if(ASC.Files.ImageViewer!=undefined){ASC.Files.ImageViewer.init(fileId)}else{ASC.Files.UI.defaultFolderSet()}};var onGetFolderItems=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);ASC.Files.UI.defaultFolderSet();return undefined}var xslData;if(ASC.Files.UI.viewFolder=="g"){xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFolderItems_thumb);jq("#files_mainContent").addClass("thumbnails")}else{xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFolderItems);jq("#files_mainContent").removeClass("thumbnails")}if(typeof xslData==="undefined"){return undefined}var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);ASC.Files.UI.viewFilter=parseInt(ASC.Files.UI.viewFilter)||0;ASC.Files.UI.resetSelectAll(false);ASC.Files.UI.hideEmpty();if(params.append==true){jq("#files_mainContent").append(htmlXML)}else{jq("#files_mainContent").html(htmlXML)}if(!ASC.Files.Constants.ENABLE_VERSIONS){jq("div.file-info div.version").remove()}jq("div[name='addRow']").each(function(){if(jq("[id='"+this.id+"'][name!='addRow']").length!=0){jq(this).remove()}});var countTotal=0;if(htmlXML!=""){countTotal=xmlData.getElementsByTagName("total")[0];countTotal=parseInt(countTotal.text||countTotal.textContent)||0}ASC.Files.UI.countEntityInFolder=countTotal;var countShowOnPage=parseInt(ASC.Files.Constants.COUNT_ON_PAGE)||0;ASC.Files.UI.amountPage=parseInt((countTotal/countShowOnPage).toFixed(0));if(ASC.Files.UI.amountPage-(countTotal/countShowOnPage)<0){ASC.Files.UI.amountPage++}ASC.Files.UI.currentPage=parseInt((jq("div.fileRow[name!='addRow']").length-1)/countShowOnPage)+1;var countLeft=countTotal-jq("div.fileRow").length;if(ASC.Files.UI.currentPage<ASC.Files.UI.amountPage&&countLeft>0){jq("#files_pageNavigatorHolder").show().children("a").unbind("click").click(function(){ASC.Files.Folders.showMore();return false}).text(countShowOnPage<countLeft?jq.format(ASC.Files.Resources.ButtonShowMoreOf,countShowOnPage,countLeft):jq.format(ASC.Files.Resources.ButtonShowMore,countLeft))}else{jq("#files_pageNavigatorHolder").hide()}if(ASC.Files.Folders.currentFolderId===0){ASC.Files.UI.defaultFolderSet();return}if(onGetFolderInfo(xmlData.getElementsByTagName("folder_info")[0],{id:ASC.Files.Folders.currentFolderId})){return}if(onGetPathParts(xmlData.getElementsByTagName("path_parts")[0],{id:ASC.Files.Folders.currentFolderId})){return}if(htmlXML==""){ASC.Files.UI.displayEmptyScreen()}else{ASC.Files.UI.addRowHandlers()}var tipText=xmlData.getElementsByTagName("tip")[0];if(tipText!=undefined){tipText=tipText.text||tipText.textContent;jq("#tips_side_container").text(tipText)}var quota=xmlData.getElementsByTagName("quota")[0];ASC.Files.UI.showQuota(quota.text||quota.textContent)};var onGetFolderInfo=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return false}if(xmlData==null){ASC.Files.UI.defaultFolderSet();return true}var xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFolderInfo);if(typeof xslData==="undefined"){return false}var htmlData=ASC.Controls.XSLTManager.translate(xmlData,xslData);jq("#headerContainer").html(htmlData);var folderBigIcon=jq("#headerContainer div.folderBigIcon");if(ASC.Files.Share!=undefined){var curAccess=jq("input[type='hidden']#access_folder_"+ASC.Files.Folders.currentFolderId).val();if(curAccess==ASC.Files.Constants.AceStatusEnum.Restrict){ASC.Files.UI.displayInfoPanel(ASC.Files.Resource.AceStatusEnum_Restrict,true);ASC.Files.UI.defaultFolderSet();return true}}switch(ASC.Files.Folders.currentFolderId){case ASC.Files.Constants.FOLDER_ID_TRASH:folderBigIcon.addClass("Trash");break;case ASC.Files.Constants.FOLDER_ID_MY_FILES:folderBigIcon.addClass("myFiles");break;case ASC.Files.Constants.FOLDER_ID_COMMON_FILES:folderBigIcon.addClass("corporateFiles");break;case ASC.Files.Constants.FOLDER_ID_SHARE:folderBigIcon.addClass("sharedformeFiles");break;case ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT:folderBigIcon.addClass("projectFiles");jq(".levelUp").parent().remove();jq("#files_folderName").html(ASC.Files.Resources.ProjectFiles);break;case 0:ASC.Files.UI.defaultFolderSet();return true;break}document.title=jq("#files_folderName").html()+" - "+ASC.Files.Constants.TITLE_PAGE;return false};var onGetPathParts=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return false}if(xmlData==undefined||xmlData==null){return false}if(typeof params!=="object"){params={}}var data=new Array();xmlData=xmlData.childNodes;for(var i=0;i<xmlData.length;i++){data.push({Key:xmlData[i].childNodes[0].textContent||xmlData[i].childNodes[0].text,Value:xmlData[i].childNodes[1].textContent||xmlData[i].childNodes[1].text})}var visibleItems=[];var maxLength=100;var maxLengthItem;var html="";var i;if(ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT!=0){var outside=-1;jq(data).each(function(i){if(this.Key==ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT){outside=i}});if(outside==-1){ASC.Files.UI.navigationSet(ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT);return true}data.splice(0,outside);data[0].Value=ASC.Files.Resources.ProjectFiles}if(data.length>4){maxLengthItem=maxLength/3;visibleItems[0]={id:data[0].Key,title:data[0].Value,content:data[0].Value.substring(0,maxLengthItem)};visibleItems[1]={id:data[data.length-3].Key,content:"...",title:""};jq(data.slice(1,data.length-2)).each(function(index,obj){if(index==data.length-4){visibleItems[1].title+=obj.Value;visibleItems[1].id=obj.Key}else{visibleItems[1].title+=obj.Value+" > "}});visibleItems[2]={id:data[data.length-2].Key,title:data[data.length-2].Value,content:data[data.length-2].Value.substring(0,maxLengthItem)};visibleItems[3]={id:data[data.length-1].Key,title:data[data.length-1].Value,content:data[data.length-1].Value.substring(0,maxLengthItem)}}else{maxLengthItem=maxLength/data.length;for(i=0;i<data.length;i++){var id=data[i].Key;var content=data[i].Value;var title=content;content=content.substring(0,maxLengthItem)+(content.length>maxLengthItem?"...":"");visibleItems[i]={id:id,content:content,title:title}}}ASC.Files.Folders.pathParts=data;for(i=0;i<visibleItems.length;i++){var id=visibleItems[i].id;var content=visibleItems[i].content;var title=visibleItems[i].title;if(i!=visibleItems.length-1){html+=jq.format("<a href='#{0}' onclick='ASC.Files.UI.madeAnchor({0});return false;' title='{1}' >{2}</a><span>{3}</span>",id,title,content,ASC.Files.Resources.BreadCrumbsSeparator)}else{html+=jq.format("<span class='breadCrumbsContainer_currentFolder' title='{0}'>{1}</span>",visibleItems[visibleItems.length-1].title,visibleItems[visibleItems.length-1].content)}}jq("#files_breadCrumbsContainer").html(html);jq("ul.files_navigation li a.current").removeClass("current");if(data.length==0){return false}var container=data[0].Key;jq("#files_navigation_"+container).addClass("current");jq("#files_filter_value_1_, #files_filter_value_2_").show();switch(container){case ASC.Files.Constants.FOLDER_ID_MY_FILES:ASC.Files.Folders.folderContainer="my";break;case ASC.Files.Constants.FOLDER_ID_COMMON_FILES:ASC.Files.Folders.folderContainer="corporate";break;case ASC.Files.Constants.FOLDER_ID_SHARE:ASC.Files.Folders.folderContainer="forme";break;case ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT:ASC.Files.Folders.folderContainer="project";break;case ASC.Files.Constants.FOLDER_ID_TRASH:ASC.Files.Folders.folderContainer="trash";jq(".mainContentHeader_item_actions").addClass("display");break;default:ASC.Files.UI.defaultFolderSet();return true}if(ASC.Files.Share!=undefined&&(container!=ASC.Files.Constants.FOLDER_ID_COMMON_FILES||ASC.Files.Constants.USER_ADMIN)&&container!=ASC.Files.Constants.FOLDER_ID_TRASH&&container!=ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT&&ASC.Files.UI.accessAdmin("folder_"+id)&&jq("#folder_shareable").val()!="false"){jq("#mainMenuHolder").addClass("withShare")}else{jq("#mainMenuHolder").removeClass("withShare")}ASC.Files.UI.markForMe("folder_"+ASC.Files.Folders.currentFolderId);return false};var onCreateNewFile=function(xmlData,params,errorMessage,commentMessage){ASC.Files.UI.blockItem("content_file_NEW_FILE");if(typeof errorMessage!="undefined"){jq("#content_file_NEW_FILE").remove();ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var curTemplate=(ASC.Files.UI.viewFolder=="g"?ASC.Files.TemplateManager.templates.getFolderItem_thumb:ASC.Files.TemplateManager.templates.getFolderItem);var xslData=ASC.Files.TemplateManager.getTemplate(curTemplate);if(typeof xslData==="undefined"){return undefined}var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);jq("#content_file_NEW_FILE").replaceWith(htmlXML);ASC.Files.UI.resetSelectAll(false);var title=jq("div.newFile div.name a").attr("title");var id=jq("div.newFile").attr("id").replace("content_file_","");if(!ASC.Files.Constants.ENABLE_VERSIONS){jq("div.file-info div.version").remove()}var fileId=jq("div.newFile").show().yellowFade().removeClass("newFile").attr("id");ASC.Files.UI.addRowHandlers(fileId);jq("#content_info_count_files").html(1+(parseInt(jq("#content_info_count_files").html())||0));ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoCrateFile,title));var webEditor=ASC.Files.Utils.FileCanBeEdit(title);if(jq.browser.mozilla&&webEditor){jq("#"+fileId).addClass("isNewForWebEditor")}else{ASC.Files.Actions.checkEditFile(id,title,webEditor,true)}};var onCreateFolder=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){jq("#content_folder_NEW_FOLDER").remove();ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var curTemplate=(ASC.Files.UI.viewFolder=="g"?ASC.Files.TemplateManager.templates.getFolderItem_thumb:ASC.Files.TemplateManager.templates.getFolderItem);var xslData=ASC.Files.TemplateManager.getTemplate(curTemplate);if(typeof xslData==="undefined"){return undefined}var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);jq("#content_folder_NEW_FOLDER").replaceWith(htmlXML);ASC.Files.UI.resetSelectAll(false);var title=jq("div.newFolder div.name a").attr("title");var folderId=jq("div.newFolder").yellowFade().removeClass("newFolder").attr("id");ASC.Files.UI.addRowHandlers(folderId);jq("#content_info_count_folders").html(1+(parseInt(jq("#content_info_count_folders").html())||0));jq("#tree_node_"+ASC.Files.Folders.currentFolderId).addClass("jstree-closed").removeClass("jstree-open").children("ul").remove();jq("#stree_node_"+ASC.Files.Folders.currentFolderId).addClass("jstree-closed").removeClass("jstree-open").children("ul").remove();ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoCrateFolder,title))};var onRenameFolder=function(xmlData,params,errorMessage,commentMessage){ASC.Files.UI.blockItem("content_folder_"+params.id);if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var newName=xmlData.childNodes[0].text||xmlData.childNodes[0].textContent;jq("#content_folder_"+params.id+" div.sub-folder").attr("title",newName);jq("#content_folder_"+params.id+" div.folder_thumbnail").attr("title",newName);jq("#content_folder_"+params.id+" div.fileName a.name").attr("title",newName);var clippingTitle=ASC.Files.Utils.clippingTitle(newName,true,(ASC.Files.UI.viewFolder=="g"));jq("#content_folder_"+params.id+" div.fileName a.name").text(clippingTitle);var treeHtml=jq("#tree_selector_"+params.id).html();if(treeHtml!=null){jq("#tree_selector_"+params.id).html(treeHtml.replace(params.name,newName))}treeHtml=jq("#stree_selector_"+params.id).html();if(treeHtml!=null){jq("#stree_selector_"+params.id).html(treeHtml.replace(params.name,newName))}ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoRenameFolder,params.name,newName))};var onRenameFile=function(xmlData,params,errorMessage,commentMessage){ASC.Files.UI.blockItem("content_file_"+params.id);if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var newName=xmlData.childNodes[0].text||xmlData.childNodes[0].textContent;jq("#content_file_"+params.id+" div.folder-file").attr("title",newName);jq("#content_file_"+params.id+" div.folder_thumbnail").attr("title",newName);jq("#content_file_"+params.id+" div.fileName a.name").attr("title",newName);var isEditing=ASC.Files.UI.editableFile("content_file_"+params.id,true)&&!ASC.Files.UI.editingFile("content_file_"+params.id);var clippingTitle=ASC.Files.Utils.clippingTitle(newName,false,(ASC.Files.UI.viewFolder=="g"),isEditing);jq("#content_file_"+params.id+" div.fileName a.name").text(clippingTitle);ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoRenameFile,params.name,newName))};var onSetCurrentVersion=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.blockItem("content_file_"+params.id);jq("div.version_restore,div.versions_btn").css("visibility","");ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var version=(parseInt(jq(".versionRow .version_num:first").html())||0)+1;var modified_on=jq("#content_file_"+params.id+" span.modified_date").html();var href=ASC.Files.Utils.fileDownloadUrl(params.id,version);var content_length=jq("#content_file_"+params.id+" span.content_length").html();var modifiedById=jq("#modified_by_file_"+params.id).val();var modifiedByName=jq("#content_file_"+params.id+" span.create_by").html().trim();var xmlRowString="<fileList withoutheader='true'>    <entry>        <id>"+params.id+"</id>        <modified_by_id>"+modifiedById+"</modified_by_id>        <modified_by>"+modifiedByName+"</modified_by>        <modified_on>"+modified_on+"</modified_on>        <content_length>"+content_length+"</content_length>        <version>"+version+"</version>    </entry></fileList>";var xslDataRow=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFileHistory);if(typeof xslDataRow==="undefined"){return undefined}var lastVersion=ASC.Controls.XSLTManager.translateFromString(xmlRowString,xslDataRow);jq("#content_file_"+params.id+" div.headerTableVersions").after(lastVersion);var tmpTable=jq("#content_file_"+params.id+" div.tableVersionRow");jq("#content_file_"+params.id+" div.headerTableVersions").after(tmpTable.html());tmpTable.remove();jq("div.version_num a:first").attr("href",ASC.Files.Utils.fileViewUrl(params.id,version));jq("div.versionRow.even").removeClass("even");jq("div.versionRow:even").addClass("even");try{var content_versions=jq("#content_file_"+params.id+" #content_versions").clone(true)}catch(ex){ASC.Files.Folders.showVersions("combo_file_"+params.id);return false}var curTemplate=ASC.Files.TemplateManager.templates.getFolderItem;var xslData=ASC.Files.TemplateManager.getTemplate(curTemplate);if(typeof xslData==="undefined"){return undefined}var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);jq("#content_file_"+params.id).replaceWith(htmlXML);var urlIcn=ASC.Files.Utils.getFileTypeIcon(jq("#content_file_"+params.id+" .fileName a.name").attr("title"));jq("#file_icn_"+params.id).css("background","url('"+urlIcn+"') no-repeat");jq("div.newFile").removeClass("newFile").show();jq("#content_file_"+params.id).append(content_versions);ASC.Files.UI.addRowHandlers("content_file_"+params.id);ASC.Files.UI.blockItem("content_file_"+params.id);jq("div.version_restore, div.versions_btn").css("visibility","");ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.FileVersionRecovery,jq("#content_file_"+params.id+" div.fileName a.name").attr("title")),false)};var onGetFileHistory=function(xmlData,params,errorMessage,commentMessage){ASC.Files.UI.blockItem("content_file_"+params.id);ASC.Files.UI.selectRow(jq("#content_file_"+params.id),true);if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var xslData=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFileHistory);if(typeof xslData==="undefined"){return undefined}var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);jq("#content_versions").remove();jq("#content_file_"+params.id).append(htmlXML);var tmpTable=jq("#content_file_"+params.id+" div.tableVersionRow");jq("#content_file_"+params.id+" div.headerTableVersions").after(tmpTable.html());tmpTable.remove();jq("#content_versions div.versionRow").each(function(){var version=this.id.replace("content_fileversion_"+params.id+"_","");jq("div.version_num a",this).attr("href",ASC.Files.Utils.fileViewUrl(params.id,version))});if(!ASC.Files.UI.accessibleItem("file_"+params.id)){jq("div.version_restore, #content_versions_btn").remove()}var titleFile=jq("#content_file_"+params.id+" div.fileName a.name").attr("title");if(ASC.Files.Utils.FileCanBePreview(titleFile)&&ASC.Files.Utils.itIsDocument(titleFile)){jq(".versionsRow.notPreview").removeClass("notPreview")}if(ASC.Controls.Constants.isMobileAgent){jq("#content_versions_btn").remove()}};var onReplaceVersion=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var curTemplate=(ASC.Files.UI.viewFolder=="g"?ASC.Files.TemplateManager.templates.getFolderItem_thumb:ASC.Files.TemplateManager.templates.getFolderItem);var xslData=ASC.Files.TemplateManager.getTemplate(curTemplate);if(typeof xslData==="undefined"){return undefined}var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);jq("#content_file_"+params.id).replaceWith(htmlXML);var urlIcn=ASC.Files.Utils.getFileTypeIcon(jq("#content_file_"+params.id+" .fileName a.name").attr("title"));jq("#file_icn_"+params.id).css("background","url('"+urlIcn+"') no-repeat");if(!ASC.Files.Constants.ENABLE_VERSIONS){jq("div.file-info div.version").remove()}if(params.show){jq("div.newFile").removeClass("newFile").show()}ASC.Files.UI.addRowHandlers("content_file_"+params.id);if(params.showVer==true){ASC.Files.Folders.showVersions("combo_file_"+params.id)}};var onGetFile=function(xmlData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}var curTemplate=(ASC.Files.UI.viewFolder=="g"?ASC.Files.TemplateManager.templates.getFolderItem_thumb:ASC.Files.TemplateManager.templates.getFolderItem);var xslData=ASC.Files.TemplateManager.getTemplate(curTemplate);if(typeof xslData==="undefined"){return undefined}var htmlXML=ASC.Controls.XSLTManager.translate(xmlData,xslData);if(jq("#files_mainContent div.fileRow").length==0){jq("#files_mainContent").append(htmlXML)}else{jq(jq("#files_mainContent div.fileRow")[0]).before(htmlXML)}jq("#content_info_count_files").html(1+(parseInt(jq("#content_info_count_files").html())||0));if(!ASC.Files.Constants.ENABLE_VERSIONS){jq("div.file-info div.version").remove()}if(params.show){jq("div.newFile").removeClass("newFile").show()}ASC.Files.UI.resetSelectAll()};var onMoveFilesCheck=function(data,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){jq(params.list.entry).each(function(){ASC.Files.UI.blockItem("content_"+this)});ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}data=eval(data);if(data!=null&&data.length>0){ASC.Files.UI.showOverwriteMessage(params.list,params.destID,params.destTitle,params.isCopyOperation,data)}else{serviceManager.moveItems(ASC.Files.TemplateManager.events.MoveItems,{destID:params.destID,overwrite:false,isCopyOperation:params.isCopyOperation},{stringList:params.list});ASC.Files.Folders.isCopyTo=false}};var onMoveItemsFinish=function(list,isMoveOperation,countProcessed){var destID=list[0].replace("folder_","");list=list.slice(1);for(var i=0;i<list.length;i++){ASC.Files.UI.blockItem("content_"+list[i])}jq("#content_folder_"+destID).removeClass("row-to");var foldersCount=0,filesCount=0;if(list.length==1){var title=jq("#content_"+list[0]+" div.name a").attr("title")}for(var i=0;i<list.length;i++){if(list[i].search("folder_")==0){foldersCount+=1+(parseInt(jq("#content_folder_countFolders_"+list[i].replace("folder_","")).html())||0);filesCount+=parseInt(jq("#content_folder_countFiles_"+list[i].replace("folder_","")).html())||0}else{if(list[i].search("file_")==0){filesCount++}}if(isMoveOperation&&ASC.Files.Folders.currentFolderId!=destID){jq("#content_"+list[i]).remove()}}if(foldersCount>0){jq("#content_folder_countFolders_"+destID).html((parseInt(jq("#content_folder_countFolders_"+destID).html())||0)+foldersCount);jq("#tree_node_"+destID).addClass("jstree-closed").removeClass("jstree-open").children("ul").remove();jq("#stree_node_"+destID).addClass("jstree-closed").removeClass("jstree-open").children("ul").remove();if(isMoveOperation&&destID!=ASC.Files.Folders.currentFolderId){jq("#tree_node_"+ASC.Files.Folders.currentFolderId).addClass("jstree-closed").removeClass("jstree-open").children("ul").remove();jq("#stree_node_"+ASC.Files.Folders.currentFolderId).addClass("jstree-closed").removeClass("jstree-open").children("ul").remove()}}if(filesCount>0){jq("#content_folder_countFiles_"+destID).html((parseInt(jq("#content_folder_countFiles_"+destID).html())||0)+filesCount)}if(list.length>0){ASC.Files.Folders.getFolderInfo()}if(list.length>0&&ASC.Files.Folders.currentFolderId!=destID){ASC.Files.UI.paintRows();var countAppend=ASC.Files.Constants.COUNT_ON_PAGE-jq("#files_mainContent input[type='checkbox']").length;if(countAppend>0){if(ASC.Files.UI.currentPage<ASC.Files.UI.amountPage){ASC.Files.Folders.getFolderItems(true,countAppend)}else{if(countAppend>=ASC.Files.Constants.COUNT_ON_PAGE){ASC.Files.UI.displayEmptyScreen()}}}}if(isMoveOperation){if(list.length==1&&title!=undefined){ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoMoveItem,title))}else{ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoMoveGroup,countProcessed))}if(ASC.Files.Favorites){ASC.Files.Favorites.showFavorite()}}else{if(list.length==1&&title!=undefined){ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoCopyItem,title))}else{ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoCopyGroup,countProcessed))}}};var onDeleteItemFinish=function(list,totalCount){var fromRootID=list[0].replace("folder_","");list=list.slice(1);for(var i=0;i<list.length;i++){ASC.Files.UI.blockItem("content_"+list[i])}var foldersCount=0;var countSubFolder=0,countSubFile=0;if(list.length==1){var title=jq("#content_"+list[0]+" div.name a").attr("title")}for(var i=0;i<list.length;i++){if(list[i].search("folder_")==0){foldersCount++;countSubFolder+=1+(parseInt(jq("#content_folder_countFolders_"+list[i].replace("folder_","")).html())||0);countSubFile+=parseInt(jq("#content_folder_countFiles_"+list[i].replace("folder_","")).html())||0}else{countSubFile++}if(ASC.Files.Folders.pathParts[0].Key===fromRootID){jq("#content_"+list[i]).remove()}}if(jq("#files_favoritesBody").html()!=null&&jq("#files_favoritesBody").html().length==0){jq("#files_favoritesBody").hide();jq("#files_favoritesEmpty").show()}if(foldersCount>0){jq("#tree_node_"+ASC.Files.Folders.currentFolderId).addClass("jstree-closed").removeClass("jstree-open").children("ul").remove();jq("#stree_node_"+ASC.Files.Folders.currentFolderId).addClass("jstree-closed").removeClass("jstree-open").children("ul").remove()}if(list.length>0&&ASC.Files.Folders.pathParts[0].Key===fromRootID){jq("#content_info_count_folders").html((parseInt(jq("#content_info_count_folders").html())||0)-countSubFolder);jq("#content_info_count_files").html((parseInt(jq("#content_info_count_files").html())||0)-countSubFile);ASC.Files.UI.paintRows();var countAppend=ASC.Files.Constants.COUNT_ON_PAGE-jq("#files_mainContent input[type='checkbox']").length;if(countAppend>0){if(ASC.Files.UI.currentPage<ASC.Files.UI.amountPage){ASC.Files.Folders.getFolderItems(true,countAppend)}else{if(countAppend>=ASC.Files.Constants.COUNT_ON_PAGE){ASC.Files.UI.displayEmptyScreen()}}}}if(list.length==1&&title!=undefined){if(foldersCount>0){ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoRemoveFolder,title))}else{ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoRemoveFile,title))}}else{ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoRemoveGroup,list.length,totalCount))}if(ASC.Files.Favorites){ASC.Files.Favorites.showFavorite()}};var onCheckEditFile=function(jsonData,params,errorMessage,commentMessage){if(typeof errorMessage!="undefined"){ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return undefined}jsonData=jsonData.trim();if(jsonData==""){return}jq("#file_editing_icn_"+params.fileID).show();jq("#file_IsEditing_"+params.fileID).val("true");serviceManager.openFile(params.fileID,params.title,jsonData)};var onGetTasksStatuses=function(data,params,errorMessage,commentMessage){if(typeof data!=="object"&&typeof errorMessage!="undefined"||data==null){ASC.Files.Folders.cancelTasksStatuses();if(ASC.Files.Import){ASC.Files.Import.cancelImportData("")}ASC.Files.UI.displayInfoPanel(commentMessage||errorMessage,true);return}if(data.length==0){ASC.Files.Folders.cancelTasksStatuses();if(ASC.Files.Import){ASC.Files.Import.cancelImportData("")}return}var finishImport=true;var progress=0;var operationType="";var operationTypes=[ASC.Files.Resources.TasksOperationMove,ASC.Files.Resources.TasksOperationCopy,ASC.Files.Resources.TasksOperationDelete,ASC.Files.Resources.TasksOperationBulkdownload];var blockTypes=[ASC.Files.Resources.DescriptMove,ASC.Files.Resources.DescriptCopy,ASC.Files.Resources.DescriptRemove,ASC.Files.Resources.DescriptBulkdownload];for(var i=0;i<data.length&&ASC.Files.Import;i++){if(data[i].operation==4){finishImport=ASC.Files.Import.onGetImportStatus(data.splice(i,1)[0]);break}}if(data.length!=0){if(jq("#files_tasks:visible").length==0){clearTimeout(timoutTasksStatuses);if(jq("#files_tasks").length==0){jq("#files_progress_template").clone().attr("id","files_tasks").appendTo("#files_bottom_loader");jq("#files_tasks").prepend(jq.format('<div onclick="ASC.Files.Folders.terminateTasks();return false;" title="{0}"                                                             class="terminateTasks"></div>',ASC.Files.Resources.TitleCancel))}jq("#files_tasks .progress").css("width","0%");jq("#files_tasks .percent").text("0%").css("color","#1A6DB3");jq("#files_tasks .headerBaseMedium").html("");jq("#files_tasks").show();if(ASC.Controls.Constants.isMobileAgent){jq("#files_bottom_loader").css("bottom","auto");jq("#files_bottom_loader").css("top",jq(window).scrollTop()+jq(window).height()-jq("#files_bottom_loader").height()+"px")}}if(data.length>1){operationType=jq.format(ASC.Files.Resources.TasksOperationMixed,data.length)}else{operationType=operationTypes[data[0].operation]}jq("#files_tasks .headerBaseMedium").html(operationType)}for(var i=0;i<data.length;i++){var listSource=data[i].source.trim().split(" ");jq(listSource).each(function(){ASC.Files.UI.blockItem("content_"+this,true,blockTypes[data[i].operation])});var curProgress=data[i].progress;progress+=curProgress;if(curProgress==100){if(data[i].result!=null){var listResult=new Array();listResult=data[i].result.trim().split(" ");switch(data[i].operation){case 0:onMoveItemsFinish(listResult,true,data[i].processed);break;case 1:onMoveItemsFinish(listResult,false,data[i].processed);break;case 2:onDeleteItemFinish(listResult,listSource.length);break;case 3:if(listResult[0]){location.href=listResult[0]}ASC.Files.Folders.bulkStatuses=false;break}}jq(listSource).each(function(){ASC.Files.UI.blockItem("content_"+this)});if(data[i].error!=null){ASC.Files.UI.displayInfoPanel(data[i].error,true)}}}progress=(data.length==0?100:progress/data.length);jq("#files_tasks .progress").css("width",progress+"%");jq("#files_tasks .percent").text(progress+"%").css("color",progress>45?"white":"#1A6DB3");if(progress==100){clearTimeout(timoutTasksStatuses);timoutTasksStatuses=setTimeout("ASC.Files.Folders.cancelTasksStatuses()",500);if(finishImport){return}}ASC.Files.Folders.getTasksStatuses()};return{init:init,onError:onError,onValidationAnchor:onValidationAnchor,onSelectAnchor:onSelectAnchor,onPreviewAnchor:onPreviewAnchor,onGetFolderItems:onGetFolderItems,onGetFolderInfo:onGetFolderInfo,onGetPathParts:onGetPathParts,onGetFile:onGetFile,onCreateNewFile:onCreateNewFile,onCreateFolder:onCreateFolder,onRenameFolder:onRenameFolder,onRenameFile:onRenameFile,onSetCurrentVersion:onSetCurrentVersion,onGetFileHistory:onGetFileHistory,onReplaceVersion:onReplaceVersion,onCheckEditFile:onCheckEditFile,onMoveFilesCheck:onMoveFilesCheck,onGetTasksStatuses:onGetTasksStatuses}})(jQuery);(function(a){ASC.Files.EventHandler.init();a(function(){})})(jQuery);window.ASC.Files.Folders=(function(a){var K;var b=false;var l=0;var q=false;var s=false;var r="";var p=null;var M="";var D="";var k="";var E=false;var B=false;var F;var f=null;var v=function(O,N){serviceManager.getFolderItems(ASC.Files.TemplateManager.events.GetFolderItems,{id:ASC.Files.Folders.currentFolderId,from:(O?jq("div.fileRow[name!='addRow']").length:0),count:N||ASC.Files.Constants.COUNT_ON_PAGE,filter:parseInt(ASC.Files.UI.viewFilter),subject:ASC.Files.UI.viewSubject,append:O===true,setThumbnailURLBool:(ASC.Files.UI.viewFolder=="g")},{orderBy:y()})};var z=function(N){return x("DateAndTime",N)};var y=function(){var O="DateAndTime";var N=false;if(ASC.Files.UI.viewOrder!="00"&&ASC.Files.UI.viewOrder.length==2){N=(ASC.Files.UI.viewOrder.charAt(0)!="0");switch(ASC.Files.UI.viewOrder.charAt(1)){case"1":O="AZ";break;case"2":O="Size";break;case"3":O="DateAndTime";break;case"4":O="Author";break;default:O="DateAndTime"}}jq(".files_sort_asc, .files_sort_desc").removeClass("files_sort_asc files_sort_desc");jq("#files_sort_value").html(jq("#files_sort_"+O+" a").html()).removeClass("files_sort_asc files_sort_desc").addClass("files_sort_"+(N?"asc":"desc"));jq("#files_sort_"+O+" a").addClass("files_sort_"+(N?"asc":"desc"));return x(O,N)};var x=function(P,N){var O={};O.is_asc=(N==true);O.property=P;return O};var e=function(N,O){if(ASC.Files.Folders.folderContainer=="trash"&&!O){ASC.Files.Actions.onContextMenu("folder_"+N);return}ASC.Files.UI.madeAnchor(N)};var d=function(N,R,P,O){if(ASC.Files.Folders.folderContainer=="trash"&&!O){ASC.Files.Actions.onContextMenu("file_"+N);return}if(P==undefined||P==null){P=jq("#content_file_"+N+" .fileName a.name").attr("title")}if(R==undefined||R==null){R=jq("#file_version_"+N).val()||""}if(ASC.Files.Utils.FileCanBePreview(P)){var Q=ASC.Files.Utils.getPreviewUrl(P,N,R);if(ASC.Files.Utils.itIsDocument(P)){window.open(Q,"_blank")}else{ASC.Controls.AnchorController.move(Q)}return}window.open(ASC.Files.Utils.fileViewUrl(N,R),"_blank")};var n=function(P,R){if(P!=undefined){P=P.replace("combo_","")}else{var Q=jq("#files_mainContent input:checked");if(Q.length==0){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.EmptyListSelectedForDownload,true);return}if(Q.length==1){P=Q[0].id.replace("check_","")}}if(P!=undefined&&P.indexOf("file")!=-1){P=P.replace("file_","");if(R!=undefined){var O=R}else{O=jq("#file_version_"+P).val()}location.href=ASC.Files.Utils.fileDownloadUrl(P,O)}else{if(ASC.Files.Folders.bulkStatuses==true){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.ErrorMassage_SecondDownload,true);return}var N={};N.entry=new Array();if(P!=undefined){N.entry.push(P)}else{Q.each(function(){N.entry.push(this.id.replace("check_",""))})}ASC.Files.Folders.bulkStatuses=true;serviceManager.download(ASC.Files.TemplateManager.events.Download,{},{stringList:N})}};var h=function(){if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.ErrorMassage_SecurityException,true);ASC.Files.Folders.eventAfter=h;ASC.Files.UI.defaultFolderSet();return}jq(document).scrollTo(0);if(ASC.Controls.Constants.isMobileAgent){ASC.Files.MainMenu.toggleMainMenu()}if(jq("#files_prompt_create_folder").length!=0){return}var O={folder:{id:"NEW_FOLDER",title:ASC.Files.Resources.TitleNewFolder}};var V=serviceManager.jsonToXml(O);var N=(ASC.Files.UI.viewFolder=="g"?ASC.Files.TemplateManager.templates.getFolderItem_thumb:ASC.Files.TemplateManager.templates.getFolderItem);var W=ASC.Files.TemplateManager.getTemplate(N);if(typeof W==="undefined"){return undefined}try{var Q=ASC.Controls.XSLTManager.translateFromString(V,W)}catch(P){return undefined}ASC.Files.UI.hideEmpty();var R=jq("#files_mainContent");if(R.children().length==0){R.append(Q)}else{jq(jq(R).children()[0]).before(Q)}ASC.Files.UI.paintRows();jq("div.newFolder").yellowFade();var T=jq("#content_folder_NEW_FOLDER div.fileName a.name");var S=document.createElement("input");S.id="files_prompt_create_folder";S.type="text";S.style.display="none";document.body.appendChild(S);S=jq("#files_prompt_create_folder");S.attr("maxlength",ASC.Files.Constants.MAX_NAME_LENGTH);S.addClass("textEdit renameInput");S.val(ASC.Files.Resources.TitleNewFolder);S.insertAfter(T);S.show();T.hide();S.focus().select();var U=function(){var X=ASC.Files.Utils.replaceSpecCharacter(jq("#files_prompt_create_folder").val().trim());jq("#content_folder_NEW_FOLDER div.fileName a.name").show();jq("#files_prompt_create_folder").remove();jq("#content_folder_NEW_FOLDER div.renameAction").remove();if(X==""||X==null){X=ASC.Files.Resources.TitleNewFolder}ASC.Files.UI.blockItem("content_folder_NEW_FOLDER",true,ASC.Files.Resources.DescriptCreate);serviceManager.createFolder(ASC.Files.TemplateManager.events.CreateFolder,{parentFolderID:ASC.Files.Folders.currentFolderId,title:X})};jq("#content_folder_NEW_FOLDER").append("<div class='renameAction'><div class='apllyName' title="+ASC.Files.Resources.TitleCreate+"></div><div class='cancelName' title="+ASC.Files.Resources.TitleCancel+"></div></div>");jq("#content_folder_NEW_FOLDER div.apllyName").click(U);jq("#content_folder_NEW_FOLDER div.cancelName").click(function(){jq("#content_folder_NEW_FOLDER").remove();if(jq("#files_mainContent input[type='checkbox']").length==0){ASC.Files.UI.displayEmptyScreen()}});jq("#files_prompt_create_folder").keyup(function(Z){if(jq("#files_prompt_create_folder").length==0){return}var X;if(!Y){var Y=Z}if(Y.keyCode){X=Y.keyCode}else{if(Y.which){X=Y.which}}if(X==27){jq("#content_folder_NEW_FOLDER").remove();if(jq("#files_mainContent input[type='checkbox']").length==0){ASC.Files.UI.displayEmptyScreen()}}else{if(X==13){U()}}})};var i=function(){jq(document).scrollTo(0);if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.ErrorMassage_SecurityException,true);ASC.Files.Folders.eventAfter=i;ASC.Files.UI.defaultFolderSet();return}if(jq("#files_prompt_create_file").length!=0){return}var X;switch(ASC.Files.Folders.typeNewDoc){case"text":X=ASC.Files.Resources.TitleNewFileText+ASC.Files.Utils.typeNewDoc.text;break;case"spreadsheet":X=ASC.Files.Resources.TitleNewFileSpreadsheet+ASC.Files.Utils.typeNewDoc.spreadsheet;break;case"presentation":X=ASC.Files.Resources.TitleNewFilePresentation+ASC.Files.Utils.typeNewDoc.presentation;break;default:return}if(!ASC.Files.Utils.FileCanBeEdit(X)){switch(ASC.Files.Plugin.GetOpenOfficeState()){case ASC.Files.Plugin.OPEN_OFFICE_STATE_NOT_INSTALLED:case ASC.Files.Plugin.OPEN_OFFICE_STATE_INSTALLING:jq("#plugin_informer").slideDown();return}}var O={file:{id:"NEW_FILE",title:X}};var W=serviceManager.jsonToXml(O);var N=(ASC.Files.UI.viewFolder=="g"?ASC.Files.TemplateManager.templates.getFolderItem_thumb:ASC.Files.TemplateManager.templates.getFolderItem);var Y=ASC.Files.TemplateManager.getTemplate(N);if(typeof Y==="undefined"){return undefined}try{var Q=ASC.Controls.XSLTManager.translateFromString(W,Y)}catch(P){return undefined}ASC.Files.UI.hideEmpty();var S=jq("#files_mainContent");if(S.children().length==0){S.append(Q)}else{jq(jq(S).children()[0]).before(Q)}jq("div.newFile").show().yellowFade();ASC.Files.UI.paintRows();var U=jq("#content_file_NEW_FILE div.fileName a.name");jq("#content_file_NEW_FILE").addClass("rowRename");var R=ASC.Files.Utils.getFileExts(X).length;X=X.substring(0,X.length-R);var T=document.createElement("input");T.id="files_prompt_create_file";T.type="text";T.style.display="none";document.body.appendChild(T);T=jq("#files_prompt_create_file");T.attr("maxlength",ASC.Files.Constants.MAX_NAME_LENGTH-R);T.addClass("textEdit renameInput");T.val(X);T.insertAfter(U);T.show().focus().select();var V=function(){if(jq("#files_prompt_create_file").length===0){return}var aa=ASC.Files.Utils.replaceSpecCharacter(jq("#files_prompt_create_file").val().trim());var ab=jq("#content_file_NEW_FILE div.fileName a.name").attr("title");if(aa==""||aa==null){aa=ab}else{var Z=ASC.Files.Utils.getFileExts(ab).length;aa+=ab.substring(ab.length-Z)}jq("#content_file_NEW_FILE").removeClass("rowRename");jq("#files_prompt_create_file").remove();jq("#content_file_NEW_FILE div.renameAction").remove();var ac={};ac.folderID=ASC.Files.Folders.currentFolderId;ac.fileTitle=aa;ASC.Files.UI.blockItem("content_file_NEW_FILE",true,ASC.Files.Resources.DescriptCreate);serviceManager.createNewFile(ASC.Files.TemplateManager.events.CreateNewFile,ac)};jq("#content_file_NEW_FILE").append("<div class='renameAction'><div class='apllyName' title="+ASC.Files.Resources.TitleCreate+"></div><div class='cancelName' title="+ASC.Files.Resources.TitleCancel+"></div></div>");jq("#content_file_NEW_FILE div.apllyName").click(V);jq("#content_file_NEW_FILE div.cancelName").click(function(){jq("#content_file_NEW_FILE").remove();if(jq("#files_mainContent input[type='checkbox']").length==0){ASC.Files.UI.displayEmptyScreen()}});jq("#files_prompt_create_file").keyup(function(ab){if(jq("#files_prompt_create_file").length==0){return}var Z;if(!aa){var aa=ab}if(aa.keyCode){Z=aa.keyCode}else{if(aa.which){Z=aa.which}}if(Z==27){jq("#content_file_NEW_FILE").remove();if(jq("#files_mainContent input[type='checkbox']").length==0){ASC.Files.UI.displayEmptyScreen()}}else{if(Z==13){V()}}})};var J=function(P){if(ASC.Files.Folders.folderContainer=="trash"){return}var O=P.replace("combo_file_","");var N=jq("#content_file_"+O+" #content_versions");if(N.length!=0){g();return}ASC.Files.UI.blockItem("content_file_"+O,true,ASC.Files.Resources.DescriptLoadVersion);serviceManager.getFileHistory(ASC.Files.TemplateManager.events.GetFileHistory,{id:O},{})};var C=function(N,O){jq("div.version_restore,div.versions_btn").css("visibility","hidden");ASC.Files.UI.blockItem("content_file_"+N,true,ASC.Files.Resources.DescriptSetVersion);serviceManager.setCurrentVersion(ASC.Files.TemplateManager.events.SetCurrentVersion,{id:N,version:O})};var g=function(){jq("#content_versions").remove();jq(".row-over").removeClass("row-over")};var H=function(N,P,O){serviceManager.getFile(ASC.Files.TemplateManager.events.ReplaceVersion,{id:N,showVer:P,show:O,setThumbnailURLBool:(ASC.Files.UI.viewFolder=="g")})};var u=function(){serviceManager.getFolderInfo(ASC.Files.TemplateManager.events.GetFolderInfo,{id:ASC.Files.Folders.currentFolderId})};var j=function(P,O){var Q=new Array();Q.push((ASC.Files.Folders.multiMoveTo?"check_folder_":"combo_folder_")+P);jq("#stree_node_"+P).parents("li").each(function(){Q.push(this.id.replace("stree_node_",ASC.Files.Folders.multiMoveTo?"check_folder_":"combo_folder_"))});var N={};N.entry=new Array();if(ASC.Files.Folders.multiMoveTo==true){jq("#files_mainContent div.fileRow:not(.checkloading):not(.newFolder):not(.newFile) input:checked").each(function(){var R=this.id.replace("content_","");if(jq("#file_editing_icn_"+this.id.replace("check_file_","")+":visible").length==0&&(ASC.Files.Folders.isCopyTo==true||ASC.Files.UI.accessAdmin(R))){if(jq.inArray(this.id,Q)!=-1){ASC.Files.UI.displayInfoPanel(((ASC.Files.Folders.isCopyTo==true)?ASC.Files.Resources.InfoFolderCopyError:ASC.Files.Resources.InfoFolderMoveError),true)}else{ASC.Files.UI.blockItem(this.id.replace("check","content"),true,(ASC.Files.Folders.isCopyTo==true)?ASC.Files.Resources.DescriptCopy:ASC.Files.Resources.DescriptMove);N.entry.push(this.id.replace("check_",""))}}})}else{if(ASC.Files.Folders.curItemMoveTo!=null&&ASC.Files.Folders.curItemMoveTo!=""){if(jq.inArray(ASC.Files.Folders.curItemMoveTo,Q)!=-1){ASC.Files.UI.displayInfoPanel(((ASC.Files.Folders.isCopyTo==true)?ASC.Files.Resources.InfoFolderCopyError:ASC.Files.Resources.InfoFolderMoveError),true)}else{ASC.Files.UI.blockItem(ASC.Files.Folders.curItemMoveTo.replace("combo","content"),true,(ASC.Files.Folders.isCopyTo==true)?ASC.Files.Resources.DescriptCopy:ASC.Files.Resources.DescriptMove);N.entry.push(ASC.Files.Folders.curItemMoveTo.replace("combo_",""))}}}ASC.Files.Actions.hideAllActionPanels();if(N.entry&&N.entry.length!=0){serviceManager.moveFilesCheck(ASC.Files.TemplateManager.events.MoveFilesCheck,{destTitle:O,destID:P,list:N,isCopyOperation:(ASC.Files.Folders.isCopyTo==true)},{stringList:N})}ASC.Files.Folders.isCopyTo=false};var I=function(){jq("#files_pageNavigatorHolder a").unbind("click").text(ASC.Files.Resources.ButtonShowMoreLoad);ASC.Files.Folders.getFolderItems(true)};var o=function(){if(ASC.Files.Folders.folderContainer!="trash"){return}ASC.Files.Actions.hideAllActionPanels();ASC.Files.UI.checkSelectAll(true);jq("#confirmRemoveText").html("<b>"+ASC.Files.Resources.ConfirmEmptyTrash+"</b>");jq("#confirmRemoveList").hide();jq("#confirmRemoveTextDescription").show();jq("#removeConfirmBtn").unbind("click").click(function(){PopupKeyUpActionProvider.CloseDialog();serviceManager.emptyTrash(ASC.Files.TemplateManager.events.EmptyTrash,{})});ASC.Files.Common.blockUI(jq("#files_confirm_remove"),420,0,-150);PopupKeyUpActionProvider.EnterAction='jq("#removeConfirmBtn").click();'};var m=function(P){if(!ASC.Files.UI.accessibleItem()){return}ASC.Files.Actions.hideAllActionPanels();var N="";var Q=new Array();if(P==undefined){jq("#files_mainContent div.fileRow:not(.checkloading):not(.newFolder):not(.newFile) input:checked").each(function(){var U=jq(this).attr("id").replace("check_","");if(jq("#file_editing_icn_"+U.replace("file_","")+":visible").length==0&&ASC.Files.UI.accessAdmin(U)){Q.push(U)}});N=ASC.Files.Resources.ConfirmRemoveList}else{if(ASC.Files.UI.accessAdmin(P)){Q.push(P)}else{return}if(P.search("folder_")==0){N=ASC.Files.Resources.ConfirmRemoveFolder}else{if(jq("#file_editing_icn_"+P+":visible").length!=0){return}N=ASC.Files.Resources.ConfirmRemoveFile}}if(Q.length==0){return}var T="";var S="";for(var O=0;O<Q.length;O++){var R=jq("#content_"+Q[O]+" div.fileName a.name").attr("title");if(Q[O].search("folder_")==0){T+=jq.format("<div title='{0}'>{0}</div>",R)}else{S+=jq.format("<div title='{0}'>{0}</div>",R)}}jq("#confirmRemoveText").html("<b>"+N+"</b>");jq("#confirmRemoveList dd.confirmRemoveFiles").html(S);jq("#confirmRemoveList dd.confirmRemoveFolders").html(T);jq("#confirmRemoveList, .confirmRemoveFolders,.confirmRemoveFiles").show();if(T==""){jq(".confirmRemoveFolders").hide()}if(S==""){jq(".confirmRemoveFiles").hide()}if(ASC.Files.Folders.folderContainer=="trash"||ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT!=0){jq("#confirmRemoveTextDescription").show()}else{jq("#confirmRemoveTextDescription").hide()}jq("#removeConfirmBtn").unbind("click").click(function(){PopupKeyUpActionProvider.CloseDialog();var U={};U.entry=new Array();for(var V=0;V<Q.length;V++){ASC.Files.UI.blockItem("content_"+Q[V],true,ASC.Files.Resources.DescriptRemove);U.entry.push(Q[V])}serviceManager.deleteItem(ASC.Files.TemplateManager.events.DeleteItem,{list:Q},{stringList:U})});ASC.Files.Common.blockUI(jq("#files_confirm_remove"),420,0,-150);PopupKeyUpActionProvider.EnterAction='jq("#removeConfirmBtn").click();'};var G=function(O){var P;var R;var N;var T;var Q=0;if(jq("#files_prompt_rename").length!=0){jq("div.fileRow.rowRename div.cancelName").click()}if(O.indexOf("combo_file_")!=-1){P=O.replace("combo_file_","");T=jq("#content_file_"+P+" div.fileName a.name");jq("#content_file_"+P).addClass("rowRename");ASC.Files.UI.selectRow(jq("#content_file_"+P),false);R=T.attr("title");Q=ASC.Files.Utils.getFileExts(R).length;R=R.substring(0,R.length-Q)}else{P=O.replace("combo_folder_","");T=jq("#content_folder_"+P+" div.fileName a.name");jq("#content_folder_"+P).addClass("rowRename");ASC.Files.UI.selectRow(jq("#content_folder_"+P),false);R=T.attr("title")}var S=document.createElement("input");S.id="files_prompt_rename";S.type="text";S.style.display="none";document.body.appendChild(S);S=jq("#files_prompt_rename");S.attr("maxlength",ASC.Files.Constants.MAX_NAME_LENGTH-Q);S.addClass("textEdit renameInput");S.val(R);S.insertAfter(T);S.show().focus().select();var V=function(){var Y=ASC.Files.Utils.replaceSpecCharacter(jq("#files_prompt_rename").val().trim());if(Y==""||Y==null){return}var W=jq("#files_prompt_rename").parents("div.fileRow").attr("id");var Z=jq("#"+W+" div.fileName a.name").attr("title");if(W.indexOf("content_file_")!=-1){var X=ASC.Files.Utils.getFileExts(Z).length;Y+=Z.substring(Z.length-X)}jq("#"+W).removeClass("rowRename");jq("#files_prompt_rename").remove();jq("#"+W+" .renameAction").remove();if(Y!=Z){ASC.Files.UI.blockItem(W,true,ASC.Files.Resources.DescriptRename);if(W.indexOf("content_file_")!=-1){serviceManager.renameFile(ASC.Files.TemplateManager.events.FileRename,{id:W.replace("content_file_",""),name:Z,newname:Y})}else{serviceManager.renameFolder(ASC.Files.TemplateManager.events.FolderRename,{id:W.replace("content_folder_",""),name:Z,newname:Y})}}};var U=O.replace("combo_","content_");jq("#"+U).append("<div class='renameAction'><div class='apllyName' title="+ASC.Files.Resources.TitleRename+"></div><div class='cancelName' title="+ASC.Files.Resources.TitleCancel+"></div></div>");jq("#"+U+" div.apllyName").click(V);jq("#"+U+" div.cancelName").click(function(){var W=jq("#files_prompt_rename").parents("div.fileRow").attr("id");jq("#files_prompt_rename").remove();jq("#"+W).removeClass("rowRename");jq("#"+W+" .renameAction").remove()});jq("#"+U).removeClass("row-selected");jq("#files_prompt_rename").keyup(function(Z){if(jq("#files_prompt_rename").length===0){return}var W;if(!Y){var Y=Z}if(Y.keyCode){W=Y.keyCode}else{if(Y.which){W=Y.which}}if((W==27||W==13)&&jq("#files_prompt_rename").length!=0){if(W==27){var X=jq("#files_prompt_rename").parents("div.fileRow").attr("id");jq("#files_prompt_rename").remove();jq("#"+X).removeClass("rowRename");jq("#"+X+" .renameAction").remove()}else{if(W==13){V()}}}})};var t=function(N,O){serviceManager.getFile(ASC.Files.TemplateManager.events.GetFile,{id:N,showVer:false,show:O,setThumbnailURLBool:(ASC.Files.UI.viewFolder=="g")})};var c=function(){ASC.Files.Folders.bulkStatuses=false;jq("#files_tasks .progress").css("width","0%");jq("#files_tasks .percent").text("0%").css("color","#1A6DB3");jq("#files_tasks .headerBaseMedium").html("");jq("#files_tasks").hide()};var L=function(){clearTimeout(ASC.Files.Folders.tasksTimeout);serviceManager.terminateTasks(ASC.Files.TemplateManager.events.TerminateTasks,{})};var A=function(){clearTimeout(ASC.Files.Folders.tasksTimeout);ASC.Files.Folders.tasksTimeout=setTimeout(function(){serviceManager.getTasksStatuses(ASC.Files.TemplateManager.events.GetTasksStatuses,{})},2000)};var w=function(O,N){var Q=jq("#file_version_"+N).val()||"";var P=ASC.Files.Utils.fileViewUrl(N,Q);if(ASC.Files.Utils.itIsDocument(O)){P=ASC.Files.Utils.getPreviewUrl(O,N)}P=ASC.Files.Common.getSitePath()+P;ASC.Files.Common.blockUI(jq("#files_get_link"),0,200);jq("#files_getlink_link").val(encodeURI(P)).select();if(ASC.Controls.Constants.isMobileAgent){jq("#files_getlink_actions").remove()}else{ASC.Files.Folders.clip=new ZeroClipboard.Client();ASC.Files.Folders.clip.setText(P);ASC.Files.Folders.clip.glue("files_getlink_actions","files_getlink_actions",{zIndex:670,left:jq("#files_getlink_actions").offset().left-jq("#files_get_link").offset().left+"px",top:jq("#files_getlink_actions").offset().top-jq("#files_get_link").offset().top+"px"});ASC.Files.Folders.clip.addEventListener("onComplete",function(R,S){jq("#files_getlink_link").yellowFade()});PopupKeyUpActionProvider.CloseDialogAction="ASC.Files.Folders.clip.destroy();"}};return{eventAfter:p,currentFolderId:l,moveToFolder:D,curItemMoveTo:k,multiMoveTo:E,isCopyTo:B,createFolder:h,getFolderInfo:u,getFile:t,replaceVersion:H,showVersions:J,makeCurrentVersion:C,closeVersions:g,getOrderByDateAndTime:z,getOrderByAnchor:y,curItemFolderMoveTo:j,rename:G,deleteItem:m,emptyTrash:o,getFolderItems:v,folderContainer:r,clip:f,getLink:w,clickOnFolder:e,clickOnFile:d,showMore:I,pathParts:F,createNewDoc:i,typeNewDoc:M,download:n,getTasksStatuses:A,cancelTasksStatuses:c,terminateTasks:L,tasksTimeout:K,bulkStatuses:b}})(jQuery);(function(a){a(function(){jq(".files_navigation li:last a").addClass("files_navigation_last");ASC.Files.Folders.getTasksStatuses();jq("[id^='files_navigation_']").click(function(){var b=this.id.replace("files_navigation_","");ASC.Files.UI.navigationSet(b);return false});jq("#tree_selector_"+ASC.Files.Constants.FOLDER_ID_MY_FILES+",#tree_selector_"+ASC.Files.Constants.FOLDER_ID_COMMON_FILES+",#tree_selector_"+ASC.Files.Constants.FOLDER_ID_SHARE+",#tree_selector_"+ASC.Files.Constants.FOLDER_ID_CURRENT_ROOT).click(function(){var b=this.id.replace("tree_selector_","");ASC.Files.UI.navigationSet(b);return false});jq("#files_createfolder_btn").click(function(){ASC.Files.Folders.createFolder()});jq("#files_cancelUpload").click(function(){PopupKeyUpActionProvider.CloseDialog()});jq("#files_deleteButton").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.deleteItem()});jq("#files_emptyTrashButton").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.emptyTrash()});jq("#files_download_btn, #files_downloadButton").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.download()});jq("#files_gallery_btn").click(function(){ASC.Files.UI.switchViewFolder()});jq("#files_list_btn").click(function(){ASC.Files.UI.switchViewFolder()});jq("#files_sortPanel [id^='files_sort_']").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.UI.setOrderValue(this)});jq("#[id^='files_filter_value_'] a").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.UI.setFilterType(this);return false});jq("#files_clearFilter_btn, #files_clearFilterCont_btn").unbind("click").click(function(){jq("#files_filter_show_0 a").click();return false});jq("#files_selectAll_check").click(function(){ASC.Files.UI.checkSelectAll(jq("#files_selectAll_check").attr("checked"))});jq("#files_create_text, #files_create_spreadsheet, #files_create_presentation").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.typeNewDoc=this.id.replace("files_create_","");ASC.Files.Folders.createNewDoc()});jq("#files_getlink_link").bind("mousedown",function(){jq(this).select();return false});if(!ASC.Files.Constants.ENABLE_VERSIONS){jq("#files_versions_files, #files_uploads_files").remove()}if(ASC.Files.Share==undefined){jq("#files_share_btn,                #files_shareaccess_folders, #files_shareaccess_files,                #files_unsubscribe_files, #files_unsubscribe_folders").remove()}if(ASC.Controls.Constants.isMobileAgent){jq("#confirmRemoveList,                #files_overwrite_list,                #mainContentHeader_panel,                #files_filter_usersPanel,                #files_filter_departmensPanel").css({"max-height":"none"})}})})(jQuery);window.ASC.Files.Actions=(function(a){var f=false;var c=0;var e=function(){if(f===false){f=true;jq(document).click(function(q){ASC.Files.Common.dropdownRegisterAutoHide(q,"#files_showTreeView","#files_treeViewPanel");ASC.Files.Common.dropdownRegisterAutoHide(q,"#files_actions_open","#files_actionsPanel")})}};var p=function(r,q){if(ASC.Files.Folders.folderContainer==="my"){jq("#files_sort_Author").hide()}else{jq("#files_sort_Author").show()}jq("#files_sortPanel").show();o(r,q,"files_sort_open")};var l=function(r,q){if(ASC.Files.Folders.folderContainer==="my"){jq("#files_filter_show_1").hide();jq("#files_filter_show_2").hide()}else{jq("#files_filter_show_1").show();jq("#files_filter_show_2").show()}jq("#files_filterPanel").show();o(r,q,"files_filter_category")};var m=function(r,q){o(r,q,"files_filter_value");switch(c){case 1:jq("#files_filter_usersPanel").show();if(!ASC.Controls.Constants.isMobileAgent){if(jq("#files_filter_usersPanel").data("jsp")){jq("#files_filter_usersPanel").data("jsp").reinitialise()}else{jq("#files_filter_usersPanel").jScrollPane()}}break;case 2:jq("#files_filter_departmensPanel").show();if(!ASC.Controls.Constants.isMobileAgent){if(jq("#files_filter_departmensPanel").data("jsp")){jq("#files_filter_departmensPanel").data("jsp").reinitialise()}else{jq("#files_filter_departmensPanel").jScrollPane()}}break;case 3:jq("#files_filter_typesPanel").show();break;default:jq("#files_filter_value").hide();ASC.Files.UI.setFilterValue(0,"");return}};var h=function(r,q){jq("#mainContentHeader_panel a.select").removeClass("select");jq(r).addClass("select");jq("#files_filter_category span").html(jq(r).html());jq("#files_filter_value span").html(ASC.Files.Resources.SelectFilterValue);c=parseInt(jq(r).parent().attr("id").replace("files_filter_show_",""))||0;jq("#files_filter_value").show();jq("#files_filter_value").click()};var o=function(s,r,q){ASC.Files.Common.dropdownToggle(jq("#mainContentHeader"),"mainContentHeader_panel");jq("#"+q).addClass("select");jq("body").click(function(t){if(!jq((t.target)?t.target:t.srcElement).parents().andSelf().is("#mainContentHeader_panel, #"+s.id)){ASC.Files.Actions.hideAllActionPanels()}})};var j=function(t,s){jq("#files_deleteButton, #files_movetoButton, #files_copytoButton").hide();var q=jq("#files_mainContent div.fileRow:not(.checkloading):not(.newFolder):not(.newFile) input:checked").length;var r=q;jq("#files_mainContent div.fileRow:not(.checkloading):not(.newFolder):not(.newFile) input:checked").each(function(){if(jq("#file_editing_icn_"+this.id.replace("check_file_","")+":visible").length!=0||!ASC.Files.UI.accessAdmin(this.id.replace("check_",""))){r--}});if(q>0){jq("#files_downloadButton, #files_restoreButton, #files_copytoButton").show().find("span").html(q)}if(r>0){jq("#files_deleteButton, #files_movetoButton").show().find("span").html(r)}if(ASC.Files.Folders.folderContainer=="trash"){jq("#files_deleteButton, #files_movetoButton, #files_copytoButton").hide()}if(!ASC.Files.UI.accessAdmin()){jq("#files_deleteButton, #files_movetoButton").hide()}jq("#files_restoreButton, #files_emptyTrashButton").hide();if(ASC.Files.Folders.folderContainer=="trash"){if(q>0){jq("#files_downloadButton, #files_deleteButton, #files_restoreButton").show()}else{jq("#files_downloadButton").hide()}jq("#files_emptyTrashButton").show()}ASC.Files.Common.dropdownToggle(jq("#files_actions_open").parent().parent(),"files_actionsPanel")};var i=function(v,s,r){if(jq("#content_"+s.id.replace("combo_","")+".loading").length!=0){return}ASC.Files.UI.currentCombo=s.id;jq("#files_mainContent div.combobox").removeClass("combobox").addClass("no_combobox");jq("#"+ASC.Files.UI.currentCombo).parent().removeClass("no_combobox").addClass("combobox");ASC.Files.UI.checkSelectAll(false);ASC.Files.UI.selectRow(jq("#content_"+s.id.replace("combo_","")),true);jq("#files_actionPanel_folders, #files_actionPanel_files").hide();if(v=="folder"){var t=s.id.replace("combo_folder_","");jq("#files_open_folders,				#files_download_folders,				#files_shareAccess_folders,				#files_unsubscribe_folders,				#files_moveto_folders,				#files_copyto_folders,				#files_rename_folders,				#files_restore_folders,                #files_remove_folders").css("display","");jq("#files_open_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.UI.madeAnchor(t)});jq("#files_download_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.download(s.id)});jq("#files_moveto_folders, #files_restore_folders, #files_copyto_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Tree.showMoveToSelector(s.id,this.id=="files_copyto_folders");jq("#"+s.id).parent().removeClass("no_combobox").addClass("combobox")});jq("#files_rename_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.rename(s.id)});if(ASC.Files.Folders.folderContainer=="trash"){jq("#files_open_folders,                    #files_shareAccess_folders,                    #files_moveto_folders,                    #files_copyto_folders,                    #files_rename_folders").hide()}else{jq("#files_restore_folders").hide()}if(ASC.Files.Folders.folderContainer=="project"){jq("#files_shareAccess_folders").hide()}if(!ASC.Files.UI.accessibleItem("folder_"+t)){jq("#files_rename_folders").hide()}if(ASC.Files.UI.accessAdmin("folder_"+t)){if(jq("#files_share_btn:visible").length!=0){jq("#files_shareAccess_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Share.clickShareButton(s.id)})}else{jq("#files_shareAccess_folders").hide()}jq("#files_remove_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.deleteItem("folder_"+t)})}else{jq("#files_moveto_folders,                    #files_shareAccess_folders,                    #files_remove_folders").hide()}if(jq("#content_folder_"+t+" div.fileInfo").hasClass("markForMe")){jq("#files_unsubscribe_folders").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Share.unSubscribeMe("folder_"+t)})}else{jq("#files_unsubscribe_folders").hide()}jq("#files_actionPanel_folders").show()}else{var t=s.id.replace("combo_file_","");var u=jq("#content_file_"+t+" .fileName a.name").attr("title");jq("#files_open_files,                #files_edit_files,                #files_editOO_files,                #files_download_files,                #files_shareaccess_files,                #files_unsubscribe_files,                #files_getlink_files,                #files_uploads_files,                #files_versions_files,                #files_moveto_files,                #files_copyto_files,                #files_rename_files,				#files_restore_files,                #files_remove_files").css("display","");jq("#files_download_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.download(s.id)});if(ASC.Files.Folders.folderContainer=="corporate"||ASC.Files.Folders.folderContainer=="my"&&ASC.Files.UI.accessAdmin("file_"+t)&&jq("#share_icn_file_"+t+":visible").length!=0){jq("#files_getlink_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.getLink(u,t)})}else{jq("#files_getlink_files").hide()}jq("#files_moveto_files, #files_restore_files, #files_copyto_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Tree.showMoveToSelector(s.id,this.id=="files_copyto_files");jq("#"+s.id).parent().removeClass("no_combobox").addClass("combobox")});jq("#files_rename_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.rename(s.id)});jq("#files_remove_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.deleteItem("file_"+t)});if(ASC.Files.Utils.FileCanBePreview(u)){jq("#files_open_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.clickOnFile(t);return false})}else{jq("#files_open_files").hide()}var q=jq("#file_version_"+t).val();if(ASC.Files.UI.viewFolder=="g"||q<2||ASC.Files.Folders.folderContainer=="trash"||jq("#content_file_"+t+" #content_versions").length!=0){jq("#files_versions_files").hide()}else{jq("#files_versions_files span").html(q);jq("#files_versions_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Folders.showVersions(s.id)})}if(ASC.Files.UI.viewFolder=="g"){jq("#files_uploads_files").hide()}else{jq("#files_uploads_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Uploads.showUploadNewVersion(t)})}if(jq("#file_editing_icn_"+t+":visible").length!=0){jq("#files_edit_files,                    #files_editOO_files,                    #files_uploads_files,                    #files_versions_files,                    #files_moveto_files,                    #files_rename_files,                    #files_remove_files").hide()}else{if(ASC.Files.UI.editableFile("content_file_"+t,true)&&!ASC.Files.UI.editingFile("content_file_"+t)){jq("#files_edit_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();PopupKeyUpActionProvider.CloseDialog();ASC.Files.Actions.checkEditFile(t,u,true)})}else{jq("#files_edit_files").hide()}if(ASC.Files.UI.editableFile("content_file_"+t,false)&&!ASC.Files.UI.editingFile("content_file_"+t)){jq("#files_editOO_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();PopupKeyUpActionProvider.CloseDialog();ASC.Files.Actions.checkEditFile(t,u,false)})}else{jq("#files_editOO_files").hide()}}if(ASC.Files.Folders.folderContainer=="trash"){jq("#files_open_files,                    #files_edit_files,                    #files_editOO_files,                    #files_shareaccess_files,                    #files_getlink_files,                    #files_uploads_files,                    #files_versions_files,                    #files_moveto_files,                    #files_copyto_files,                    #files_rename_files").hide();jq("#files_remove_files,#files_restore_files").css("display","")}else{jq("#files_restore_files").hide()}if(ASC.Files.Folders.folderContainer=="project"){jq("#files_shareaccess_files").hide()}if(!ASC.Files.UI.accessibleItem("file_"+t)){jq("#files_edit_files,                    #files_editOO_files,                    #files_uploads_files,                    #files_rename_files").hide()}if(ASC.Files.UI.accessAdmin("file_"+t)){if(jq("#files_share_btn:visible").length!=0){jq("#files_shareaccess_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Share.clickShareButton(s.id)})}else{jq("#files_shareaccess_files").hide()}}else{jq("#files_moveto_files,                    #files_shareaccess_files,                    #files_remove_files").hide()}if(jq("#content_file_"+t+" div.fileInfo").hasClass("markForMe")||(ASC.Files.Folders.currentContainer=="corporate"&&ASC.Files.Constants.USER_ADMIN!=true)){jq("#files_unsubscribe_files").unbind("click").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Share.unSubscribeMe("file_"+t)})}else{jq("#files_unsubscribe_files").hide()}jq("#files_actionPanel_files").show()}ASC.Files.Common.dropdownToggle(jq(s).parent().parent(),"files_actionPanel");jq("body").click(function(w){if(ASC.Files.UI.currentCombo==""){return}if(!jq((w.target)?w.target:w.srcElement).parents().andSelf().is("#files_actionPanel, div[id*='combo_folder_'], div[id*='combo_file_'], div.sub-folder, div.name a.name")){ASC.Files.UI.currentCombo="";ASC.Files.Actions.hideAllActionPanels()}})};var g=function(r,q){var s=false;if(typeof q!="undefined"){if(jq(q.srcElement||q.target).is('[id="files_prompt_rename"]')){s=true}}s=s||jq("#content_"+r).hasClass("newFolder")||jq("#content_"+r).hasClass("rowRename");if(!s){jq("#combo_"+r).click()}return s};var n=function(r,q){i("folder",r,q)};var k=function(r,q){i("file",r,q)};var d=function(){jq("div.files_popup_win").hide();jq("#mainContentHeader .select").removeClass("select");jq("body").unbind("click");ASC.Files.Folders.curItemMoveTo="";ASC.Files.UI.currentCombo="";jq("#files_mainContent div.combobox").removeClass("combobox").addClass("no_combobox")};var b=function(q,s,u,r){if(u==true){jq("#file_editing_icn_"+q).show();jq("#file_IsEditing_"+q).val("true");jq("#content_file_"+q+" div.fileEdit").hide();jq("#content_file_"+q+" div.fileEditing").show();r=(r===true);if(!r&&jq("#content_file_"+q).hasClass("isNewForWebEditor")){r=true;jq("#content_file_"+q).removeClass("isNewForWebEditor")}var t=ASC.Files.Utils.getWebEditUrl(s,q)+(r?"&new=true":"");var v=window.open(t,"_blank");v.onload=function(){if(q){jq("#file_editing_icn_"+q).show();jq("#file_IsEditing_"+q).val("true");jq("#content_file_"+q+" div.fileEdit").hide();jq("#content_file_"+q+" div.fileEditing").show()}};v.onunload=function(){if(q){jq("#file_editing_icn_"+q).hide();jq("#file_IsEditing_"+q).val("false");jq("#content_file_"+q+" div.fileEdit").show();jq("#content_file_"+q+" div.fileEditing").hide();ASC.Files.Folders.replaceVersion(q,false,true)}}}else{if(!ASC.Files.Constants.PLUGIN_ENABLE){return false}switch(ASC.Files.Plugin.GetOpenOfficeState()){case ASC.Files.Plugin.OPEN_OFFICE_STATE_NOT_INSTALLED:jq("#plugin_informer").slideDown();jq(document).scrollTo(0);break;case ASC.Files.Plugin.OPEN_OFFICE_STATE_INSTALLING:break;case ASC.Files.Plugin.OPEN_OFFICE_STATE_INSTALLED:jq("#content_file_"+q+" div.fileEdit").hide();jq("#content_file_"+q+" div.fileEditing").show();serviceManager.checkEditFile(ASC.Files.TemplateManager.events.CheckEditFile,{fileID:q,title:s});break}}};return{init:e,showFilterTypePanel:l,showFilterValuePanel:m,showSortViewPanel:p,showActionsViewPanel:j,showFolderActions:n,showFileActions:k,setFilterCategory:h,onContextMenu:g,checkEditFile:b,hideAllActionPanels:d}})(jQuery);(function(a){ASC.Files.Actions.init();a(function(){jq("#files_actions_open").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Actions.showActionsViewPanel()});jq("#files_filter_category").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Actions.showFilterTypePanel(this)});jq("#files_filter_value").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Actions.showFilterValuePanel(this)});jq("[id^='files_filter_show_'] a").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Actions.setFilterCategory(this)});jq("#files_sort_open").click(function(){ASC.Files.Actions.hideAllActionPanels();ASC.Files.Actions.showSortViewPanel(this)});jq(document).mousedown(function(b){var c=(ASC.Files.UI.beginSelecting(b)==true);ASC.Files.UI.mouseBtn=true;return c});jq(document).mouseup(function(b){ASC.Files.UI.mouseBtn=false});jq(document).mousemove(function(b){if(ASC.Files.UI.mouseBtn==false){ASC.Files.UI.handleMove(b)}return true})})})(jQuery);window.ASC.Files.Tree=(function(a){var j=false;var n="files_trewViewContainer";var o="files_trewViewSelector";var f=function(){if(j===false){j=true;serviceManager.bind(ASC.Files.TemplateManager.events.GetTreeSubFolders,l)}};var u=function(){ASC.Files.Tree.showTreePath();ASC.Files.Common.dropdownToggle(jq("#files_showTreeView"),"files_treeViewPanel")};var r=function(x,v){if(ASC.Files.Import){ASC.Files.Import.isImport=false}ASC.Files.Folders.isCopyTo=(v===true);ASC.Files.Tree.showTreePath();ASC.Files.Tree.showSelect("stree_selector_"+ASC.Files.Folders.currentFolderId);ASC.Files.Actions.hideAllActionPanels();if(x==-1){var w=jq("#files_mainContent input:checked");if(w.length==0){return undefined}ASC.Files.Folders.multiMoveTo=true;ASC.Files.Common.dropdownToggle(jq("#files_actions_open").parent().parent(),"files_treeViewPanelSelector")}else{ASC.Files.Folders.curItemMoveTo=x;ASC.Files.Folders.multiMoveTo=false;ASC.Files.Common.dropdownToggle(jq(jq("#"+x)[0]).parent().parent(),"files_treeViewPanelSelector")}jq("body").click(function(y){if(!jq((y.target)?y.target:y.srcElement).parents().andSelf().is("#files_treeViewPanelSelector, #files_moveto_folders, #files_moveto_files, #files_copyto_folders, #files_copyto_files,                 #files_restore_folders, #files_restore_files, #files_movetoButton, #files_copytoButton, #files_restoreButton")){ASC.Files.Actions.hideAllActionPanels()}})};var t=function(){var v=ASC.Files.Folders.pathParts;if(v==null||v==undefined){return}if(jq("#tree_node_"+v[0].Key).length!=0){for(i=0;i<v.length;i++){var w=v[i].Key;if(jq("#tree_node_"+w+" ul").html()==null||jq("#tree_node_"+w+" ul").html()==""){ASC.Files.Tree.getTreeSubFolders(w)}else{jq(jq("#tree_node_"+w+" ins")[0]).parent().addClass("jstree-open").removeClass("jstree-closed");jq(jq("#stree_node_"+w+" ins")[0]).parent().addClass("jstree-open").removeClass("jstree-closed")}}}ASC.Files.Tree.select("#tree_selector_"+ASC.Files.Folders.currentFolderId);ASC.Files.Tree.showSelect("stree_selector_"+ASC.Files.Folders.currentFolderId)};var m=function(w,x,y){var y=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFoldersTree);if(typeof y==="undefined"){return undefined}var v=ASC.Controls.XSLTManager.translate(x,y);jq("#tree_node_"+w).addClass("jstree-open").removeClass("jstree-closed");jq("#stree_node_"+w).addClass("jstree-open").removeClass("jstree-closed");if(v!=""){jq("#tree_node_"+w).append("<ul>"+v+"</ul>");jq("#stree_node_"+w).append("<ul>"+v.replace(/tree_/g,"stree_")+"</ul>")}};var k=function(v,w){if(jq("#tree_node_"+w).children().length==3){jq(jq("#tree_node_"+w).children()[2]).append(jq("#tree_node_"+v))}else{jq("#tree_node_"+v).remove()}if(jq("#stree_node_"+w).children().length==3){jq(jq("#stree_node_"+w).children()[2]).append(jq("#stree_node_"+v))}else{jq("#stree_node_"+v).remove()}};var p=function(v){jq("#"+n+" a").removeClass("selected");jq("#"+o+" a").removeClass("selected");jq(v).addClass("selected");if(v.id!=undefined){jq("#files_trewViewContainer li.jstree-closed").each(function(){if(jq("#"+v.id.replace("tree_selector","tree_node"),this).html()!=null){jq(this).addClass("jstree-open").removeClass("jstree-closed")}})}};var s=function(v){jq("#"+v).addClass("selected");if(v!=undefined){jq("#files_trewViewSelector li.jstree-closed").each(function(){if(jq("#"+v.replace("stree_selector","stree_node"),this).html()!=null){jq(this).addClass("jstree-open").removeClass("jstree-closed")}})}};var q=function(w){var v=w.id.replace("stree_selector_","");if(ASC.Files.Import!=undefined&&ASC.Files.Import.isImport==true){ASC.Files.Import.setFolderImportTo(v,jq(w).text())}else{var x=jq("#stree_selector_"+v).html();x=x.split("</ins>")[1]||x.split("</INS>")[1];ASC.Files.Folders.curItemFolderMoveTo(v,x)}};var d=function(w){var x=jq(w).parent();if(x.children().length==3){x.toggleClass("jstree-closed").toggleClass("jstree-open")}else{var v=jq(x.children()[1]).attr("id").replace(/(s*)tree_selector_/,"");ASC.Files.Tree.getTreeSubFolders(v)}};var g=function(v){if(v==null||v==undefined||v==""){return}jq("#"+v+" ins[rel='expander']").each(function(){jq(this).unbind("click").click(function(){ASC.Files.Tree.expand(this);return false})});jq("#"+v+" a").each(function(){jq(this).unbind("click").click(function(){ASC.Files.Tree.select(this);return false})})};var b=function(v){if(v==null||v==undefined||v==""){return}jq("#"+v+" ul ins[rel='expander']").each(function(){jq(this).unbind("click").click(function(){ASC.Files.Tree.expand(this);return false})});jq("#"+v+" ul a").each(function(){jq(this).unbind("click").click(function(){ASC.Files.Tree.select(this);return false})});jq(jq("#"+v).children()).show()};var h=function(v){if(v==null||v==undefined||v==""){return}jq("#"+v+" ins[rel='expander']").each(function(){jq(this).unbind("click").click(function(){ASC.Files.Tree.expand(this)})});jq("#"+v+" a").each(function(){if(ASC.Files.UI.accessibleItem(this.id.replace("stree_selector","folder"))){jq(this).removeAttr("onclick").unbind("click").click(function(){ASC.Files.Tree.selectS(this);return false})}else{jq(this).removeAttr("onclick").unbind("click").click(function(){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.ErrorMassage_SecurityException,true);ASC.Files.Tree.expand(this);return false})}})};var c=function(v){if(v==null||v==undefined||v==""){return}jq("#"+v+" ul ins[rel='expander']").each(function(){jq(this).unbind("click").click(function(){ASC.Files.Tree.expand(this);return false})});jq("#"+v+" ul a").each(function(){jq(this).removeAttr("onclick").unbind("click").click(function(){ASC.Files.Tree.selectS(this);return false})});jq(jq("#"+v).children()).show()};var e=function(v){jq("#tree_node_"+v+" ins[rel='expander'], #stree_node_"+v+" ins[rel='expander']").addClass("jstreeLoadNode");serviceManager.request("post","xml",ASC.Files.TemplateManager.events.GetTreeSubFolders,{id:v},{orderBy:ASC.Files.Folders.getOrderByDateAndTime(false)},"folders",v,"subfolders?from=0&count=0")};var l=function(z,y,w,v){jq("#tree_node_"+y.id+" ins[rel='expander'],#stree_node_"+y.id+" ins[rel='expander']").removeClass("jstreeLoadNode");if(typeof w!="undefined"){ASC.Files.UI.displayInfoPanel(v||w,true);return undefined}var x=y.id;if(jq("#tree_node_"+x+" ul").html()==null||jq("#tree_node_"+x+" ul").html()==""){m(x,z);ASC.Files.Tree.attachEvents("tree_node_"+x);ASC.Files.Tree.attachSEvents("stree_node_"+x)}ASC.Files.Tree.select("#tree_selector_"+ASC.Files.Folders.currentFolderId);ASC.Files.Tree.showSelect("stree_selector_"+ASC.Files.Folders.currentFolderId)};return{init:f,select:p,selectS:q,expand:d,initEvents:g,initSEvents:h,attachSEvents:c,attachEvents:b,moveNode:k,showSelect:s,showTreeViewPanel:u,showMoveToSelector:r,showTreePath:t,getTreeSubFolders:e}})(jQuery);(function(a){ASC.Files.Tree.init();a(function(){ASC.Files.Tree.initEvents("files_trewViewContainer");ASC.Files.Tree.initSEvents("files_trewViewSelector");jq("#files_showTreeView").click(function(){ASC.Files.Tree.showTreeViewPanel()});jq("#files_movetoButton, #files_copytoButton, #files_restoreButton").click(function(){ASC.Files.Tree.showMoveToSelector(-1,(this.id=="files_copytoButton"))});if(ASC.Controls.Constants.isMobileAgent){jq("div.files_treeViewPanel, div.jstree").css({"max-width":"none","max-height":"none"})}if(jq("#files_treeViewPanelSelector").length==0){jq("#files_copyto_folders, #files_copyto_files, #files_copytoButton").remove()}})})(jQuery);window.ASC.Files.DragDrop=(function(a){var l=false;var t=0;var f=0;var s=0;var d=true;var h=new Array();var j=function(){if(l===false){l=true;if(c()&&k()){jq("div.drag_drop_image, #empty_move_message").show();jq("#files_mainContent, #emptyScreen").bind("dragover",function(v){return ASC.Files.DragDrop.over(v)}).bind("dragenter",function(){return false}).bind("dragleave",function(v){return ASC.Files.DragDrop.leave(v)}).bind("drop",function(v){return ASC.Files.DragDrop.drop(v)});b()}else{jq("div.drag_drop_image, #empty_move_message").remove()}}};var c=function(){return"draggable" in document.createElement("span")&&typeof(new XMLHttpRequest()).upload!="undefined"};var k=function(){return typeof FileReader!="undefined"&&typeof(new XMLHttpRequest()).upload!="undefined"};var p=function(w){var v=w.originalEvent.dataTransfer;if(!v){return}if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){return}if(v.types.contains&&!v.types.contains("Files")){return}if(v.types.indexOf&&v.types.indexOf("Files")==-1){return}if(jq.browser.webkit){v.dropEffect="copy"}jq("#files_mainContent, #emptyScreen").addClass("selected");return false};var m=function(v){return i()};var g=function(x){var w=x.originalEvent.dataTransfer;if(!w&&!w.files){return}if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){return}i();var v=w.files;var y=new Array(0);for(var z=0;z<v.length;z++){if(e(v[z])){y.push(v[z])}}ASC.Files.DragDrop.totalDD=ASC.Files.DragDrop.totalDD+y.length;if(y.length!=0){for(var z=0;z<y.length;z++){ASC.Files.DragDrop.uploadFile({file:y[z],folder:ASC.Files.Folders.currentFolderId})}}return false};var i=function(){jq("#files_mainContent, #emptyScreen").removeClass("selected");return false};var e=function(v){var w=ASC.Files.Utils.getFileExts(v.name||v.fileName);if((v.name||v.fileName).length-w>20){return false}if((v.size||v.fileSize)<=0){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.ErrorMassage_EmptyFile,true);return false}if(!ASC.Files.Utils.FileCanBeUpload(v.name||v.fileName)){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.ErrorMassage_FileTypeText,true);return false}if(ASC.Files.Constants.MAX_UPLOAD_KB<(v.size||v.fileSize)/1024){ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.ErrorMassage_LimitFileSize,ASC.Files.Constants.MAX_UPLOAD_KB/1024),true);return false}return true};var b=function(){jq(document).bind("dragenter",function(){return false}).bind("dragleave",function(){return false}).bind("dragover",function(w){var v=w.originalEvent.dataTransfer;if(!v){return}v.dropEffect="none";return false}.bind(this))};var u=function(v){if(h.length==0&&d==true){d=false;q(v)}else{h.push(v)}};var r=function(){var v=h.shift();d=false;q(v)};var q=function(x){var w=x.file;var z=x.folder;try{var y=ASC.Files.Utils.replaceSpecCharacter(w.name||w.fileName);if(jq("#drag_drop_process").length==0){jq("#files_progress_template").clone().attr("id","drag_drop_process").appendTo("#files_bottom_loader")}jq("#drag_drop_process .progress").css("width","0%");jq("#drag_drop_process .percent").text("0%").css("color","#1A6DB3");jq("#drag_drop_process .headerBaseMedium").html(ASC.Files.Resources.FileUploading+" "+y);jq("#drag_drop_process").show();var B=new XMLHttpRequest();B.upload.addEventListener("progress",function(C){ASC.Files.DragDrop.onProgressDD(C)},false);B.onprogress=function(C){ASC.Files.DragDrop.onProgressDD(C)}.bind(this);B.onload=function(C){n(C)}.bind(this);var A=ASC.Files.Common.getSitePath();A+=jq.format(ASC.Files.Constants.URL_HANDLER_UPLOAD,z,encodeURIComponent(y));B.open("POST",A,true);B.send(w)}catch(v){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.ErrorMassage_DnDError,true);n()}return false};var n=function(v){d=true;ASC.Files.DragDrop.countDD++;if(v!=undefined){var z=v.target.responseText.split("|");var x=z[0];if(x!=undefined&&parseInt(x)>0){ASC.Files.DragDrop.successDD++;var w=z[1];if(w==ASC.Files.Folders.currentFolderId){if(jq("#content_file_"+x).html()!=null&&jq("#content_file_"+x).html()!=""){ASC.Files.Folders.replaceVersion(x,false,false)}else{ASC.Files.Folders.getFile(x,false)}}}else{var A=z[0].split("title>")[1].split("</")[0];if(A&&A.length>0){ASC.Files.UI.displayInfoPanel(A,true)}}}jq("#drag_drop_process .progress").css("width","100%");jq("#drag_drop_process .percent").text("100%").css("color","white");jq("#drag_drop_process .textSmallDescribe").text(jq.format(ASC.Files.Resources.ProcessUploadCountFiles,ASC.Files.DragDrop.countDD,ASC.Files.DragDrop.totalDD));if(ASC.Files.DragDrop.successDD>0){ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoUploadedSuccess,ASC.Files.DragDrop.successDD))}var y=jq("div.newFile");if(y.length!=0){ASC.Files.UI.hideEmpty();y.each(function(){ASC.Files.UI.addRowHandlers(this.id)})}y.removeClass("newFile").show().yellowFade();if(h.length==0){ASC.Files.DragDrop.totalDD=0;ASC.Files.DragDrop.countDD=0;ASC.Files.DragDrop.successDD=0;setTimeout("jq('#drag_drop_process').hide();",800)}else{if(d==true){setTimeout("ASC.Files.DragDrop.startUploadWithDelay()",100)}}};var o=function(v){var w=Math.min(Math.round(v.loaded*100/v.total),100);jq("#drag_drop_process .progress").css("width",w+"%");jq("#drag_drop_process .percent").text(w+"%").css("color",w>45?"white":"#1A6DB3");jq("#drag_drop_process .textSmallDescribe").text(jq.format(ASC.Files.Resources.ProcessUploadCountFiles,ASC.Files.DragDrop.countDD,ASC.Files.DragDrop.totalDD))};return{init:j,canDragDrop:c,isFileAPI:k,leave:m,over:p,drop:g,totalDD:t,countDD:f,successDD:s,uploadFile:u,startUploadWithDelay:r,onProgressDD:o}})(jQuery);(function(a){a(function(){ASC.Files.DragDrop.init()})})(jQuery);Array.prototype.remove=function(a,c){var b=this.slice((c||a)+1||this.length);this.length=a<0?this.length+a:a;return this.push.apply(this,b)};window.ASC.Files.Plugin=(function(a){var o=false;var g=-1;var d=false;var c=null;var b=0;var s=0;var r=1;var q=2;var J=1;var K=2;var L=3;var I=4;var O=5;var H=6;var G=7;var E=8;var M=9;var N=10;var P=11;var F=13;var t=1;var u=2;var w=3;var v=4;var A=1;var y=2;var z=3;var x=4;var B=0;var D=1;var C=2;var j=function(){return b};var S=function(U){b=U};var k=function(){if(navigator.appVersion.indexOf("Win")==-1||jq.browser.safari||jq.browser.opera){return}jq(document).unload(function(){jq("id=^virtObj_").each(function(){if(this.Status!=K){return}jq(this).remove()})});ASC.Files.UI.displayLoading(null,true);jq("#install_completed span").text(ASC.Files.Resources.InstallOpenOfficeCongratulation);jq("#install_process").show();jq("#install_completed").hide();var U=jq("#slider div.slider-item");U.hide();jq(U[0]).show();jq("#slider ul a").click(function(){R(jq(this).attr("rel"))});jq("#plugin_informer").click(function(V){var Y=jq(V.target).parent().parent().hasClass("plugin_informer_info");var W=jq(V.target).hasClass("btn_close");var X=jq(V.target).hasClass("btn_install");if(!(Y||W||X)){jq("#plugin_informer span.btn_install").click()}});jq("#plugin_informer").insertAfter(jq("div.studioTopNavigationPanel"));jq("#plugin_informer div.btn_close").click(function(){jq("#plugin_informer").slideUp()});if(!e()){ASC.Files.UI.hideLoading(true);l(ASC.Files.Resources.InstallPluginHeader,ASC.Files.Resources.InstallPluginDescription.format("<span>","</span>"),ASC.Files.Resources.InstallPluginButton,i,false);b=s;return}h()};var e=function(){if(jq("#virtObj_").length==0){f("",true)}var V=document.getElementById("virtObj_");var U=V!=null&&V.Status!=null;jq("#virtObj_").remove();return U};var Q=function(Y,V){var W=f(V,true);ASC.Files.UI.displayLoading(null,true);W.Init(ASC.Files.Constants.OOO_ID,4|8|16,ASC.Files.Common.getSitePath()+serviceManager.getDocPath(),Y);setTimeout("ASC.Files.Plugin.OnMonitorPluginStatus('"+V+"')",250);try{var X=_gat._getTracker("UA-12442749-4");if(X!=null){X._trackPageview("start_open_office")}}catch(U){}jq.ajax({async:true,type:"get",url:jq.format(ASC.Files.Constants.URL_HANDLER_TRACK,2)})};var f=function(U,V){var W=navigator.userAgent.toLowerCase();if(W.indexOf("msie")!=-1&&W.indexOf("opera")==-1){jq("#virtObj_"+U).remove();jq("#objectDiv").append('<object id="virtObj_'+U+'" style="width:0;height:0;" classid="clsid:'+ASC.Files.Constants.PLUGIN_ID+'"></object>')}if((W.indexOf("opera")!=-1)||(W.indexOf("gecko")!=-1)){if(V){navigator.plugins.refresh(false)}if(navigator.mimeTypes&&navigator.mimeTypes["application/x-vnd-asc-virtualization"]){jq("#virtObj_"+U).remove();jq("#objectDiv").append('<object id="virtObj_'+U+'" style="width:0;height:0;" type="application/x-vnd-asc-virtualization"></object>')}}return jq("#virtObj_"+U)[0]};var i=function(){window.open(ASC.Files.Constants.URL_PLUGIN_PATH,"_blank");var U=setInterval(function(){if(!e()){return}m();clearInterval(U);try{var W=_gat._getTracker("UA-12442749-4");if(W!=null){W._trackPageview("install_plugin")}}catch(V){}jq.ajax({async:true,type:"get",url:jq.format(ASC.Files.Constants.URL_HANDLER_TRACK,1)})},2000)};var n=function(U){return U==""};var p=function(V){try{var W=document.getElementById("virtObj_"+V);var Y=W.Status;switch(Y){case J:switch(W.Error){case D:break;case C:l(ASC.Files.Resources.InstallPluginHeader,ASC.Files.Resources.InstallPluginDescription.format("<span>","</span>"),ASC.Files.Resources.InstallPluginButton,ASC.Files.Plugin.DownloadPlugin,true);jq("#plugin_informer").slideDown();b=s;return;break}break;case K:jq(W).remove();jq("#file_editing_icn_"+V).hide();jq("#file_IsEditing_"+V).val("false");return;break;case L:break;case P:var X=W.Progress;b=r;jq("#install_process div.files_progress_box span.headerBaseMedium").text(ASC.Files.Resources.OpenOfficeUnpacking);jq("#install_process div.files_progress_box span.textSmallDescribe").html("&nbsp;");jq("#install_process div.files_progress_box div.progress").css("width",X+"%");jq("#install_process div.files_progress_box span.percent").text(X+"%").css("color",X>45?"white":"#1A6DB3");if(X>95){clearInterval(c);b=q;jq("#install_process").hide();jq("#install_completed").show();return}break;case I:var X=W.Progress;if(X==0){break}b=r;jq("#install_process div.files_progress_box span.textSmallDescribe").text(jq.format(ASC.Files.Resources.OpenOfficeDownloadingInfo,158*X/100,158));jq("#install_process div.files_progress_box div.progress").css("width",X+"%");jq("#install_process div.files_progress_box span.percent").text(X+"%").css("color",X>45?"white":"#1A6DB3");break;case O:break;case H:ASC.Files.UI.hideLoading(true);break;case G:break;case E:break;case M:break;case N:break;case F:if(!n(V)){W.SetDecision(A);break}ASC.Files.UI.hideLoading(true);switch(W.AppState){case t:if(d){T();W.SetDecision(z);break}b=s;l(ASC.Files.Resources.InstallOpenOfficeHeader,"<span>"+ASC.Files.Resources.InstallOpenOfficeDescription+"</span>",ASC.Files.Resources.InstallOpenOfficeButton,ASC.Files.Plugin.InstallOpenOfficeApp,false);jq("#plugin_informer").slideDown();W.SetDecision(x);return;break;case w:case u:b=q;W.SetDecision(x);return;case v:b=q;if(d){T();W.SetDecision(z);break}l(ASC.Files.Resources.UpdateOpenOfficeHeader,"<span>"+ASC.Files.Resources.InstallOpenOfficeDescription+"</span>",ASC.Files.Resources.InstallOpenOfficeButton,ASC.Files.Plugin.InstallOpenOfficeApp,true);jq("#plugin_informer").slideDown();W.SetDecision(x);return;break}break}setTimeout("ASC.Files.Plugin.OnMonitorPluginStatus('"+V+"')",250)}catch(U){ASC.Files.UI.displayInfoPanel("OnProgress Error: "+U.number,true)}};var T=function(){jq("#install_process div.files_progress_box span.headerBaseMedium").text(ASC.Files.Resources.OpenOfficeDownloading);jq("#install_process div.files_progress_box span.textSmallDescribe").text(jq.format(ASC.Files.Resources.OpenOfficeDownloadingInfo,158*0/100,158));jq("#install_process div.files_progress_box div.progress").css("width",0+"%");jq("#install_process div.files_progress_box span.percent").text(0+"%").css("color","#1A6DB3");c=setInterval(function(){var U=(parseInt(jq("#slider ul a.slider-active").attr("rel"))||0)+1;if(U>5){U=0}R(U)},4000);ASC.Files.Common.blockUI(jq("#install_plugin_box"),500,385)};var m=function(){d=true;ASC.Files.UI.displayLoading(null,true);if(jq("#virtObj_").length==0){f("",true)}var U=document.getElementById("virtObj_");b=r;jq("#plugin_informer").slideUp();U.Init(ASC.Files.Constants.OOO_ID,4|8|16,"","");setTimeout("ASC.Files.Plugin.OnMonitorPluginStatus('')",250)};var h=function(){if(jq("#virtObj_").length==0){f("",true)}var U=document.getElementById("virtObj_");U.Init(ASC.Files.Constants.OOO_ID,4|8|16,"","");setTimeout("ASC.Files.Plugin.OnMonitorPluginStatus('')",250)};var R=function(U){var V=jq("#slider ul a.slider-active");jq("#slider div.slider-item:eq("+V.attr("rel")+")").hide();V.removeClass("slider-active");jq("#slider ul a:eq("+U+")").addClass("slider-active");jq("#slider div.slider-item:eq("+U+")").show()};var l=function(Y,X,W,U,V){jq("#plugin_informer span.btn_install").unbind("click");jq("#plugin_informer span.btn_install").click(function(){U();return false});jq("#plugin_informer span.headerBase").html(Y);jq("#plugin_informer p").html(X);jq("#plugin_informer span.btn_install").text(W);jq("#plugin_informer span.btn_install").attr("title",W);jq("#plugin_informer div.plugin_informer_info p span").click(function(){ASC.Files.Common.blockUI(jq("#how_it_works_box"),900,385)});if(V){jq("#install_process div.files_progress_box").hide()}};return{Init:k,RunOpenOfficeApp:Q,OnMonitorPluginStatus:p,InstallOpenOfficeApp:m,CheckPluginInstalled:e,GetOpenOfficeState:j,OPEN_OFFICE_STATE_NOT_INSTALLED:s,OPEN_OFFICE_STATE_INSTALLING:r,OPEN_OFFICE_STATE_INSTALLED:q,SelectedSlide:R}})(jQuery);(function(a){a(function(){ASC.Files.Plugin.Init()})})(jQuery);window.ASC.Files.MainMenu=(function(a){var c=false;var b=function(){if(c===false){c=true;jq(document).click(function(f){ASC.Files.Common.dropdownRegisterAutoHide(f,"#files_newdoc_btn","#files_newDocumentPanel")})}};var e=function(){var g=jq("#mainMenuHolderSpacer");var f=jq("#mainMenuHolder");var h=jq("#files_newdoc_btn img");var i=32;if(g.css("display")=="none"){i+=f.offset().top}else{i+=g.offset().top}if(jq(window).scrollTop()>i){g.show();f.addClass("fixed");if(h.length!=0){jq("#files_newDocumentPanel").css({position:"fixed",top:h.offset().top+h.outerHeight()-jq(window).scrollTop()})}if(ASC.Controls.Constants.isMobileAgent){f.css("top",jq(document).scrollTop()+"px")}}else{g.hide();f.removeClass("fixed");if(h.length!=0){jq("#files_newDocumentPanel").css({position:"absolute",top:h.offset().top+h.outerHeight()})}}};var d=function(){var f="";f+=ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.text)?"":"#files_create_text,";f+=ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.spreadsheet)?"":"#files_create_spreadsheet,";f+=ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.presentation)?"":"#files_create_presentation,";if(f.length!=0){switch(ASC.Files.Plugin.GetOpenOfficeState()){case ASC.Files.Plugin.OPEN_OFFICE_STATE_NOT_INSTALLED:case ASC.Files.Plugin.OPEN_OFFICE_STATE_INSTALLING:jq(f).css({opacity:0.5,"background-color":"#FFFFFF"});break;case ASC.Files.Plugin.OPEN_OFFICE_STATE_INSTALLED:jq(f).css({opacity:1,"background-color":""});break}}ASC.Files.Common.dropdownToggle(jq("#files_newdoc_btn img"),"files_newDocumentPanel")};return{init:b,showCreateNewDoc:d,toggleMainMenu:e}})(jQuery);(function(a){ASC.Files.MainMenu.init();a(function(){jq("#mainMenuHolderSpacer").css({height:jq("ul#mainMenuHolder").outerHeight()});jq("#files_newdoc_btn").click(function(b){ASC.Files.MainMenu.showCreateNewDoc()});if(navigator.appVersion.indexOf("Win")==-1||jq.browser.safari||jq.browser.opera||!ASC.Files.Constants.PLUGIN_ENABLE){if(!ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.text)){jq("#files_create_text").remove()}if(!ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.spreadsheet)){jq("#files_create_spreadsheet").remove()}if(!ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.presentation)){jq("#files_create_presentation").remove()}if(jq("#files_newDocumentPanel ul li").length==0){jq("#files_newDocumentPanel").remove();jq("#files_newdoc_btn").parents("li").remove()}}jq(window).scroll(function(){ASC.Files.MainMenu.toggleMainMenu();return true});jq(".comming_soon").unbind("click").click(function(){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoCommingSoon,true);return false})})})(jQuery);window.ASC.Files.Uploads=(function(a){var i=false;var d="";var f=null;var r=0;var h=function(){if(i===false){i=true}};var n=function(t,v){if(t){var u=t.Message}if(u!=undefined&&parseInt(u)>0){if(d==ASC.Files.Folders.currentFolderId){if(jq("#content_file_"+u).html()!=null&&jq("#content_file_"+u).html()!=""){ASC.Files.Folders.replaceVersion(u,false)}else{ASC.Files.Folders.getFile(u)}}r++}else{if(u&&u.length>0){ASC.Files.UI.displayInfoPanel(u,true)}}};var m=function(t,v){if(t){var u=t.Message}if(u!=undefined&&parseInt(u)>0){ASC.Files.Folders.replaceVersion(u,true,true)}else{if(u&&u.length>0){ASC.Files.UI.displayInfoPanel(u,true)}}};var l=function(t){jq("#uploads_message").text(ASC.Files.Resources.Uploading+" "+t.CurrentFile)};var k=function(){jq("#files_uploadDialogContainer .cancelButton").show();jq("#files_swf_button_container").hide();j()};var j=function(){jq("#files_uploadDialogContainer .cancelButton").show();jq("#files_swf_button_container").hide();jq("#upload_finish").show();PopupKeyUpActionProvider.CloseDialogAction="";PopupKeyUpActionProvider.EnterAction='jq("#files_okUpload").click();';ASC.Files.UI.addRowHandlers();if(jq("div.fileRow").length>0){ASC.Files.UI.hideEmpty()}};var o=function(){var t=jq("div.newFile");if(t.length>0){t.removeClass("newFile").show().yellowFade()}ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoUploadedSuccess,r))};var q=function(){if(ASC.Controls.Constants.isMobileAgent||jq("#files_uploadDialogContainer:visible").length!=0){return}if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.ErrorMassage_SecurityException,true);ASC.Files.Folders.eventAfter=q;ASC.Files.UI.defaultFolderSet();return}jq("#files_upload_select").css("display","");jq("#files_swf_button_container").show();jq("#panelButtons").show();jq("#files_upload_btn_html5").show();jq("#files_uploadDlgPanelButtons").hide();jq("#upload_finish").hide();jq("#files_uploadDialogContainer .cancelButton").show();jq("#uploadDialogContainerHeader").html(jq.format('{0} "<span title="{1}">{1}</span>"',ASC.Files.Resources.UploadFileTo,jq("#files_folderName").text()));ASC.Files.Common.blockUI(jq("#files_uploadDialogContainer"),600,600);ASC.Files.Uploads.documentTitleFix();PopupKeyUpActionProvider.EnableEsc=false;PopupKeyUpActionProvider.CloseDialogAction="ASC.Files.Uploads.documentTitleFix();";PopupKeyUpActionProvider.EnterAction=jq.browser.mozilla?"":'jq("#files_uploadSubmit").click();';jq("#files_upload_fileList").html("");c("files_upload_fileList",ASC.Files.Folders.currentFolderId);jq("#asc_fileuploaderSWFContainer").attr("style","");jq("#files_okUpload").unbind("click").click(function(){ASC.Files.Uploads.showUploadedFiles();PopupKeyUpActionProvider.CloseDialog()})};var p=function(t){if(ASC.Controls.Constants.isMobileAgent){return}if(t==undefined||ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem("file_"+t)||jq("#files_uploadDialogContainer:visible").length!=0){return}jq("#files_upload_select").css("display","");jq("#files_swf_button_container").show();jq("#panelButtons").show();jq("#files_upload_btn_html5").show();jq("#files_uploadDlgPanelButtons").hide();jq("#upload_finish").hide();jq("#files_uploadDialogContainer .cancelButton").show();jq("#uploadDialogContainerHeader").html(ASC.Files.Resources.UpdateFileVersionFor+' "'+jq("#content_file_"+t+" div.fileName a.name").attr("title")+'"');jq("#files_upload_fileList").html("");ASC.Files.Common.blockUI(jq("#files_uploadDialogContainer"),600,400);PopupKeyUpActionProvider.CloseDialogAction="ASC.Files.Uploads.documentTitleFix();";PopupKeyUpActionProvider.EnterAction=jq.browser.mozilla?"":'jq("#files_uploadSubmit").click();';PopupKeyUpActionProvider.EnableEsc=false;ASC.Files.Uploads.documentTitleFix();b("files_upload_fileList",t);jq("#asc_fileuploaderSWFContainer").attr("style","");jq("#files_okUpload").unbind("click").click(function(){PopupKeyUpActionProvider.CloseDialog()})};var c=function(w,v){jq("object[id*='SWFUpload']").before('<span id="asc_fileuploaderSWFObj"></span>');r=0;try{jq("object[id*='SWFUpload']").remove()}catch(u){}d=v;var t=jq("#files_upload_btn").attr("id")||jq("#files_swf_button_container a.files_upload_btn").attr("id");if(ASC.Files.DragDrop.isFileAPI()){jq("#files_swf_button_container").hide();jq("#files_upload_pnl").hide();t=jq(".files_upload_btn_html5").attr("id")}else{jq("#files_swf_button_container").show();jq("#files_upload_pnl").show()}if(typeof ASC!=="undefined"&&typeof ASC.Controls!=="undefined"&&typeof ASC.Controls.FileUploader!=="undefined"){f=FileHtml5Uploader.InitFileUploader({FileUploadHandler:"ASC.Web.Files.Classes.FilesUploader,ASC.Web.Files",FileSizeLimit:ASC.Files.Constants.MAX_UPLOAD_KB,AutoSubmit:false,ProgressTimeSpan:1000,UploadButtonID:t,TargetContainerID:w,Data:{folderId:v},OnUploadComplete:n,OnAllUploadComplete:k,OnProgress:l,file_types:ASC.Files.Utils.SupportFileTypes,AddFilesText:ASC.Files.Resources.ButtonAddFiles,SelectFilesText:ASC.Files.Resources.ButtonSelectFiles,ErrorFileTypeText:ASC.Files.Resources.ErrorMassage_FileTypeText,DeleteLinkCSSClass:"files_deleteLinkCSSClass",LoadingImageCSSClass:"files_loadingCSSClass",CompleteCSSClass:"files_completeCSSClass",OverAllProcessBarCssClass:"files_overAllProcessBarCssClass",DragDropHolder:jq("#files_uploadDialogContainer div.panelContent"),FilesHeaderCountHolder:jq("#files_uploadHeader"),OverAllProcessHolder:jq("#files_overallprocessHolder"),SubmitPanelAfterSelectHolder:jq("#files_uploadDlgPanelButtons"),OverallProgressText:ASC.Files.Resources.OverallProgress,FilesHeaderText:ASC.Files.Resources.UploadedOf,SelectFileText:ASC.Files.Resources.SelectFilesToUpload,DragDropText:ASC.Files.Resources.OrDragDrop,SelectedFilesText:ASC.Files.Resources.SelectedFiles})}jq("#"+t).unbind("mouseover")};var b=function(w,v){jq("object[id*='SWFUpload']").before('<span id="asc_fileuploaderSWFObj"></span>');r=0;try{jq("object[id*='SWFUpload']").remove()}catch(u){}var t=jq("#files_upload_btn").attr("id")||jq("#files_swf_button_container a.files_upload_btn").attr("id");d=ASC.Files.Folders.currentFolderId;if(ASC.Files.DragDrop.isFileAPI()){jq("#files_swf_button_container").hide();jq("#files_upload_pnl").hide();t=jq(".files_upload_btn_html5").attr("id")}else{jq("#files_swf_button_container").show();jq("#files_upload_pnl").show()}if(typeof ASC!=="undefined"&&typeof ASC.Controls!=="undefined"&&typeof ASC.Controls.FileUploader!=="undefined"){f=FileHtml5Uploader.InitFileUploader({FileUploadHandler:"ASC.Web.Files.Classes.FilesUploader,ASC.Web.Files",FileSizeLimit:ASC.Files.Constants.MAX_UPLOAD_KB,AutoSubmit:false,ProgressTimeSpan:1000,UploadButtonID:t,AddFilesText:ASC.Files.Resources.ButtonAddFiles,SelectFilesText:ASC.Files.Resources.ButtonSelectFiles,TargetContainerID:w,Data:{fileid:v},SingleUploader:true,OnUploadComplete:m,OnAllUploadComplete:j,OnProgress:l,file_types:ASC.Files.Utils.SupportFileTypes,ErrorFileTypeText:ASC.Files.Resources.ErrorMassage_FileTypeText,DeleteLinkCSSClass:"files_deleteLinkCSSClass",LoadingImageCSSClass:"files_loadingCSSClass",CompleteCSSClass:"files_completeCSSClass",DragDropHolder:jq("#files_uploadDialogContainer div.panelContent"),FilesHeaderCountHolder:jq("#files_uploadHeader"),OverAllProcessHolder:jq("#files_overallprocessHolder"),OverAllProcessBarCssClass:"files_overAllProcessBarCssClass",OverallProgressText:ASC.Files.Resources.OverallProgress,FilesHeaderText:ASC.Files.Resources.UploadedOf,SelectFileText:ASC.Files.Resources.SelectFilesToUpload,DragDropText:ASC.Files.Resources.OrDragDrop,SelectedFilesText:ASC.Files.Resources.SelectedFiles,SubmitPanelAfterSelectHolder:jq("#files_uploadDlgPanelButtons"),FileNameFilter:jq("#content_file_"+v+" div.fileName a.name").attr("title"),FileNameExeptionText:ASC.Files.Resources.FileNameIsNotEqual})}jq("#"+t).unbind("mouseover")};var g=function(){PopupKeyUpActionProvider.EnterAction="";r=0;if(f!=null){if(jq("#files_upload_fileList").html()==""){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.EmptyListUpload,true);PopupKeyUpActionProvider.EnterAction=jq.browser.mozilla?"":'jq("#files_uploadSubmit").click();';return}jq("#uploads_message").text(ASC.Files.Resources.UploadProcess);jq("#panelButtons").hide();jq("#files_upload_btn_html5").hide();jq("#files_uploadDialogContainer .cancelButton").hide();f.Submit()}};var s=function(u){var t=jq(u).parents(".fileRow").attr("id").replace("content_file_","");ASC.Files.Uploads.showUploadNewVersion(t)};var e=function(){if(jq.browser.msie){setInterval("document.title = jq('#files_folderName').html() + ' - ' + ASC.Files.Constants.TITLE_PAGE;",200)}};return{init:h,showUploadPopup:q,onUploadComplete:n,fileUploaderSubmit:g,showUploadNewVersion:p,showUploadedFiles:o,uploadFromHistory:s,documentTitleFix:e}})(jQuery);(function(a){ASC.Files.Uploads.init();a(function(){jq("#files_uploadSubmit").click(function(){ASC.Files.Uploads.fileUploaderSubmit()});jq("#files_uploaddialog_btn").click(function(){ASC.Files.Uploads.showUploadPopup()});jq("#files_emptyFolder_btn").click(function(){ASC.Files.Uploads.showUploadPopup();return false});if(ASC.Controls.Constants.isMobileAgent){jq("#files_uploaddialog_btn, #files_emptyFolder_btn, #files_uploads_files").remove()}})})(jQuery);window.ASC.Files.Favorites=(function(a){var f=false;var e=function(){if(f===false){f=true;serviceManager.bind(ASC.Files.TemplateManager.events.GetFavorites,g);serviceManager.bind(ASC.Files.TemplateManager.events.SaveFavorite,i);serviceManager.bind(ASC.Files.TemplateManager.events.RemoveFavorite,h)}};var l=function(q){var p=c(q.attr("id").replace("content_",""));if(p!=null){jq("a.file_fav_notyet",q).removeClass("file_fav_notyet").addClass("file_fav_already").attr("alt",ASC.Files.Resources.RemoveFavorites).attr("title",ASC.Files.Resources.RemoveFavorites).removeAttr("onclick").unbind("click").click(function(r){ASC.Files.Favorites.showRemoveFavorite(this,r,p)});return}};var c=function(p){var q=jq("#files_favoritesBody input.fav_list[value='"+p+"']");if(q.length==0){return null}return q.parent().attr("id").replace("favoritesRow_","")};var d=function(p){var r=jq("#favoritesRow_"+p+" input[type='hidden']").val();if(r.search("file_")==0){var q=r.replace("file_","");ASC.Files.Folders.clickOnFile(q,null,jq("#favoritesRow_"+p+" a").html(),true)}else{if(r.search("folder_")==0){ASC.Files.Folders.clickOnFolder(r.replace("folder_",""),true)}}};var b=function(p){jq(".favoritesRemoveAction").hide();jq("#removeBtn_"+p).show()};var n=function(r,p,q){ASC.Files.UI.finishMoveTo({},p);ASC.Files.Actions.hideAllActionPanels();ASC.Files.UI.checkSelectAll(false);ASC.Files.UI.selectRow(jq(r).parents("div.fileRow"),true);var s=jq("div.fileName a.name",jq(r).parents(".fileRow")).attr("title");jq("#favoriteRemoveText").html(jq.format(ASC.Files.Resources.FavoritesRemove,"<br/><b>"+s+"</b><br/>"));ASC.Files.Common.dropdownToggle(jq(r),"favorites_remove_dialog");PopupKeyUpActionProvider.CloseDialogAction='jq("#favoriteRemoveBtn").unbind("click");ASC.Files.Actions.hideAllActionPanels();';PopupKeyUpActionProvider.EnterAction='jq("#favoriteRemoveBtn").click();';jq("#favoriteRemoveBtn").unbind("click").click(function(){j(q);PopupKeyUpActionProvider.CloseDialog()});jq("body").click(function(t){if(!jq((t.target)?t.target:t.srcElement).parents().andSelf().is("#favorites_remove_dialog, div.fav, #"+r.id)){PopupKeyUpActionProvider.CloseDialog()}})};var o=function(t,p,v){ASC.Files.UI.finishMoveTo({},p);ASC.Files.Actions.hideAllActionPanels();if(ASC.Files.Folders.folderContainer=="trash"){return}var x="";var r="";var w="";if(v){x="folder";r=ASC.Files.Folders.currentFolderId;if(r==0){r=ASC.Files.Folders.folderContainer}w=jq("#files_folderName").html()}else{ASC.Files.UI.checkSelectAll(false);ASC.Files.UI.selectRow(jq(t).parents("div.fileRow"),true);var u=jq(t).parents("div.fileRow").attr("id");x=u.split("_")[1];r=u.split("_")[2];w=jq("#"+u+" div.fileName a.name").attr("title");if(x=="file"){var s=ASC.Files.Utils.getFileExts(w).length;w=w.substring(0,w.length-s)}}var q=jq("#files_favoritesBody input.fav_list[value='"+x+"_"+r+"']");if(q.length!=0){q.parent(".favoritesRow").yellowFade();return}ASC.Files.Common.dropdownToggle(jq(t),"favorites_prompt_name");PopupKeyUpActionProvider.CloseDialogAction='jq("#favoriteOkBtn").unbind("click");ASC.Files.Actions.hideAllActionPanels();';PopupKeyUpActionProvider.EnterAction='jq("#favoriteOkBtn").click();';jq("#favoriteNewName").val(w).focus().select();jq("#favoriteOkBtn").unbind("click").click(function(){var z=ASC.Files.Utils.replaceSpecCharacter(jq("#favoriteNewName").val().trim());if(z==""||z==null){PopupKeyUpActionProvider.CloseDialog();return}if(x=="file"){var A=jq("#"+u+" div.fileName a.name").attr("title");var y=ASC.Files.Utils.getFileExts(A).length;z+=A.substring(A.length-y)}k({path:(x+"_"+r),title:z});PopupKeyUpActionProvider.CloseDialog()});jq("body").click(function(y){if(!jq((y.target)?y.target:y.srcElement).parents().andSelf().is("#favorites_prompt_name, div.fav, #"+t.id)){PopupKeyUpActionProvider.CloseDialog()}})};var m=function(){serviceManager.request("get","xml",ASC.Files.TemplateManager.events.GetFavorites,{ajaxsync:true,showLoading:true},"favorites")};var k=function(p){serviceManager.request("get","xml",ASC.Files.TemplateManager.events.SaveFavorite,p,"favorites","add?title="+encodeURIComponent(p.title)+"&folderPath="+p.path)};var j=function(p){serviceManager.request("delete","xml",ASC.Files.TemplateManager.events.RemoveFavorite,{favoriteID:p,path:jq("#favoritesRow_"+p+" input").val()},"favorites",p)};var g=function(t,s,q,p){if(typeof q!="undefined"){ASC.Files.UI.displayInfoPanel(p||q,true);return undefined}var u=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFavorite);if(typeof u==="undefined"){return undefined}var r=ASC.Controls.XSLTManager.translate(t,u);jq("#files_favoritesBody").html(r);jq("#files_favoritesEmpty").show();if(r.length==0){return}jq("#files_favoritesEmpty").hide();jq("#files_favoritesBody").show();jq("#files_favoritesBody .favoritesRow").each(function(){var x=jq(this).children(".fav_list").val();if(x.search("file_")==0){title=jq(this).children(".fav_file").html();var v=x.replace("file_","");var w=jq(this).children(".fav_file");if(ASC.Files.Utils.FileCanBePreview(title)){var y=ASC.Files.Utils.getPreviewUrl(title,v);if(ASC.Files.Utils.itIsDocument(title)){w.attr("href",y).attr("target","_blank")}else{w.attr("href",y)}}else{w.attr("href",ASC.Files.Utils.fileDownloadUrl(v))}}else{if(x.search("folder_")==0){var v=x.replace("folder_","");jq(this).children(".fav_folder").attr("href","#"+v)}}});jq("div.fileRow").each(function(){ASC.Files.Favorites.setIfFavorites(jq(this))})};var i=function(u,t,q,p){if(typeof q!="undefined"){ASC.Files.UI.displayInfoPanel(p||q,true);return undefined}var v=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getFavorite);if(typeof v==="undefined"){return undefined}var r=ASC.Controls.XSLTManager.translate(u,v);jq("#files_favoritesBody").append(r);jq("#files_favoritesEmpty").hide();jq("#files_favoritesBody").show();jq("#files_favoritesBody .favoritesRow:last").each(function(){var y=jq(this).children(".fav_list").val();if(y.search("file_")==0){title=jq(this).children(".fav_file").html();var w=y.replace("file_","");var x=jq(this).children(".fav_file");if(ASC.Files.Utils.FileCanBePreview(title)){var z=ASC.Files.Utils.getPreviewUrl(title,w);if(ASC.Files.Utils.itIsDocument(title)){x.attr("href",z).attr("target","_blank")}else{x.attr("href",z)}}else{x.attr("href",ASC.Files.Utils.fileDownloadUrl(w))}}else{if(y.search("folder_")==0){var w=y.replace("folder_","");jq(this).children(".fav_folder").attr("href","#"+w)}}});var s=jq("#files_favoritesBody .favoritesRow:last").attr("id").replace("favoritesRow_","");jq("#content_"+t.path+" a.file_fav_notyet").removeClass("file_fav_notyet").attr("alt",ASC.Files.Resources.RemoveFavorites).attr("title",ASC.Files.Resources.RemoveFavorites).removeClass("file_fav_action").addClass("file_fav_already").removeAttr("onclick").unbind("click").click(function(w){ASC.Files.Favorites.showRemoveFavorite(this,w,s)});ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoAddFavorite,t.title))};var h=function(t,r,q,p){if(typeof q!="undefined"){ASC.Files.UI.displayInfoPanel(p||q,true);return undefined}var s=jq("#favoritesRow_"+r.favoriteID+" a").attr("title");jq("#favoritesRow_"+r.favoriteID).remove();if(jq("#files_favoritesBody").html()!=null&&jq("#files_favoritesBody").html().length==0){jq("#files_favoritesBody").hide();jq("#files_favoritesEmpty").show()}jq("#content_"+r.path+" a.file_fav_already").removeClass("file_fav_already").addClass("file_fav_notyet").attr("alt",ASC.Files.Resources.AddToFavorites).attr("title",ASC.Files.Resources.AddToFavorites).unbind("click").click(function(u){ASC.Files.Favorites.showToFavorite(this,u)});ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoRemoveFavorites,s))};return{init:e,setIfFavorites:l,favoriteId:c,getFavorite:d,displayRemoveBtn:b,showFavorite:m,showToFavorite:o,showRemoveFavorite:n,saveFavorite:k,removeFavorite:j}})(jQuery);(function(a){ASC.Files.Favorites.init();a(function(){ASC.Files.Favorites.showFavorite();jq("#favorites_addcurrent").click(function(b){ASC.Files.Favorites.showToFavorite(this,b,true);return false})})})(jQuery);var OAuthCallback=function(b,a){ASC.Files.Import.getImportData(a,b)};var OAuthError=function(a,b){ASC.Files.UI.displayInfoPanel(a,true)};var OAuthPopup=function(e,f,b){var c;try{var d="height="+b+",width="+f+",resizable=0,status=0,toolbar=0,menubar=0,location=1";c=window.open(e,"Authorization",d)}catch(a){c=window.open(e,"Authorization")}return c};window.ASC.Files.Import=(function(a){var e=false;var g=false;var h=false;var f=function(){if(h===false){h=true;serviceManager.bind(ASC.Files.TemplateManager.events.IsZohoAuthentificated,m);serviceManager.bind(ASC.Files.TemplateManager.events.GetImportData,k);serviceManager.bind(ASC.Files.TemplateManager.events.ExecImportData,ASC.Files.EventHandler.onGetTasksStatuses)}};var o=function(t,s){jq("#files_importToFolder").text(s);jq("#files_importToFolderId").val(t);ASC.Files.Actions.hideAllActionPanels()};var q=function(){jq("#files_pass").val("");jq("#files_login, #files_pass").removeAttr("disabled");jq("#LoginDialogTemp .action-block").show();jq("#LoginDialogTemp .ajax-info-block").hide();jq("#LoginDialogTemp div[id$='InfoPanel']").hide();ASC.Files.Common.blockUI(jq("#LoginDialogTemp"),400,500);PopupKeyUpActionProvider.EnterAction='jq("#files_submitLoginDialog").click();';PopupKeyUpActionProvider.CloseDialogAction='jq("#files_pass").val("");';jq("#files_login").focus()};var r=function(){var t=jq("#files_login").val().trim();var u=jq("#files_pass").val().trim();if(t==""||u==""){var s=jq("#LoginDialogTemp div[id$='InfoPanel']");if(s.css("display")=="none"){s.removeClass("infoPanel").addClass("errorBox").css("margin","10px 16px 0").show()}s.find("div").text(ASC.Files.Resources.ErrorMassage_FiledsIsEmpty);jq("#files_pass").val("");return}jq("#files_login, #files_pass").attr("disabled","disabled");jq("#LoginDialogTemp .action-block").hide();jq("#LoginDialogTemp .ajax-info-block").show();i({login:t,pass:u})};var c=function(x){var s=jq("#ImportDialogTemp input[name='checked_document']:checked");var w=jq("#ImportDialogTemp div[id$='InfoPanel']");if(s.length==0){if(w.css("display")=="none"){w.removeClass("infoPanel").addClass("errorBox").css("margin","10px 16px 0").show()}w.find("div").text(ASC.Files.Resources.EmptyListSelectedForImport);return}var t="<ArrayOfDataToImport>";Encoder.EncodeType="!entity";s.each(function(z){var y=jq(this).parents("tr").find("td");t+="<DataToImport>";t+="<content_link>"+Encoder.htmlEncode(jq("<div/>").text(jq(this).val().trim()).html())+"</content_link>";t+="<title>"+Encoder.htmlEncode(jq(y[1]).text().trim())+"</title>";t+="</DataToImport>"});Encoder.EncodeType="entity";t+="</ArrayOfDataToImport>";x.tofolder=jq("#files_importToFolderId").val();x.ignoreCoincidenceFiles=jq("#ImportDialogTemp input[name='file_conflict']:checked").val();var u=jq("#ImportDialogTemp div.import_progress_panel");u.find(".studioFileUploaderProgressBar").width(0);u.find("span.percent").width(0);u.show();jq("#ImportDialogTemp input:checkbox").attr("disabled","disabled");jq("#ImportDialogTemp .action-block").hide();jq("#ImportDialogTemp .action-block-progress").show();w.hide();var v=jq("#files_import_container li.import");v.unbind("click");v.css("cursor","pointer");n(x,t)};var p=function(s){ASC.Files.Import.isImport=true;ASC.Files.Tree.showTreePath();ASC.Files.Tree.showSelect("stree_selector_"+ASC.Files.Constants.FOLDER_ID_MY_FILES);ASC.Files.Actions.hideAllActionPanels();ASC.Files.Common.dropdownToggle(jq("#"+s),"files_treeViewPanelSelector");jq("#files_treeViewPanelSelector").css("z-index","700");jq("body").click(function(t){if(!jq((t.target)?t.target:t.srcElement).parents().andSelf().is("#files_treeViewPanelSelector")){ASC.Files.Actions.hideAllActionPanels()}})};var j=function(t){var s;switch(t){case"google":s=jq("#files_import_container	li.import_from_google");break;case"zoho":s=jq("#files_import_container	li.import_from_zoho");break;case"box.net":case"boxnet":s=jq("#files_import_container	li.import_from_boxnet");break;default:return false}s.append(jq("#import_progress_min").clone(true).attr("id","import_progress_min_clone").show())};var b=function(u,t){ASC.Files.Import.ImportStatus=false;jq("#import_progress_min_clone").remove();if(jq("#ImportDialogTemp:visible").length!=0){var s=jq("#files_importToFolderId").val();PopupKeyUpActionProvider.CloseDialog();ASC.Files.UI.navigationSet(s)}ASC.Files.UI.displayInfoPanel(u,t===true)};var i=function(s){serviceManager.request("get","xml",ASC.Files.TemplateManager.events.IsZohoAuthentificated,s,"import","isauth?source=zoho&login="+s.login+"&pass="+s.pass)};var d=function(t){var u="";var s={};s.source=t;s.showLoading=(s.source!="zoho");if(t=="google"||t=="box.net"){s.token=arguments[1]}if(t=="zoho"){s.login=arguments[1];s.pass=arguments[2]}switch(s.source){case"google":u="import?source=google&token="+s.token;break;case"box.net":u="import?source=boxnet&token="+s.token;break;case"zoho":u="import?source=zoho&login="+s.login+"&pass="+s.pass;break;default:return}serviceManager.request("get","xml",ASC.Files.TemplateManager.events.GetImportData,s,u)};var n=function(t,s){t.showLoading=true;var u="";switch(t.source){case"google":u="import/exec?source=google&tofolder="+t.tofolder+"&ignoreCoincidenceFiles="+t.ignoreCoincidenceFiles+"&token="+t.token;break;case"zoho":u="import/exec?source=zoho&tofolder="+t.tofolder+"&ignoreCoincidenceFiles="+t.ignoreCoincidenceFiles+"&login="+t.login+"&pass="+t.pass;break;case"box.net":u="import/exec?source=boxnet&tofolder="+t.tofolder+"&ignoreCoincidenceFiles="+t.ignoreCoincidenceFiles+"&token="+t.token;break;default:return}serviceManager.request("post","json",ASC.Files.TemplateManager.events.ExecImportData,t,s,u)};var m=function(w,v,t,s){if(typeof t!="undefined"){ASC.Files.UI.displayInfoPanel(s||t,true);return undefined}jq("#files_pass").val("");var u=jq("#LoginDialogTemp div[id$='InfoPanel']");if(jq(w).text()!="true"){if(u.css("display")=="none"){u.removeClass("infoPanel").addClass("errorBox").css("margin","10px 16px 0").show()}u.find("div").text(ASC.Files.Resources.ErrorMassage_AuthentificatedFalse);jq("#files_login, #files_pass").removeAttr("disabled");jq("#LoginDialogTemp .action-block").show();jq("#LoginDialogTemp .ajax-info-block").hide();return}u.hide();ASC.Files.Import.getImportData("zoho",v.login,v.pass)};var k=function(y,x,t,s){PopupKeyUpActionProvider.CloseDialog();if(typeof t!="undefined"||y==null){ASC.Files.UI.displayInfoPanel(s||t,true);return undefined}if(y.getElementsByTagName("DataToImportList").length==0){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.EmptyDataToImport,true);return}var z=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getImportData);if(typeof z==="undefined"){return undefined}var u=ASC.Controls.XSLTManager.translate(y,z);jq("#import_data").html(u);jq("#ImportDialogTemp input[name='all_checked_document']").unbind("click").click(function(){var A=jq(this).is(":checked");jq("#ImportDialogTemp input[name='checked_document']").each(function(){jq(this).attr("checked",A)})});jq("#ImportDialogTemp input[name='checked_document']").unbind("click").click(function(){jq("#ImportDialogTemp input[name='all_checked_document']").attr("checked",jq("#ImportDialogTemp input[name='checked_document']:checked").length==jq("#ImportDialogTemp input[name='checked_document']").length)});jq("#files_startImportData").unbind("click").click(function(){ASC.Files.Import.execImportData(x);return false});jq("#files_importToFolderBtn").unbind("click").click(function(){ASC.Files.Import.showImportToSelector("files_importToFolderBtn");return false});jq("#files_import_minimize").unbind("click").click(function(){PopupKeyUpActionProvider.CloseDialog();return false});var w=ASC.Files.Folders.currentFolderId;var v=jq("#files_folderName").text();if(!(ASC.Files.Folders.folderContainer=="my"&&ASC.Files.UI.accessibleItem("folder_"+w)||w==ASC.Files.Constants.FOLDER_ID_COMMON_FILES&&ASC.Files.Constants.USER_ADMIN)){w=ASC.Files.Constants.FOLDER_ID_MY_FILES;v=jq("#stree_selector_"+w).text()}jq("#files_importToFolderId").val(w);jq("#files_importToFolder").text(v);switch(x.source){case"google":jq("#ImportDialogTemp .containerHeaderBlock span.header-content, #import_to_folder span").text(ASC.Files.Resources.ImportFromGoogle);break;case"zoho":jq("#ImportDialogTemp .containerHeaderBlock span.header-content, #import_to_folder span").text(ASC.Files.Resources.ImportFromZoho);break;case"box.net":jq("#ImportDialogTemp .containerHeaderBlock span.header-content, #import_to_folder span").text(ASC.Files.Resources.ImportFromBoxNet);break;default:PopupKeyUpActionProvider.CloseDialog()}jq("#ImportDialogTemp input:checkbox").removeAttr("disabled");jq("#ImportDialogTemp .action-block").show();jq("#ImportDialogTemp .action-block-progress").hide();jq("#ImportDialogTemp .import_progress_panel").hide();jq("#ImportDialogTemp .studioFileUploaderProgressBar").width(0);jq("#ImportDialogTemp span.percent").text("0");jq("#ImportDialogTemp div[id$='InfoPanel']").hide();PopupKeyUpActionProvider.EnterAction='jq("#files_startImportData").click();';ASC.Files.Common.blockUI(jq("#ImportDialogTemp"),900,540)};var l=function(s){if(jq("#import_progress_min_clone").length==0){ASC.Files.Import.minimizeImportStatus(s.source)}ASC.Files.Import.ImportStatus=true;try{var u=parseInt(s.progress)||0}catch(t){u=prBar.css("width")||0}if(u>0){jq("#ImportDialogTemp .studioFileUploaderProgressBar").css("width",u+"%");jq("#import_progress_min_clone .files_minimize_uploader").css("width",u+"%");jq("#ImportDialogTemp span.percent").text(u)}if(u==100){ASC.Files.Import.cancelImportData(s.error||ASC.Files.Resources.InfoFinishImprot,s.error!=null);if(s.error!=null){ASC.Files.UI.displayInfoPanel(s.error,true)}return true}return false};return{init:f,submitLoginDialog:r,showSubmitLoginDialog:q,getImportData:d,execImportData:c,cancelImportData:b,minimizeImportStatus:j,showImportToSelector:p,setFolderImportTo:o,isImport:g,ImportStatus:e,onGetImportStatus:l}})(jQuery);(function(a){ASC.Files.Import.init();a(function(){jq("#files_import_container li.import_from_google").click(function(){if(jq("#import_progress_min_clone").length!=0||ASC.Files.Import.ImportStatus){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoImprotNotFinish,true);return}OAuthPopup(ASC.Files.Constants.URL_OAUTH_GOOGLE,800,600);return false});jq("#files_import_container li.import_from_boxnet").click(function(){if(jq("#import_progress_min_clone").length!=0||ASC.Files.Import.ImportStatus){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoImprotNotFinish,true);return}OAuthPopup(ASC.Files.Constants.URL_OAUTH_BOXNET,960,600);return false});jq("#files_import_container li.import_from_zoho").click(function(){if(jq("#import_progress_min_clone").length!=0||ASC.Files.Import.ImportStatus){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoImprotNotFinish,true);return}ASC.Files.Import.showSubmitLoginDialog();return false});jq("#files_submitLoginDialog").click(function(){ASC.Files.Import.submitLoginDialog();return false});if(ASC.Controls.Constants.isMobileAgent){jq("div.import_data_table").css({height:"auto"})}})})(jQuery);window.ASC.Files.MainMenu=(function(a){var c=false;var b=function(){if(c===false){c=true;jq(document).click(function(f){ASC.Files.Common.dropdownRegisterAutoHide(f,"#files_newdoc_btn","#files_newDocumentPanel")})}};var e=function(){var g=jq("#mainMenuHolderSpacer");var f=jq("#mainMenuHolder");var h=jq("#files_newdoc_btn img");var i=32;if(g.css("display")=="none"){i+=f.offset().top}else{i+=g.offset().top}if(jq(window).scrollTop()>i){g.show();f.addClass("fixed");if(h.length!=0){jq("#files_newDocumentPanel").css({position:"fixed",top:h.offset().top+h.outerHeight()-jq(window).scrollTop()})}if(ASC.Controls.Constants.isMobileAgent){f.css("top",jq(document).scrollTop()+"px")}}else{g.hide();f.removeClass("fixed");if(h.length!=0){jq("#files_newDocumentPanel").css({position:"absolute",top:h.offset().top+h.outerHeight()})}}};var d=function(){var f="";f+=ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.text)?"":"#files_create_text,";f+=ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.spreadsheet)?"":"#files_create_spreadsheet,";f+=ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.presentation)?"":"#files_create_presentation,";if(f.length!=0){switch(ASC.Files.Plugin.GetOpenOfficeState()){case ASC.Files.Plugin.OPEN_OFFICE_STATE_NOT_INSTALLED:case ASC.Files.Plugin.OPEN_OFFICE_STATE_INSTALLING:jq(f).css({opacity:0.5,"background-color":"#FFFFFF"});break;case ASC.Files.Plugin.OPEN_OFFICE_STATE_INSTALLED:jq(f).css({opacity:1,"background-color":""});break}}ASC.Files.Common.dropdownToggle(jq("#files_newdoc_btn img"),"files_newDocumentPanel")};return{init:b,showCreateNewDoc:d,toggleMainMenu:e}})(jQuery);(function(a){ASC.Files.MainMenu.init();a(function(){jq("#mainMenuHolderSpacer").css({height:jq("ul#mainMenuHolder").outerHeight()});jq("#files_newdoc_btn").click(function(b){ASC.Files.MainMenu.showCreateNewDoc()});if(navigator.appVersion.indexOf("Win")==-1||jq.browser.safari||jq.browser.opera||!ASC.Files.Constants.PLUGIN_ENABLE){if(!ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.text)){jq("#files_create_text").remove()}if(!ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.spreadsheet)){jq("#files_create_spreadsheet").remove()}if(!ASC.Files.Utils.FileCanBeEdit(ASC.Files.Utils.typeNewDoc.presentation)){jq("#files_create_presentation").remove()}if(jq("#files_newDocumentPanel ul li").length==0){jq("#files_newDocumentPanel").remove();jq("#files_newdoc_btn").parents("li").remove()}}jq(window).scroll(function(){ASC.Files.MainMenu.toggleMainMenu();return true});jq(".comming_soon").unbind("click").click(function(){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoCommingSoon,true);return false})})})(jQuery);window.ASC.Files.Uploads=(function(a){var i=false;var d="";var f=null;var r=0;var h=function(){if(i===false){i=true}};var n=function(t,v){if(t){var u=t.Message}if(u!=undefined&&parseInt(u)>0){if(d==ASC.Files.Folders.currentFolderId){if(jq("#content_file_"+u).html()!=null&&jq("#content_file_"+u).html()!=""){ASC.Files.Folders.replaceVersion(u,false)}else{ASC.Files.Folders.getFile(u)}}r++}else{if(u&&u.length>0){ASC.Files.UI.displayInfoPanel(u,true)}}};var m=function(t,v){if(t){var u=t.Message}if(u!=undefined&&parseInt(u)>0){ASC.Files.Folders.replaceVersion(u,true,true)}else{if(u&&u.length>0){ASC.Files.UI.displayInfoPanel(u,true)}}};var l=function(t){jq("#uploads_message").text(ASC.Files.Resources.Uploading+" "+t.CurrentFile)};var k=function(){jq("#files_uploadDialogContainer .cancelButton").show();jq("#files_swf_button_container").hide();j()};var j=function(){jq("#files_uploadDialogContainer .cancelButton").show();jq("#files_swf_button_container").hide();jq("#upload_finish").show();PopupKeyUpActionProvider.CloseDialogAction="";PopupKeyUpActionProvider.EnterAction='jq("#files_okUpload").click();';ASC.Files.UI.addRowHandlers();if(jq("div.fileRow").length>0){ASC.Files.UI.hideEmpty()}};var o=function(){var t=jq("div.newFile");if(t.length>0){t.removeClass("newFile").show().yellowFade()}ASC.Files.UI.displayInfoPanel(jq.format(ASC.Files.Resources.InfoUploadedSuccess,r))};var q=function(){if(ASC.Controls.Constants.isMobileAgent||jq("#files_uploadDialogContainer:visible").length!=0){return}if(ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem()){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.ErrorMassage_SecurityException,true);ASC.Files.Folders.eventAfter=q;ASC.Files.UI.defaultFolderSet();return}jq("#files_upload_select").css("display","");jq("#files_swf_button_container").show();jq("#panelButtons").show();jq("#files_upload_btn_html5").show();jq("#files_uploadDlgPanelButtons").hide();jq("#upload_finish").hide();jq("#files_uploadDialogContainer .cancelButton").show();jq("#uploadDialogContainerHeader").html(jq.format('{0} "<span title="{1}">{1}</span>"',ASC.Files.Resources.UploadFileTo,jq("#files_folderName").text()));ASC.Files.Common.blockUI(jq("#files_uploadDialogContainer"),600,600);ASC.Files.Uploads.documentTitleFix();PopupKeyUpActionProvider.EnableEsc=false;PopupKeyUpActionProvider.CloseDialogAction="ASC.Files.Uploads.documentTitleFix();";PopupKeyUpActionProvider.EnterAction=jq.browser.mozilla?"":'jq("#files_uploadSubmit").click();';jq("#files_upload_fileList").html("");c("files_upload_fileList",ASC.Files.Folders.currentFolderId);jq("#asc_fileuploaderSWFContainer").attr("style","");jq("#files_okUpload").unbind("click").click(function(){ASC.Files.Uploads.showUploadedFiles();PopupKeyUpActionProvider.CloseDialog()})};var p=function(t){if(ASC.Controls.Constants.isMobileAgent){return}if(t==undefined||ASC.Files.Folders.folderContainer=="trash"||!ASC.Files.UI.accessibleItem("file_"+t)||jq("#files_uploadDialogContainer:visible").length!=0){return}jq("#files_upload_select").css("display","");jq("#files_swf_button_container").show();jq("#panelButtons").show();jq("#files_upload_btn_html5").show();jq("#files_uploadDlgPanelButtons").hide();jq("#upload_finish").hide();jq("#files_uploadDialogContainer .cancelButton").show();jq("#uploadDialogContainerHeader").html(ASC.Files.Resources.UpdateFileVersionFor+' "'+jq("#content_file_"+t+" div.fileName a.name").attr("title")+'"');jq("#files_upload_fileList").html("");ASC.Files.Common.blockUI(jq("#files_uploadDialogContainer"),600,400);PopupKeyUpActionProvider.CloseDialogAction="ASC.Files.Uploads.documentTitleFix();";PopupKeyUpActionProvider.EnterAction=jq.browser.mozilla?"":'jq("#files_uploadSubmit").click();';PopupKeyUpActionProvider.EnableEsc=false;ASC.Files.Uploads.documentTitleFix();b("files_upload_fileList",t);jq("#asc_fileuploaderSWFContainer").attr("style","");jq("#files_okUpload").unbind("click").click(function(){PopupKeyUpActionProvider.CloseDialog()})};var c=function(w,v){jq("object[id*='SWFUpload']").before('<span id="asc_fileuploaderSWFObj"></span>');r=0;try{jq("object[id*='SWFUpload']").remove()}catch(u){}d=v;var t=jq("#files_upload_btn").attr("id")||jq("#files_swf_button_container a.files_upload_btn").attr("id");if(ASC.Files.DragDrop.isFileAPI()){jq("#files_swf_button_container").hide();jq("#files_upload_pnl").hide();t=jq(".files_upload_btn_html5").attr("id")}else{jq("#files_swf_button_container").show();jq("#files_upload_pnl").show()}if(typeof ASC!=="undefined"&&typeof ASC.Controls!=="undefined"&&typeof ASC.Controls.FileUploader!=="undefined"){f=FileHtml5Uploader.InitFileUploader({FileUploadHandler:"ASC.Web.Files.Classes.FilesUploader,ASC.Web.Files",FileSizeLimit:ASC.Files.Constants.MAX_UPLOAD_KB,AutoSubmit:false,ProgressTimeSpan:1000,UploadButtonID:t,TargetContainerID:w,Data:{folderId:v},OnUploadComplete:n,OnAllUploadComplete:k,OnProgress:l,file_types:ASC.Files.Utils.SupportFileTypes,AddFilesText:ASC.Files.Resources.ButtonAddFiles,SelectFilesText:ASC.Files.Resources.ButtonSelectFiles,ErrorFileTypeText:ASC.Files.Resources.ErrorMassage_FileTypeText,DeleteLinkCSSClass:"files_deleteLinkCSSClass",LoadingImageCSSClass:"files_loadingCSSClass",CompleteCSSClass:"files_completeCSSClass",OverAllProcessBarCssClass:"files_overAllProcessBarCssClass",DragDropHolder:jq("#files_uploadDialogContainer div.panelContent"),FilesHeaderCountHolder:jq("#files_uploadHeader"),OverAllProcessHolder:jq("#files_overallprocessHolder"),SubmitPanelAfterSelectHolder:jq("#files_uploadDlgPanelButtons"),OverallProgressText:ASC.Files.Resources.OverallProgress,FilesHeaderText:ASC.Files.Resources.UploadedOf,SelectFileText:ASC.Files.Resources.SelectFilesToUpload,DragDropText:ASC.Files.Resources.OrDragDrop,SelectedFilesText:ASC.Files.Resources.SelectedFiles})}jq("#"+t).unbind("mouseover")};var b=function(w,v){jq("object[id*='SWFUpload']").before('<span id="asc_fileuploaderSWFObj"></span>');r=0;try{jq("object[id*='SWFUpload']").remove()}catch(u){}var t=jq("#files_upload_btn").attr("id")||jq("#files_swf_button_container a.files_upload_btn").attr("id");d=ASC.Files.Folders.currentFolderId;if(ASC.Files.DragDrop.isFileAPI()){jq("#files_swf_button_container").hide();jq("#files_upload_pnl").hide();t=jq(".files_upload_btn_html5").attr("id")}else{jq("#files_swf_button_container").show();jq("#files_upload_pnl").show()}if(typeof ASC!=="undefined"&&typeof ASC.Controls!=="undefined"&&typeof ASC.Controls.FileUploader!=="undefined"){f=FileHtml5Uploader.InitFileUploader({FileUploadHandler:"ASC.Web.Files.Classes.FilesUploader,ASC.Web.Files",FileSizeLimit:ASC.Files.Constants.MAX_UPLOAD_KB,AutoSubmit:false,ProgressTimeSpan:1000,UploadButtonID:t,AddFilesText:ASC.Files.Resources.ButtonAddFiles,SelectFilesText:ASC.Files.Resources.ButtonSelectFiles,TargetContainerID:w,Data:{fileid:v},SingleUploader:true,OnUploadComplete:m,OnAllUploadComplete:j,OnProgress:l,file_types:ASC.Files.Utils.SupportFileTypes,ErrorFileTypeText:ASC.Files.Resources.ErrorMassage_FileTypeText,DeleteLinkCSSClass:"files_deleteLinkCSSClass",LoadingImageCSSClass:"files_loadingCSSClass",CompleteCSSClass:"files_completeCSSClass",DragDropHolder:jq("#files_uploadDialogContainer div.panelContent"),FilesHeaderCountHolder:jq("#files_uploadHeader"),OverAllProcessHolder:jq("#files_overallprocessHolder"),OverAllProcessBarCssClass:"files_overAllProcessBarCssClass",OverallProgressText:ASC.Files.Resources.OverallProgress,FilesHeaderText:ASC.Files.Resources.UploadedOf,SelectFileText:ASC.Files.Resources.SelectFilesToUpload,DragDropText:ASC.Files.Resources.OrDragDrop,SelectedFilesText:ASC.Files.Resources.SelectedFiles,SubmitPanelAfterSelectHolder:jq("#files_uploadDlgPanelButtons"),FileNameFilter:jq("#content_file_"+v+" div.fileName a.name").attr("title"),FileNameExeptionText:ASC.Files.Resources.FileNameIsNotEqual})}jq("#"+t).unbind("mouseover")};var g=function(){PopupKeyUpActionProvider.EnterAction="";r=0;if(f!=null){if(jq("#files_upload_fileList").html()==""){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.EmptyListUpload,true);PopupKeyUpActionProvider.EnterAction=jq.browser.mozilla?"":'jq("#files_uploadSubmit").click();';return}jq("#uploads_message").text(ASC.Files.Resources.UploadProcess);jq("#panelButtons").hide();jq("#files_upload_btn_html5").hide();jq("#files_uploadDialogContainer .cancelButton").hide();f.Submit()}};var s=function(u){var t=jq(u).parents(".fileRow").attr("id").replace("content_file_","");ASC.Files.Uploads.showUploadNewVersion(t)};var e=function(){if(jq.browser.msie){setInterval("document.title = jq('#files_folderName').html() + ' - ' + ASC.Files.Constants.TITLE_PAGE;",200)}};return{init:h,showUploadPopup:q,onUploadComplete:n,fileUploaderSubmit:g,showUploadNewVersion:p,showUploadedFiles:o,uploadFromHistory:s,documentTitleFix:e}})(jQuery);(function(a){ASC.Files.Uploads.init();a(function(){jq("#files_uploadSubmit").click(function(){ASC.Files.Uploads.fileUploaderSubmit()});jq("#files_uploaddialog_btn").click(function(){ASC.Files.Uploads.showUploadPopup()});jq("#files_emptyFolder_btn").click(function(){ASC.Files.Uploads.showUploadPopup();return false});if(ASC.Controls.Constants.isMobileAgent){jq("#files_uploaddialog_btn, #files_emptyFolder_btn, #files_uploads_files").remove()}})})(jQuery);window.ASC.Files.Share=(function(a){var n=false;var o=new Array();var l=function(){if(n===false){n=true;serviceManager.bind(ASC.Files.TemplateManager.events.GetSharedInfo,q);serviceManager.bind(ASC.Files.TemplateManager.events.SetAceObject,r);serviceManager.bind(ASC.Files.TemplateManager.events.UnSubscribeMe,s)}};var f=function(A){if(typeof PremiumStubManager!="undefined"){if(ASC.Files.Folders){switch(ASC.Files.Folders.folderContainer){case"my":PremiumStubManager.SwitchMessageType(PremiumStubManager.FeatureType.SharedDocs);break;case"corporate":PremiumStubManager.SwitchMessageType(PremiumStubManager.FeatureType.AccessRigths);break;default:PremiumStubManager.SwitchMessageType(PremiumStubManager.FeatureType.AccessRigths);break}}else{PremiumStubManager.SwitchMessageType(PremiumStubManager.FeatureType.AccessRigths)}PremiumStubManager.ShowDialog();return}if(ASC.Files.Folders){if(ASC.Files.Folders.folderContainer!="my"&&(ASC.Files.Folders.folderContainer!="corporate"||!ASC.Files.Constants.USER_ADMIN)){return}}j(A)};var t=function(A){jq("#"+A+" li.share_row").css("border-top","");jq("#"+A+" li.share_row:not(.hidden):first").css("border-top","1px solid #D1D1D1");jq("#"+A+" li.share_row.even").removeClass("even");jq("#"+A+" li.share_row:not(.hidden):even").addClass("even")};var u=function(B,A){switch(A){case"owner":jq("#action_"+B).text(ASC.Files.Resources.AceStatusEnum_Owner);break;case ASC.Files.Constants.AceStatusEnum.Read:jq("#action_"+B).text(ASC.Files.Resources.AceStatusEnum_Read);break;case ASC.Files.Constants.AceStatusEnum.ReadWrite:jq("#action_"+B).text(ASC.Files.Resources.AceStatusEnum_ReadWrite);break;case ASC.Files.Constants.AceStatusEnum.Restrict:jq("#action_"+B).text(ASC.Files.Resources.AceStatusEnum_Restrict);break;case ASC.Files.Constants.AceStatusEnum.None:default:jq("#action_"+B).text(ASC.Files.Resources.SelectRight);break}jq("#selected_action_"+B).val(A);jq("#share_main div.action_active").addClass("action_noactive").removeClass("action_active");jq("#files_rightPopup").hide()};var w=function(){ASC.Files.Share.initViewSwitcher(1);viewSwitcherToggleTabs("UserAccess_ViewSwitcherTab");ASC.Files.Common.blockUI(jq("#files_shareAccessDialogContainer"),550,500)};var m=function(A){if(A==1){shareUserSelector.DisplayAll();shareUserSelector.HideUser(ASC.Files.Constants.USER_ID);jq("#shareUserSelector #inputUserName").val("");jq("#files_usersAccessBody li.share_row:not(.hidden)").each(function(){shareUserSelector.HideUser(this.id)});jq("#shareUserSelector_add").unbind("click").click(function(){ASC.Files.Share.addUserToShare()});jq("#share_btnManage").hide()}else{jq("#share_btnManage").show()}e()};var e=function(){jq("#files_shareAccess_save").unbind("click").click(function(){ASC.Files.Share.setAceObject()});jq("#files_shareAccess_cancel").unbind("click").click(function(){PopupKeyUpActionProvider.CloseDialog()});jq("#share_main").show();jq("#share_manage").hide()};var p=function(){shareUserSelector.DisplayAll();jq("#usersInGroup").empty();y()};var y=function(A){if(A==undefined){jq("#files_groupName").val("")}else{jq("#files_groupName").val(jq("#"+A+" div.share_name").text())}jq("#files_shareAccess_save").unbind("click").click(function(){ASC.Files.Share.saveGroup(A)});jq("#files_shareAccess_cancel").unbind("click").click(function(){ASC.Files.Share.initViewSwitcher(2)});jq("#shareUserSelector_add").unbind("click").click(function(){var B=shareUserSelector.SelectedUserId;if(B!=null){ASC.Files.Share.addUserToGroup(B);jq("#shareUserSelector #inputUserName").val("");jq("#usersInGroup").scrollTo("#userLink_"+B);jq("#usersInGroup #userLink_"+B).css({backgroundColor:"#ffffcc"}).animate({backgroundColor:"#ffffff"},2000,function(){jq("#usersInGroup .share_row:even").css("backgroundColor","").addClass("even")});jq("#usersInGroup .share_row:first").css("border-top","1px solid #D1D1D1")}return false});jq("#share_btnManage").hide();jq("#share_main").hide();jq("#share_manage").show()};var c=function(E){if(jq("#usersInGroup #userLink_"+E).length!=0){return}var A;for(var B=0;B<shareUserSelector.Groups.length&&!A;B++){for(var C=0;C<shareUserSelector.Groups[B].Users.length&&!A;C++){if(shareUserSelector.Groups[B].Users[C].ID==E){A=shareUserSelector.Groups[B].Users[C]}}}if(A==undefined){return}shareUserSelector.HideUser(E);var D=jq.format('            <li id="userLink_{0}" class="clearFix share_row">                <div class="user">	                <span class="userLink">{1}</span>                </div>                <div class="user_remove" onclick="ASC.Files.Share.delUserInGroup(\'{0}\');">                </div>            </li>            ',A.ID,A.Name);jq("#usersInGroup").html(jq("#usersInGroup").html()+D)};var h=function(A){shareUserSelector.HideUser(A,false);jq("#usersInGroup #userLink_"+A).remove();t("usersInGroup")};var d=function(){var G=shareUserSelector.SelectedUserId;if(jq("#files_usersAccessBody #"+G).length!=0){jq("#files_usersAccessBody #"+G).show().removeClass("hidden");jq("#files_usersAccessBody").scrollTo(jq("#"+G))}else{var A;for(var D=0;D<shareUserSelector.Groups.length&&!A;D++){for(var E=0;E<shareUserSelector.Groups[D].Users.length&&!A;E++){if(shareUserSelector.Groups[D].Users[E].ID==G){A=shareUserSelector.Groups[D].Users[E]}}}if(A==undefined){return}G=A.ID;var B={id:G,title:A.Name,is_group:false,owner:false,ace_status:ASC.Files.Constants.AceStatusEnum.Read};var F=serviceManager.jsonToXml({ace_wrapperList:{entry:B}});var H=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getSharedInfo);if(typeof H==="undefined"){return undefined}var C=ASC.Controls.XSLTManager.translateFromString(F,H);jq("#files_usersAccessBody").append(C).scrollTo(jq("#files_usersAccessBody li.share_row:last"));jq("#share_groups_data").remove()}u(G,ASC.Files.Constants.AceStatusEnum.Read);jq("#change_action_"+G).val(true);t("files_usersAccessBody");shareUserSelector.HideUser(G);jq("#shareUserSelector #inputUserName").val("")};var i=function(A){shareUserSelector.HideUser(A,false);jq("#change_action_"+A).val(true);ASC.Files.Share.selectAction(A,ASC.Files.Constants.AceStatusEnum.None);jq("#files_usersAccessBody #"+A).hide().addClass("hidden");t("files_usersAccessBody")};var b=function(){var A=jq("#selectGroup").val();if(A=="emptyGroup"){return}jq("#files_groupsAccessBody #"+A).show().removeClass("hidden");jq("#GroupAccess .shareEmptyGroup").hide();jq("#files_groupsAccessBody").show().scrollTo(jq("#"+A));u(A,ASC.Files.Constants.AceStatusEnum.Read);jq("#change_action_"+A).val(true);t("files_groupsAccessBody");jq("#sg_"+A).hide().addClass("hidden").attr("disabled","disabled");jq("#selectGroup option:first").attr("selected","selected")};var g=function(A){jq("#sg_"+A).show().removeClass("hidden").attr("disabled","").attr("selected","selected");jq("#change_action_"+A).val(true);ASC.Files.Share.selectAction(A,ASC.Files.Constants.AceStatusEnum.None);jq("#files_groupsAccessBody #"+A).hide().addClass("hidden");if(jq("#files_groupsAccessBody li:visible").length==0){jq("#files_groupsAccessBody").hide();jq("#GroupAccess .shareEmptyGroup").show()}else{t("files_groupsAccessBody")}};var k=function(A){jq("#files_rightPopup").hide();jq("div.action_active").addClass("action_noactive").removeClass("action_active")};var x=function(F){if(jq("#"+F).hasClass("locked")){return}jq("div.action_active").addClass("action_noactive").removeClass("action_active");jq("#action_"+F).parent().addClass("action_active").removeClass("action_noactive");var B=jq("#"+F+" div.share_rights");var G=B.offset();var A=jq("#files_shareAccessDialogContainer").offset();var C=jq("#files_rightPopup");var E=G.top-A.top+B.outerHeight();var D=G.left-A.left;C.css({position:"absolute",top:E-1,left:D,visibility:""});C.show();C.css("left",D+B.outerWidth()-C.outerWidth());jq("#files_read").unbind("click").click(function(){jq("#change_action_"+F).val(true);ASC.Files.Share.selectAction(F,ASC.Files.Constants.AceStatusEnum.Read)});jq("#files_readwrite").unbind("click").click(function(){jq("#change_action_"+F).val(true);ASC.Files.Share.selectAction(F,ASC.Files.Constants.AceStatusEnum.ReadWrite)});jq("#files_restrict").unbind("click").click(function(){jq("#change_action_"+F).val(true);ASC.Files.Share.selectAction(F,ASC.Files.Constants.AceStatusEnum.Restrict)});jq("body").click(function(H){if(!jq((H.target)?H.target:H.srcElement).parents().andSelf().is("#files_rightPopup, div.action_active")){C.hide();jq("div.action_active").addClass("action_noactive").removeClass("action_active")}})};var j=function(B){var A={};A.entry=new Array();if(B!=undefined){A.entry.push(B.replace("combo_",""))}else{var C=jq("#files_mainContent input:checked");if(C.length!=1){ASC.Files.UI.displayInfoPanel(ASC.Files.Resources.InfoSelectForShare,true);return}C.each(function(){var D=this.id.replace("check_","");if(ASC.Files.UI.accessAdmin(D)){if(A.entry.length<1){ASC.Files.UI.checkSelectAll(false);jq(this).click();A.entry.push(this.id.replace("check_",""))}}})}if(A.entry.length==0){return}o=A;serviceManager.request("post","xml",ASC.Files.TemplateManager.events.GetSharedInfo,{showLoading:true},{stringList:A},"sharedinfo")};var v=function(){var A="";var D=false;jq("#share_main li.share_row input[id*='selected_action_']").each(function(){if(jq("#change_action_"+this.id.replace("selected_action_","")).val()=="true"){if(this.value!=""&&this.value!=null&&this.value!="owner"){var E={id:this.id.replace("selected_action_",""),is_group:jq(this).parents().is("#files_groupsAccessBody"),ace_status:this.value,object_ids:o};A+=serviceManager.jsonToXml({entry:E});if(this.value==ASC.Files.Constants.AceStatusEnum.ReadWrite||this.value==ASC.Files.Constants.AceStatusEnum.Read){D=true}}}});if(A==""){PopupKeyUpActionProvider.CloseDialog();return}var C=false;if(!D){if(jq("#share_main li.share_row input[id*='selected_action_'][value!='owner'][value!='"+ASC.Files.Constants.AceStatusEnum.None+"'][value!='"+ASC.Files.Constants.AceStatusEnum.Restrict+"']").length==0){C=true}}var B=serviceManager.jsonToXml({ace_wrapperList:A});serviceManager.request("post","xml",ASC.Files.TemplateManager.events.SetAceObject,{showLoading:true,showIcn:D,hideIcn:C},B,"setaceobject")};var z=function(A){serviceManager.request("get","xml",ASC.Files.TemplateManager.events.UnSubscribeMe,{showLoading:true,objId:A},"removeace",A)};var q=function(H,F,B,A){if(typeof B!="undefined"){ASC.Files.UI.displayInfoPanel(A||B,true);return undefined}var I=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getSharedInfo);if(typeof I==="undefined"){return undefined}var D=ASC.Controls.XSLTManager.translate(H,I);jq("#files_usersAccessBody").html(D);t("files_usersAccessBody");jq("#files_usersAccessBody li.share_row").each(function(K){u(this.id,jq("#selected_action_"+this.id).val())});if(jq("#files_groupsAccessBody li.share_row").length==0){var C=new Array();jq("#selectGroup option:not([value='emptyGroup'])").each(function(){C.push(serviceManager.jsonToXml({id:this.id.replace("sg_",""),name:jq(this).html(),ace_status:ASC.Files.Constants.AceStatusEnum.Restrict}))});var G=serviceManager.jsonToXml({group_infoList:{entry:C}});var J=ASC.Files.TemplateManager.getTemplate(ASC.Files.TemplateManager.templates.getGroups);if(typeof J==="undefined"){return undefined}var E=ASC.Controls.XSLTManager.translateFromString(G,J);jq("#files_groupsAccessBody").html(E)}jq("#files_groupsAccessBody").hide();jq("#GroupAccess .shareEmptyGroup").show();jq("#files_groupsAccessBody li.share_row").each(function(K){u(this.id,ASC.Files.Constants.AceStatusEnum.Restrict);jq(this).hide().addClass("hidden");jq(this).removeClass("locked")});jq("#selectGroup option").show().removeClass("hidden").attr("disabled","");jq("#share_groups_data input[type='hidden']").each(function(){var K=this.id.replace("group_right_","");jq("#"+K).show().removeClass("hidden");u(K,this.value);if(jq(this).attr("value2")=="locked"){jq("#"+K).addClass("locked")}jq("#files_groupsAccessBody").show();jq("#GroupAccess .shareEmptyGroup").hide();jq("#sg_"+K).hide().addClass("hidden")});jq("#selectGroup option[value='emptyGroup']").attr("selected","selected");t("files_groupsAccessBody");jq("#share_groups_data").remove();jq("#share_main input[id*='change_action_'][value='true']").each(function(){jq(this).val(false)});w()};var r=function(E,D,B,A){if(typeof B!="undefined"){ASC.Files.UI.displayInfoPanel(A||B,true);PopupKeyUpActionProvider.CloseDialog();return undefined}if(D.showIcn==true){for(var C=0;C<o.entry.length;C++){jq("#share_icn_"+o.entry[C]).css("display","block")}}else{if(D.hideIcn==true){for(var C=0;C<o.entry.length;C++){jq("#share_icn_"+o.entry[C]).hide()}}}PopupKeyUpActionProvider.CloseDialog()};var s=function(E,D,C,A){if(typeof C!="undefined"){ASC.Files.UI.displayInfoPanel(A||C,true);return undefined}jq("#content_"+D.objId).remove();var B=ASC.Files.Constants.COUNT_ON_PAGE-jq("#files_mainContent input[type='checkbox']").length;if(B>0){if(ASC.Files.UI.currentPage<ASC.Files.UI.amountPage){ASC.Files.Folders.getFolderItems(true,B)}else{if(B>=ASC.Files.Constants.COUNT_ON_PAGE){ASC.Files.UI.displayEmptyScreen()}}}};return{init:l,handlePopup:k,clickShareButton:f,getSharedInfo:j,initViewSwitcher:m,selectAction:u,addUserToGroup:c,delUserInGroup:h,addUserToShare:d,delUserInShare:i,setAceObject:v,unSubscribeMe:z,addGroupToShare:b,delGroupInShare:g,showRightsPopup:x}})(jQuery);(function(a){ASC.Files.Share.init();a(function(){jq("#files_share_btn").click(function(){ASC.Files.Share.clickShareButton()});jq("#share_btnManage").click(function(){ASC.Files.Share.newGroup()});jq("#files_groupsAccessBody").scroll(function(b){ASC.Files.Share.handlePopup(b);ASC.Files.Actions.hideAllActionPanels()});jq("#shareGroupSelector_add").click(function(){ASC.Files.Share.addGroupToShare()});if(ASC.Controls.Constants.isMobileAgent){jq("#files_usersAccessBody, #files_groupsAccessBody").css({"min-height":"300px",height:"auto"})}})})(jQuery);ASC.Files.ImageViewer=(function(a){var q=false;var K=false;var b;var k;var A={};var y={};var m;var C=0;var z=0;var J=15;var H=0;var v;var O={};var j={};var d={};var e={};var f=function(){ASC.Files.UI.displayLoading();jq("#loading_container").addClass("loading_container_wrapper")};var i=function(){ASC.Files.UI.hideLoading(true);jq("#loading_container").removeClass("loading_container_wrapper")};var E=function(){ASC.Files.UI.hideLoading(true);f();ASC.Files.UI.finishMoveTo({},{});jq("body").addClass("scroll_fix");if(jq.browser.msie&&jQuery.browser.version<=7){jq("html").addClass("scroll_fix");jq("<style type='text/css'> .studioContentClassOverride{ position: static !important; } </style>").appendTo("head");jq("#studioContent").addClass("studioContentClassOverride")}jq(document).bind("mousewheel",x);jq(document).keydown(r);jq(window).bind("resize",D);jq.blockUI({message:null,css:{left:"50%",top:"50%",opacity:"1",border:"none",padding:"0px"},overlayCSS:{backgroundColor:"Black",cursor:"default",opacity:"0.5"},allowBodyStretch:false});jq("#imageViewerToolbox, #imageViewerClose").show();ASC.Files.ImageViewer.fixMobileWidth()};var G=function(){jq("#imageViewerInfo, #imageViewerToolbox, #imageViewerContainer, #imageViewerClose, #other_actions").hide();jq("body").removeClass("scroll_fix");jq("#loading_container").removeClass("loading_container_wrapper");if(jq.browser.msie&&jQuery.browser.version<=7){jq("html").removeClass("scroll_fix");jq("#studioContent").removeClass("studioContentClassOverride")}i();jq.unblockUI();ASC.Files.ImageViewer.fixMobileWidth()};var h=function(S,Q){var R=(S=="w")?"h":"w";if(typeof Q=="undefined"||Q==null){var P=y[R]*A[S]/A[R]}else{var P=(/%/.test(Q))?parseInt(Q)/100*A[S]:parseInt(Q)}y[S]=Math.round(P)};var L=function(T,P){var V=(A.w>A.h)?["w","h"]:["h","w"];T[V[0]]=T.ls;T[V[1]]=null;var U=(T.w)?["w","h"]:(T.h)?["h","w"]:[];var R={w:y.w,h:y.h};h(U[0],T[U[0]]);h(U[1],T[U[1]]);K=true;if(typeof P=="undefined"||P==null){P=function(){K=false;jq("#imageViewerInfo").hide();setTimeout(function(){ASC.Files.ImageViewer.fixMobileWidth()},300)}}if(typeof T.speed=="undefined"||T.speed==null){T.speed=250}if(T.speed!=0){var S=1;var Q=function(X){var W=(y[X]-R[X])/2;if(W<0){S=-1}if(W>0){return"-="+W+"px"}else{return"+="+(-W)+"px"}};m.animate({width:y.w+"px",height:y.h+"px",left:Q("w"),top:Q("h")},{duration:T.speed,easing:"linear",complete:P,step:function(W,X){jq("#imageViewerInfo span").text(Math.round(z+S*J*X.pos)+"%")}})}else{m.css({width:y.w+"px",height:y.h+"px"});P()}};var l=function(){i();m[0].style.cssText="";var R=jq('<img src="'+m.attr("src")+'" style="position:absolute; top:0; left:0; visibility:hidden" />').prependTo("body");A={w:R.width(),h:R.height()};if(A.w==0&&A.h==0){A.w=m.attr("naturalWidth");A.h=m.attr("naturalHeight")}var Q={w:A.w/j.w,h:A.h/j.h};var P=(Q.w>Q.h)?"w":"h";if(Q[P]>1){C=Math.round(j[P]*100/A[P])}else{C=100}z=C;if(b=="open"){y={w:10,h:10};m.css({display:"block",left:d.w-y.w/2,top:d.h-y.h/2});L({ls:C+"%"})}else{L({ls:C+"%",speed:0},function(){K=false;m.css({display:"block",left:d.w-y.w/2,top:d.h-y.h/2})})}R.remove();F();ASC.Files.ImageViewer.fixMobileWidth()};var F=function(){if(p()){jq("#imageViewerToolbox div.imageInfo").text(jq.format("{0} ({1}x{2})",k[k.selectedIndex].Value,A.w,A.h))}else{jq("#imageViewerToolbox div.imageInfo").html("&nbsp")}};var p=function(){return !jQuery.isEmptyObject(A)};var M=function(){A={};y={};H=0;jq("#imageViewerInfo, #imageViewerContainer").hide();f();var P=k[k.selectedIndex].Key;m[0].onload=l;m.attr("src",ASC.Files.Utils.fileViewUrl(P));if(ASC.Files.UI.accessAdmin("file_"+P)){jq("#other_actions .action_delete").show()}else{jq("#other_actions .action_delete").hide()}if(ASC.Files.Favorites!=undefined){if(ASC.Files.Favorites.favoriteId("file_"+P)==undefined){n(P)}else{o(P)}}};var n=function(Q){var R=jq("#imageViewerFavorite img");var P=jq("#imageViewerFavorite");var S=R.attr("src").replace("_selected_hover.png",".png").replace("_selected.png",".png");R.attr("src",S).attr("alt",ASC.Files.Resources.AddToFavorites).attr("title",ASC.Files.Resources.AddToFavorites);P.unbind("click").click(function(){ASC.Files.Favorites.saveFavorite({path:("file_"+Q),title:k[k.selectedIndex].Value});o(Q)})};var o=function(R,Q){var S=jq("#imageViewerFavorite img");var P=jq("#imageViewerFavorite");var T=S.attr("src").replace("_hover.png",".png").replace("_selected.png",".png").replace(".png","_selected.png");S.attr("src",T).attr("alt",ASC.Files.Resources.RemoveFavorites).attr("title",ASC.Files.Resources.RemoveFavorites);P.unbind("click").click(function(){var U=ASC.Files.Favorites.favoriteId("file_"+R);if(U==null){return}ASC.Files.Favorites.removeFavorite(U);n(R)})};var t=function(P){v={x:P.pageX-m.offset().left,y:P.pageY-m.offset().top};jq(document).bind("mouseup",w);jq(document).bind("mousemove",u);document.ondragstart=function(){return false};document.body.onselectstart=function(){return false};m[0].ondragstart=function(){return false};jq("#imageViewerToolbox, #other_actions").hide()};var u=function(P){m.css({cursor:"pointer",top:P.pageY-v.y,left:P.pageX-v.x})};var w=function(){m.css("cursor","move");jq(document).unbind("mouseup");jq(document).unbind("mousemove");m[0].ondragstart=null;document.ondragstart=null;document.body.onselectstart=null;jq("#imageViewerToolbox").show()};var x=function(Q,P){if(K){return}if(P>0){ASC.Files.ImageViewer.zoomIn()}else{ASC.Files.ImageViewer.zoomOut()}return false};var s=function(){if(K){return}var P=O.w>O.h?O.w:O.h;L({ls:P+"px"})};var r=function(Q){var R=Q.keyCode||Q.which,P={left:37,up:38,right:39,down:40,esc:27,home:36,end:35,pageUP:33,pageDown:34,spaceBar:32,deleteKey:46};switch(R){case P.left:ASC.Files.ImageViewer.prevImage();return false;case P.spaceBar:case P.right:ASC.Files.ImageViewer.nextImage();return false;case P.up:ASC.Files.ImageViewer.zoomIn();return false;case P.down:ASC.Files.ImageViewer.zoomOut();return false;case P.esc:ASC.Files.ImageViewer.closeImageViewer();return false;case P.deleteKey:ASC.Files.ImageViewer.deleteImage();return false;case P.home:case P.end:case P.pageDown:case P.pageUP:return false}};var I=function(){if(!jq.browser.msie){var S=jq.format("rotate({0}deg)",H);m.css({"-moz-transform":S,"-o-transform":S,"-webkit-transform":S,transform:S})}else{var R=(H*Math.PI)/180;var P='progid:DXImageTransform.Microsoft.Matrix(sizingMethod="auto expand", M11 = '+Math.cos(R)+", M12 = "+(-Math.sin(R))+", M21 = "+Math.sin(R)+", M22 = "+Math.cos(R)+")";var Q=m.offset();m.css({"-ms-filter":P,filter:P});var T={left:-Math.round((m.width()-y.w)/2),top:-Math.round((m.height()-y.h)/2)};m.css({left:Q.left+T.left,top:Q.top+T.top});y.w=m.width();y.h=m.height()}ASC.Files.ImageViewer.fixMobileWidth()};var c=function(){O={w:jq(window).width(),h:jq(window).height()};var P=O.w/2+jq(window).scrollLeft();var Q=O.h/2+jq(window).scrollTop()-jq("#imageViewerToolbox").height()/2;d={w:P,h:Q};j={w:O.w,h:O.h-jq("#imageViewerToolbox").height()}};var D=function(){c();jq("#imageViewerInfo").css({left:d.w,top:d.h});jq("#imageViewerClose").css({left:(d.w-15)*2,top:jq(window).scrollTop()+15});jq("#imageViewerToolbox").css({top:O.h+jq(window).scrollTop()-jq("#imageViewerToolbox").height(),left:"0px",width:(ASC.Controls.Constants.isMobileAgent&&jq(document).width()<=1000)?"1000px":""});if(jq("#other_actions").is(":visible")){ASC.Files.ImageViewer.showOtherActionsPanel()}};var N=function(){var P=jq("#imageBatchLoader").data("idList");if(jQuery.inArray(imageID,P)!=-1){return}P.push(imageID);jq("#imageBatchLoader").append(jq("<img/>").attr("src",ASC.Files.Utils.fileViewUrl(imageID)))};var g=function(P){if(K){return}if(k.length==0||k.selectedIndex<0){ASC.Files.ImageViewer.closeImageViewer();return}if(!P){k.selectedIndex--;if(k.selectedIndex<0){k.selectedIndex=k.length-1}b="prevImage";var Q=k[k.selectedIndex].Key;ASC.Controls.AnchorController.safemove(ASC.Files.ImageViewer.getPreviewUrl(Q))}else{k.selectedIndex++;if(k.selectedIndex>k.length-1){k.selectedIndex=0}b="nextImage";var Q=k[k.selectedIndex].Key;ASC.Controls.AnchorController.safemove(ASC.Files.ImageViewer.getPreviewUrl(Q))}M()};var B=function(S,T,Q,P){if((typeof Q!="undefined")||S==undefined||(S.length==0)){ASC.Files.UI.displayInfoPanel(P||Q,true);ASC.Files.ImageViewer.closeImageViewer();return undefined}k=S;for(var R=0;R<k.length;R++){if(k[R].Key==T.imageID){k.selectedIndex=R;break}}if(R>=k.length){ASC.Files.ImageViewer.closeImageViewer();return}M()};return{init:function(P){if(q===false){q=true;serviceManager.bind(ASC.Files.TemplateManager.events.GetSiblingsFile,B);m=jq("#imageViewerContainer");m.dblclick(s);m.mousedown(t);jq(document).click(function(Q){ASC.Files.Common.dropdownRegisterAutoHide(Q,"#other_actions_switch","#other_actions")});if(ASC.Files.Favorites==undefined){jq("#imageViewerFavorite").remove()}jq("#imageViewerToolbox ul li img").hover(function(){var R=jq(this);var S=R.attr("src");if(S.indexOf("_hover.png")!=-1){return}var Q=S.replace(".png","_hover.png");R.attr("src",Q);jq("#imageViewerToolbox div.imageInfo").text(R.attr("title"))},function(){var Q=jq(this);var R=Q.attr("src").replace("_hover.png",".png");Q.attr("src",R);F()})}E();D();b="open";serviceManager.request("post","json",ASC.Files.TemplateManager.events.GetSiblingsFile,{imageID:P},{orderBy:ASC.Files.Folders.getOrderByAnchor()},"folders","files",P,"siblings")},getPreviewUrl:function(P){return jq.format("#preview/{0}",P)},showOtherActionsPanel:function(){ASC.Files.Common.dropdownToggle(jq("#imageViewerToolbox .toolboxWrapper li:last")[0],"other_actions")},closeImageViewer:function(){if(p()){L({ls:"10px",speed:500},G)}else{m[0].onload=null;m.attr("src","");G()}jq(document).unbind("mousewheel");jq(document).unbind("keydown");jq(window).unbind("resize");ASC.Files.UI.madeAnchor(null,ASC.Files.Folders.currentFolderId!=0)},prevImage:function(){g(false)},nextImage:function(){g(true)},rotateLeft:function(){if(K){return}H-=90;I()},rotateRight:function(){if(K){return}H+=90;I()},fullScale:function(){if(K||z==100){return}z=100;jq("#imageViewerInfo span").text(z+"%");jq("#imageViewerInfo").show();L({ls:z+"%"})},zoomIn:function(){if(K){return}z+=J;if(z>1000){z=1000}jq("#imageViewerInfo span").text(z+"%");jq("#imageViewerInfo").show();L({ls:z+"%"})},zoomOut:function(){if(K){return}z-=J;if(z<J){z=J;return}jq("#imageViewerInfo span").text(z+"%");jq("#imageViewerInfo").show();L({ls:z+"%"})},deleteImage:function(){if(K){return}var Q=k[k.selectedIndex].Key;if(!ASC.Files.UI.accessAdmin("file_"+Q)){return}var P={};P.entry=new Array();ASC.Files.UI.blockItem("content_file_"+Q,true,ASC.Files.Resources.DescriptRemove);P.entry.push("file_"+Q);serviceManager.deleteItem(ASC.Files.TemplateManager.events.DeleteItem,{list:[Q]},{stringList:P});k.splice(k.selectedIndex,1);k.selectedIndex--;ASC.Files.ImageViewer.nextImage()},downloadImage:function(){if(K){return}var P=k[k.selectedIndex].Key;window.open(ASC.Files.Utils.fileViewUrl(P),"new","fullscreen = 1, resizable = 1, location=1, toolbar=1")},fixMobileWidth:function(){if(!ASC.Controls.Constants.isMobileAgent){return}jq("#studioFooter, div.studioTopNavigationPanel, div.blockUI.blockOverlay").css("width",jq(document).width()<=1000?"1000px":"100%")}}})(jQuery);